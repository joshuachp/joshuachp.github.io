1:HL["/_next/static/css/ce86090a857d0a37.css",{"as":"style"}]
0:[[["",{"children":["notes",{"children":[["path","2023-04-01","d"],{"children":["__PAGE__?{\"path\":\"2023-04-01\"}",{}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/ce86090a857d0a37.css","precedence":"next"}]],["$L3",null]]]]
4:HL["/_next/static/css/2a1840b1c557e13c.css",{"as":"style"}]
2:["$L5",null]
3:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"/dev/blog - /dev/blog - Jouranl 2023-04-01"}],["$","meta",null,{"name":"description","content":"Developer blog"}],["$","meta",null,{"name":"application-name","content":"/dev/blog"}],null,null,["$","meta",null,{"name":"generator","content":"Next.js"}],["$","meta",null,{"name":"keywords","content":"Dev,Blog,Programmings"}],["$","meta",null,{"name":"referrer","content":"origin-when-cross-origin"}],[["$","meta",null,{"name":"theme-color","content":"amber"}]],["$","meta",null,{"name":"color-scheme","content":"dark"}],["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta",null,{"name":"creator","content":"Joshua Chapman"}],null,null,null,null,null,null,null,null,null,[]],[["$","link",null,{"rel":"canonical","href":"https://joshuachp.dev/notes/2023-04-01"}],null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.svg","type":"image/svg+xml"}],["$","link",null,{"rel":"icon","href":"/favicon.png","type":"image/png"}],["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon"}]],[],null]]
6:I{"id":"3508","chunks":["920:static/chunks/920-79b25866a09062bb.js","185:static/chunks/app/layout-bf6323bd5651a252.js"],"name":"","async":false}
7:I{"id":"247","chunks":["920:static/chunks/920-79b25866a09062bb.js","185:static/chunks/app/layout-bf6323bd5651a252.js"],"name":"","async":false}
8:I{"id":"3495","chunks":["920:static/chunks/920-79b25866a09062bb.js","185:static/chunks/app/layout-bf6323bd5651a252.js"],"name":"","async":false}
9:I{"id":"4463","chunks":["272:static/chunks/webpack-8bd999e5067c7888.js","667:static/chunks/2443530c-52b0a2f58ac02a84.js","488:static/chunks/488-c7775bdaa3bbbd30.js"],"name":"","async":false}
a:I{"id":"1010","chunks":["272:static/chunks/webpack-8bd999e5067c7888.js","667:static/chunks/2443530c-52b0a2f58ac02a84.js","488:static/chunks/488-c7775bdaa3bbbd30.js"],"name":"","async":false}
5:["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","$L6",null,{"production":true,"goatCounterApi":"a7d98e3f-b56b"}],["$","script",null,{"id":"dark-theme","dangerouslySetInnerHTML":{"__html":"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}"}}]]}],["$","body",null,{"className":"bg-primary-50 dark:bg-primary-900","children":["$","$L7",null,{"children":[["$","$L8",null,{}],["$","main",null,{"className":"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96","children":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","notes","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","notes","children",["path","2023-04-01","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$Lb",null],"segment":"__PAGE__?{\"path\":\"2023-04-01\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/2a1840b1c557e13c.css","precedence":"next"}]]}],"segment":["path","2023-04-01","d"]},"styles":[]}],"segment":"notes"},"styles":[]}]}]]}]}]]}]
c:I{"id":"8451","chunks":["920:static/chunks/920-79b25866a09062bb.js","563:static/chunks/app/posts/[path]/page-cdf4a6bc5b13017d.js"],"name":"","async":false}
b:["$","article",null,{"className":"flex max-w-full grow flex-col justify-self-start","children":[["$","h1",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl","children":[["$","span","1",{"children":"Journal 2023-04-01"}]]}],"<!-- Morning -->\n",["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","5",{"children":"Nix configuration with nix-sops"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","8",{"children":"I needed to configured nix access-tokens with nix-sops. The configuration file"}],"\r\n",["$","span","10",{"children":"is stored in the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"/etc/nix"}],["$","span","12",{"children":" directory."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","15",{"children":"The solution I settled on this solution:"}]]}],["$","ul",null,{"className":"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc","children":[["$","li","25",{"className":"mb-2","children":[["$","span","19",{"children":"Configure the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"nix.conf"}],["$","span","21",{"children":" to include (if present) the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"access-tokens.conf"}],"\r\n",["$","span","24",{"children":"file."}]]}],["$","li","36",{"className":"mb-2","children":[["$","span","27",{"children":"In the nix-sops I then link the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"access-tokens.conf"}],["$","span","29",{"children":" file to the"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"/etc/nix/access-tokens.conf"}],["$","span","32",{"children":" file using the"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"sops.secrets.nix_access_tokens.path"}],["$","span","35",{"children":" option."}]]}]]}],["$","$Lc","40",{"language":"nix","className":"mb-4 mt-2","children":[["$","span","39",{"children":"{\n  nix.extraOptions = ''\n    !include access-tokens.conf\n  '';\n  sops.secrets.nix_access_tokens.path = \"/etc/nix/access-tokens.conf\";\n}\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","42",{"children":"The file will be then sourced by nix. If it doesn"}],["$","span","43",{"children":"’"}],["$","span","44",{"children":"t exist, nix will not throw"}],"\r\n",["$","span","46",{"children":"an error thanks to the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"!include"}],["$","span","48",{"children":" directive."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","51",{"children":"The file needs to be readable by the client if you want the access-token work"}],"\r\n",["$","span","53",{"children":"with "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"nix flake ..."}],["$","span","55",{"children":" when run by your user, so you"}],["$","span","56",{"children":"’"}],["$","span","57",{"children":"ll need to configure the"}],"\r\n",["$","span","59",{"children":"owner to be the correct group."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","62",{"children":"One example is to create a "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"user-keys"}],["$","span","64",{"children":" group, different from the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"keys"}],["$","span","66",{"children":" sops"}],"\r\n",["$","span","68",{"children":"group, and add your user to it."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","71",{"children":"Next.js app directory"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","74",{"children":"The last canary of next js supports to export to static html files with the app"}],"\r\n",["$","span","76",{"children":"directory."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","79",{"children":"I think the app directory is a better structure for a next.js app. I made the"}],"\r\n",["$","span","81",{"children":"transition to the new directory some time ago. But could never use it since I"}],"\r\n",["$","span","83",{"children":"relay to the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"next export"}],["$","span","85",{"children":" command to generate the static html files for GitHub"}],"\r\n",["$","span","87",{"children":"pages."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","90",{"children":"Today I migrated to "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"next@canary"}],["$","span","92",{"children":" and its seem to work."}]]}],"<!-- What do I want to do today? -->\n","<!-- Evening -->\n","<!-- What did I learn today? -->\n","<!-- Things I learned -->\n","<!-- Useful tools and libraries -->\n"]}]
