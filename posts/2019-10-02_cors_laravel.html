<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" type="image/svg+xml" href="/favicon.svg"/><link rel="icon" type="image/png" href="/favicon.png"/><link rel="icon" type="image/x-icon" href="/favicon.ico"/><title>/dev/blog - CORS Laravel</title><meta name="description" content="Implementation of a simple CORS middleware for Laravel Php framework"/><link rel="canonical" href="https://joshuachp.dev/posts/2019-10-02_cors_laravel"/><meta name="next-head-count" content="8"/><script id="dark-theme" data-nscript="beforeInteractive">if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}</script><link rel="preload" href="/_next/static/css/5fc30b497c9bed6d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5fc30b497c9bed6d.css" data-n-g=""/><link rel="preload" href="/_next/static/css/2a1840b1c557e13c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2a1840b1c557e13c.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-2751f6424e24f776.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-f11614d8aa7ee555.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f61cee7d50a3f06e.js" defer=""></script><script src="/_next/static/chunks/424-7590959e48df0588.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bpath%5D-214e62a119fae8dd.js" defer=""></script><script src="/_next/static/NarM0gLz8ur9zLewyDbih/_buildManifest.js" defer=""></script><script src="/_next/static/NarM0gLz8ur9zLewyDbih/_ssgManifest.js" defer=""></script></head><body class="bg-primary-50 dark:bg-primary-900"><div id="__next"><header class="flex flex-row items-baseline justify-between gap-4 p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><nav class="flex flex-grow flex-row flex-wrap gap-y-4"><a title="Home page" class="mr-8" href="/"><h1 class=" text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl">/dev/blog</h1></a><ul class="flex flex-grow flex-row items-end justify-start gap-8"><li><a title="Posts" href="/posts"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50 underline font-bold">Posts</span></a></li><li><a title="Notes" href="/notes"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50  font-bold">Notes</span></a></li></ul></nav><div><button class="rounded border-t-2 border-l-2 border-r-4 border-b-4  border-primary-900 px-4 py-2 text-sm font-medium text-primary-900  hover:bg-primary-100 active:translate-y-0.5 dark:border-primary-50 dark:text-primary-50 dark:hover:bg-primary-800 "><span class="text-sm sm:text-base xl:text-lg text-primary-900 dark:text-primary-50 font-semibold">Auto</span></button></div></header><main class="flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><article class="flex max-w-full grow flex-col justify-self-start"><h1 class="mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl"><span>CORS Laravel</span></h1><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>I want to talk about the problems that I have encountered setting up CORS</span>
<span>between a Laravel backend server and a simple Html frontend hosted on a</span>
<span>different domain, using the fetch API.</span></p><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>What is CORS</span></h2><blockquote><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><strong><span>Cross-Origin Resource Sharing (CORS)</span></strong><span> is a mechanism that uses HTTP</span>
<span>headers to tell browsers to give a web application running at one origin,</span>
<span>access to selected resources from a different origin. A web application</span>
<span>executes a cross-origin HTTP request when it requests a resource that has a</span>
<span>different origin (domain, protocol, or port) from its own.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg">&lt;cite&gt;<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://developer.mozilla.org/docs/Web/HTTP/CORS"><span>MDN Web docs</span></a>&lt;/cite&gt;</p></blockquote><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>An example is having a backend server in a domain different from the frontend.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Eg. </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">example.com admin.example.com</code></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The browsers will block all the requests cross-domain and throw an error. This</span>
<span>issue is also present in development because the server and frontend must be</span>
<span>hosted on different ports (Like </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">localhost:8080</code><span> and </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">localhost:8000</code><span>).</span></p><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Implementation</span></h2><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The best place to read the implementation of CORS is</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://developer.mozilla.org/docs/Web/HTTP/CORS"><span>MDN Web Docs</span></a><span>. Most of the</span>
<span>setup on the frontend is already done by </span><strong><span>fetch</span></strong><span>. The first step in the CORS</span>
<span>mechanism is a </span><strong><span>Preflighted request</span></strong><span>.</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Preflighted request</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The </span><strong><span>Preflighted request</span></strong><span> is an </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">OPTIONS</code><span> request that checks if the backend</span>
<span>server understands the necessary headers.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The headers are:</span></p><ul class="mb-4 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc"><li class="mb-2"><span>Access-Control-Request-Method</span></li><li class="mb-2"><span>Access-Control-Request-Headers</span></li><li class="mb-2"><span>Origin</span></li></ul><h4 class="mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl"><span>Request</span></h4><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>I needed to make an Ajax </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">POST</code><span> request for some resources. I would send and</span>
<span>receive data in json format. The preflighted request would look something like</span>
<span>this:</span></p><pre class="language-http mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>GET /data/ HTTP/1.1
Host: admin.example.com
User-Agent: Mozilla/5.0 (...) Gecko/20100101 Firefox
Accept: */*
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Connection: keep-alive
Origin: https://example.com
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>With the fetch API</span></p><pre class="language-javascript mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>fetch.ajax(&#x27;admin.example.com&#x27;, {
        method: &#x27;POST&#x27;,
        mode: &#x27;cors&#x27;,
        body: JSON.stringify({
            data: &#x27;data&#x27;,
        });
</span></code></pre><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Laravel API</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>On the API side on Laravel we need to use a Middleware to intercept the</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">OPTION</code><span> request and add the necessary headers:</span></p><ul class="mb-4 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc"><li class="mb-2"><span>Access-Control-Allow-Origin</span></li><li class="mb-2"><span>Access-Control-Allow-Methods</span></li><li class="mb-2"><span>Access-Control-Allow-Headers</span></li></ul><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We can do it two ways. Using a custom Middleware created on your own, for</span>
<span>simple testing, or the more complete plugin</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/barryvdh/laravel-cors"><span>barryvdh/laravel-cors</span></a></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>You can find the implementation of the custom Middleware in this</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://stackoverflow.com/a/33090515"><span>Stack Overflow answer</span></a><span>. The code is:</span></p><pre class="language-php mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>&lt;?php namespace App\Http\Middleware;

use Closure;

class CORS {

    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return mixed
     */
    public function handle($request, Closure $next)
    {

        header(&quot;Access-Control-Allow-Origin: *&quot;);

        // ALLOW OPTIONS METHOD
        $headers = [
            &#x27;Access-Control-Allow-Methods&#x27;=&gt; &#x27;POST, GET, OPTIONS, PUT, DELETE&#x27;,
            &#x27;Access-Control-Allow-Headers&#x27;=&gt; &#x27;Content-Type, X-Auth-Token, Origin&#x27;
        ];
        if($request-&gt;getMethod() == &quot;OPTIONS&quot;) {
            // The client-side application can set headers allowed in Access-Control-Allow-Headers
            return Response::make(&#x27;OK&#x27;, 200, $headers);
        }

        $response = $next($request);
        foreach($headers as $key =&gt; $value)
            $response-&gt;header($key, $value);
        return $response;
    }
}
</span></code></pre><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Issue</span></h2><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>After adding the Middleware I had still issues with the browser blocking the</span>
<span>request. The response to the Preflighted Request had a 200 Status Code, but no</span>
<span>CORS headers. After some digging, I found out that Laravel returns an html page</span>
<span>if you don</span><span>’</span><span>t specify a return type </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">Accept-Content: application/json</code><span> in the</span>
<span>request and it will result in a 302 redirect to the page which will blocked by</span>
<span>default from the browser. So in the fetch function, we need to add the request</span>
<span>and response content-type headers:</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>With the fetch API</span></p><pre class="language-javascript mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>fetch.ajax(&quot;admin.example.com&quot;, {
    method: &quot;POST&quot;,
    mode: &quot;cors&quot;,
    headers: {
        Accept: &quot;application/json&quot;,
        &quot;Content-Type&quot;: &quot;application/json&quot;
    },;:
    body: JSON.stringify({
        data: &quot;data&quot;
    })
});
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>An alternative would be to use a different package like</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/axios/axios"><span>axios</span></a><span> that automatically sets the header for</span>
<span>the content-type and</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest"><span>XMLHttpRequest</span></a>
<span>for Laravel to recognize the request as ajax.</span></p><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Conclusion</span></h2><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>In conclusion, I suggest the use of the plug-in</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/barryvdh/laravel-cors"><span>barryvdh/laravel-cors</span></a><span> for the best</span>
<span>configuration and features.</span></p></article></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"path":"2019-10-02_cors_laravel","article":{"title":"CORS Laravel","description":"Implementation of a simple CORS middleware for Laravel Php framework","tags":["php","laravel","CORS"],"date":"2019-10-02","draft":false,"language":null,"content":[{"Start":{"Heading":["H1",null,[]]}},{"Text":"CORS Laravel"},{"End":{"Heading":["H1",null,[]]}},{"Start":"Paragraph"},{"Text":"I want to talk about the problems that I have encountered setting up CORS"},"SoftBreak",{"Text":"between a Laravel backend server and a simple Html frontend hosted on a"},"SoftBreak",{"Text":"different domain, using the fetch API."},{"End":"Paragraph"},{"Start":{"Heading":["H2",null,[]]}},{"Text":"What is CORS"},{"End":{"Heading":["H2",null,[]]}},{"Start":"BlockQuote"},{"Start":"Paragraph"},{"Start":"Strong"},{"Text":"Cross-Origin Resource Sharing (CORS)"},{"End":"Strong"},{"Text":" is a mechanism that uses HTTP"},"SoftBreak",{"Text":"headers to tell browsers to give a web application running at one origin,"},"SoftBreak",{"Text":"access to selected resources from a different origin. A web application"},"SoftBreak",{"Text":"executes a cross-origin HTTP request when it requests a resource that has a"},"SoftBreak",{"Text":"different origin (domain, protocol, or port) from its own."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Html":"\u003ccite\u003e"},{"Start":{"Link":["Inline","https://developer.mozilla.org/docs/Web/HTTP/CORS",""]}},{"Text":"MDN Web docs"},{"End":{"Link":["Inline","https://developer.mozilla.org/docs/Web/HTTP/CORS",""]}},{"Html":"\u003c/cite\u003e"},{"End":"Paragraph"},{"End":"BlockQuote"},{"Start":"Paragraph"},{"Text":"An example is having a backend server in a domain different from the frontend."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"Eg. "},{"Code":"example.com admin.example.com"},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"The browsers will block all the requests cross-domain and throw an error. This"},"SoftBreak",{"Text":"issue is also present in development because the server and frontend must be"},"SoftBreak",{"Text":"hosted on different ports (Like "},{"Code":"localhost:8080"},{"Text":" and "},{"Code":"localhost:8000"},{"Text":")."},{"End":"Paragraph"},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Implementation"},{"End":{"Heading":["H2",null,[]]}},{"Start":"Paragraph"},{"Text":"The best place to read the implementation of CORS is"},"SoftBreak",{"Start":{"Link":["Inline","https://developer.mozilla.org/docs/Web/HTTP/CORS",""]}},{"Text":"MDN Web Docs"},{"End":{"Link":["Inline","https://developer.mozilla.org/docs/Web/HTTP/CORS",""]}},{"Text":". Most of the"},"SoftBreak",{"Text":"setup on the frontend is already done by "},{"Start":"Strong"},{"Text":"fetch"},{"End":"Strong"},{"Text":". The first step in the CORS"},"SoftBreak",{"Text":"mechanism is a "},{"Start":"Strong"},{"Text":"Preflighted request"},{"End":"Strong"},{"Text":"."},{"End":"Paragraph"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Preflighted request"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"The "},{"Start":"Strong"},{"Text":"Preflighted request"},{"End":"Strong"},{"Text":" is an "},{"Code":"OPTIONS"},{"Text":" request that checks if the backend"},"SoftBreak",{"Text":"server understands the necessary headers."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"The headers are:"},{"End":"Paragraph"},{"Start":{"List":null}},{"Start":"Item"},{"Text":"Access-Control-Request-Method"},{"End":"Item"},{"Start":"Item"},{"Text":"Access-Control-Request-Headers"},{"End":"Item"},{"Start":"Item"},{"Text":"Origin"},{"End":"Item"},{"End":{"List":null}},{"Start":{"Heading":["H4",null,[]]}},{"Text":"Request"},{"End":{"Heading":["H4",null,[]]}},{"Start":"Paragraph"},{"Text":"I needed to make an Ajax "},{"Code":"POST"},{"Text":" request for some resources. I would send and"},"SoftBreak",{"Text":"receive data in json format. The preflighted request would look something like"},"SoftBreak",{"Text":"this:"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"http"}}},{"Text":"GET /data/ HTTP/1.1\nHost: admin.example.com\nUser-Agent: Mozilla/5.0 (...) Gecko/20100101 Firefox\nAccept: */*\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nConnection: keep-alive\nOrigin: https://example.com\n"},{"End":{"CodeBlock":{"Fenced":"http"}}},{"Start":"Paragraph"},{"Text":"With the fetch API"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"javascript"}}},{"Text":"fetch.ajax('admin.example.com', {\n        method: 'POST',\n        mode: 'cors',\n        body: JSON.stringify({\n            data: 'data',\n        });\n"},{"End":{"CodeBlock":{"Fenced":"javascript"}}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Laravel API"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"On the API side on Laravel we need to use a Middleware to intercept the"},"SoftBreak",{"Code":"OPTION"},{"Text":" request and add the necessary headers:"},{"End":"Paragraph"},{"Start":{"List":null}},{"Start":"Item"},{"Text":"Access-Control-Allow-Origin"},{"End":"Item"},{"Start":"Item"},{"Text":"Access-Control-Allow-Methods"},{"End":"Item"},{"Start":"Item"},{"Text":"Access-Control-Allow-Headers"},{"End":"Item"},{"End":{"List":null}},{"Start":"Paragraph"},{"Text":"We can do it two ways. Using a custom Middleware created on your own, for"},"SoftBreak",{"Text":"simple testing, or the more complete plugin"},"SoftBreak",{"Start":{"Link":["Inline","https://github.com/barryvdh/laravel-cors",""]}},{"Text":"barryvdh/laravel-cors"},{"End":{"Link":["Inline","https://github.com/barryvdh/laravel-cors",""]}},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"You can find the implementation of the custom Middleware in this"},"SoftBreak",{"Start":{"Link":["Inline","https://stackoverflow.com/a/33090515",""]}},{"Text":"Stack Overflow answer"},{"End":{"Link":["Inline","https://stackoverflow.com/a/33090515",""]}},{"Text":". The code is:"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"php"}}},{"Text":"\u003c?php namespace App\\Http\\Middleware;\n\nuse Closure;\n\nclass CORS {\n\n    /**\n     * Handle an incoming request.\n     *\n     * @param  \\Illuminate\\Http\\Request  $request\n     * @param  \\Closure  $next\n     * @return mixed\n     */\n    public function handle($request, Closure $next)\n    {\n\n        header(\"Access-Control-Allow-Origin: *\");\n\n        // ALLOW OPTIONS METHOD\n        $headers = [\n            'Access-Control-Allow-Methods'=\u003e 'POST, GET, OPTIONS, PUT, DELETE',\n            'Access-Control-Allow-Headers'=\u003e 'Content-Type, X-Auth-Token, Origin'\n        ];\n        if($request-\u003egetMethod() == \"OPTIONS\") {\n            // The client-side application can set headers allowed in Access-Control-Allow-Headers\n            return Response::make('OK', 200, $headers);\n        }\n\n        $response = $next($request);\n        foreach($headers as $key =\u003e $value)\n            $response-\u003eheader($key, $value);\n        return $response;\n    }\n}\n"},{"End":{"CodeBlock":{"Fenced":"php"}}},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Issue"},{"End":{"Heading":["H2",null,[]]}},{"Start":"Paragraph"},{"Text":"After adding the Middleware I had still issues with the browser blocking the"},"SoftBreak",{"Text":"request. The response to the Preflighted Request had a 200 Status Code, but no"},"SoftBreak",{"Text":"CORS headers. After some digging, I found out that Laravel returns an html page"},"SoftBreak",{"Text":"if you don"},{"Text":"’"},{"Text":"t specify a return type "},{"Code":"Accept-Content: application/json"},{"Text":" in the"},"SoftBreak",{"Text":"request and it will result in a 302 redirect to the page which will blocked by"},"SoftBreak",{"Text":"default from the browser. So in the fetch function, we need to add the request"},"SoftBreak",{"Text":"and response content-type headers:"},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"With the fetch API"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"javascript"}}},{"Text":"fetch.ajax(\"admin.example.com\", {\n    method: \"POST\",\n    mode: \"cors\",\n    headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n    },;:\n    body: JSON.stringify({\n        data: \"data\"\n    })\n});\n"},{"End":{"CodeBlock":{"Fenced":"javascript"}}},{"Start":"Paragraph"},{"Text":"An alternative would be to use a different package like"},"SoftBreak",{"Start":{"Link":["Inline","https://github.com/axios/axios",""]}},{"Text":"axios"},{"End":{"Link":["Inline","https://github.com/axios/axios",""]}},{"Text":" that automatically sets the header for"},"SoftBreak",{"Text":"the content-type and"},"SoftBreak",{"Start":{"Link":["Inline","https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest",""]}},{"Text":"XMLHttpRequest"},{"End":{"Link":["Inline","https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest",""]}},"SoftBreak",{"Text":"for Laravel to recognize the request as ajax."},{"End":"Paragraph"},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Conclusion"},{"End":{"Heading":["H2",null,[]]}},{"Start":"Paragraph"},{"Text":"In conclusion, I suggest the use of the plug-in"},"SoftBreak",{"Start":{"Link":["Inline","https://github.com/barryvdh/laravel-cors",""]}},{"Text":"barryvdh/laravel-cors"},{"End":{"Link":["Inline","https://github.com/barryvdh/laravel-cors",""]}},{"Text":" for the best"},"SoftBreak",{"Text":"configuration and features."},{"End":"Paragraph"}]}},"__N_SSG":true},"page":"/posts/[path]","query":{"path":"2019-10-02_cors_laravel"},"buildId":"NarM0gLz8ur9zLewyDbih","runtimeConfig":{"domain":"joshuachp.dev","production":true},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>