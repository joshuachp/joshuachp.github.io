<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="stylesheet" href="/_next/static/css/816f3edd0640ecf0.css" data-precedence="next.js"/><link rel="stylesheet" href="/_next/static/css/2a1840b1c557e13c.css" data-precedence="next.js"/><link rel="preload" as="script" href="//gc.zgo.at/count.js"/><title>/dev/blog - /dev/blog - Reply Challenge 2020 - That&#x27;s what server says</title><meta name="description" content="Writeup for the 300 points Web challenge for Reply Challenge CTF"/><meta name="application-name" content="/dev/blog"/><meta name="generator" content="Next.js"/><meta name="keywords" content="Dev,Blog,Programmings"/><meta name="referrer" content="origin-when-cross-origin"/><meta name="theme-color" content="amber"/><meta name="color-scheme" content="dark"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="creator" content="Joshua Chapman"/><link rel="canonical" href="https://joshuachp.dev/posts/2020-10-10_reply_challenges_2020_that_is_what_server_says"/><link rel="icon" href="/favicon.svg" type="image/svg+xml"/><link rel="icon" href="/favicon.png" type="image/png"/><link rel="icon" href="/favicon.ico" type="image/x-icon"/><script id="dark-theme">if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}</script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" nomodule=""></script></head><body class="bg-primary-50 dark:bg-primary-900"><header class="flex flex-row items-baseline justify-between gap-4 p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><nav class="flex flex-grow flex-row flex-wrap gap-y-4"><a title="Home page" class="mr-8" href="/"><h1 class=" text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl">/dev/blog</h1></a><ul class="flex flex-grow flex-row items-end justify-start gap-8"><li><a title="Posts" href="/posts"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50 underline font-bold">Posts</span></a></li><li><a title="Notes" href="/notes"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50  font-bold">Notes</span></a></li></ul></nav><div><button class="rounded border-t-2 border-l-2 border-r-4 border-b-4  border-primary-900 px-4 py-2 text-sm font-medium text-primary-900  hover:bg-primary-100 active:translate-y-0.5 dark:border-primary-50 dark:text-primary-50 dark:hover:bg-primary-800 "><span class="text-sm sm:text-base xl:text-lg text-primary-900 dark:text-primary-50 font-semibold">Auto</span></button></div></header><main class="flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><article class="flex max-w-full grow flex-col justify-self-start"><h1 class="mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl"><span>Reply Challenge 2020 - That</span><span>’</span><span>s what server says</span></h1><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>This is the Writeup for the 300 points Web challenge for Reply Challenge CTF.</span>
<span>During the CTF I and my team achieved first blood on this challenge. The</span>
<span>challenge consists of finding a service endpoint on a web page, with a login</span>
<span>API. Then you have to exploit an </span><strong><span>XXE</span></strong><span> (XML External Entities) Injection to</span>
<span>get an </span><strong><span>LFI</span></strong><span> (Local File Inclusion) to get the sysadmin credentials to login</span>
<span>on the service and get the flag.</span></p><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Service discovery</span></h2><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Fist we land on a page with just a </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">&lt;h1&gt;</code><span> title and an </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">&lt;img&gt;</code><span>. The title talks</span>
<span>about </span><strong><span>robots</span></strong><span> and in the image there are some blackberries. So as they</span>
<span>hinted we navigate to the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/robots.txt</code><span> files to find if there are some</span>
<span>disallowed entries. We are greeted by the character Michael from The Office</span>
<span>saying </span><em><span>“</span><span>You</span><span>’</span><span>re not my friend Barry</span><span>”</span></em><span>.</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>User Agent</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Since the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">roots.txt</code><span> file is blocked and there is anything else on the main</span>
<span>page, we have to circumvent the check on this file. They hinted to us something</span>
<span>about berries or blackberries. So we can try to access the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">robots.txt</code><span> as a</span>
<span>BlackBerry phone. This can be done by changing the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">User-Agent</code><span> header of your</span>
<span>HTTP request. We can find a list of valid </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">User-Agent</code><span> string on</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="http://www.useragentstring.com/pages/useragentstring.php?name=BlackBerry"><span>this website</span></a><span>.</span>
<span>After we changed the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">User-agent</code><span> we revisit the page and now we can see a</span>
<span>disallowed entry </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/file_upload.php</code><span>.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><img src="/images/reply-challenges/robots.png" alt=""/></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>File Upload</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">file_upload.php</code><span> API permits us to upload a </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">[png, jpg, jpeg, gif]</code><span> file</span>
<span>to the machine and will return where the file was uploaded.</span></p><blockquote><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Spoiler: we never use the uploaded file (rev shell or other) probably was a</span>
<span>rabbit hole.</span></p></blockquote><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>There are two curious facts about this API. The first is that the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">POST</code>
<span>request has sent three values:</span></p><ul class="mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc"><li class="mb-2"><strong><span>fileToUpload</span></strong><span>: The file to upload and its filename</span></li><li class="mb-2"><strong><span>req</span></strong><span>: A string that represents an endpoint on the server</span></li><li class="mb-2"><strong><span>submit</span></strong><span>: A request method (POST)</span></li></ul><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The second one is when you send the request without uploading a file, you get a</span>
<span>message to contact the sysadmin to use the API </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/services</code><span> and set the</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">authorized.xml</code><span> file.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><img src="/images/reply-challenges/sysadmin.png" alt=""/></p><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Exploitation</span></h2><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We can not access the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/services</code><span> from our machine, so we can try to use</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">file_upload.php</code><span> to communicate with this API. First, we can try to change the</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">req</code><span> value to </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/services</code><span> and check what we get back. Sending an image we get</span>
<span>that the page doesn</span><span>’</span><span>t support this method. Then we change the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">submit</code><span> value to</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">GET</code><span>. The page responds with an HTML/XML body. This is </span><strong><span>XML WSDL</span></strong><span> a standard</span>
<span>for Web Services Description Language, it is used to describe web services.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><img src="/images/reply-challenges/services.png" alt=""/></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We can see that the services have an endpoint at </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/services/perform_login</code>
<span>requires as input a </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">user</code><span> and a </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">pwd</code><span> that is probably the one in the</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">authorized.xml</code><span> referenced before.</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>XXE Injection</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We can now try to send the file to the login API. If we send an image the</span>
<span>endpoint returns </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">XML Format Error</code><span>, so we know that the page requires an XML</span>
<span>file. Unfortunately, </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">file_upload.php</code><span> only accepts certain extension, we need</span>
<span>to craft or XML payload and rename the file to a valid extension like </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">.jpg</code><span>.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>From the XML WSDL, we know the arguments that are required, and with a bit of</span>
<span>trial and error, we can find the right format of the payload.</span></p><pre class="language-xml mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>&lt;user&gt;test&lt;/user&gt;
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>When we send the post we get an error saying:</span></p><pre class="language-plaintext mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>test is not a register user
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Now we have a value </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">user</code><span> that can output on the response. This means we can</span>
<span>make an XXE Injection to get the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">authorized.xml</code><span> file as the user value and</span>
<span>make the response print it as an error for profit. We can guess the position of</span>
<span>the file because the response includes where our image was uploaded, or we</span>
<span>could try and get the entire directory, or a known file like </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/etc/passwd</code><span>.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The final payload is the following.</span></p><pre class="language-xml mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>&lt;!DOCTYPE root [!ENTITY test SYSTEM &#x27;file:///var/chall300_web/authorized.xml&#x27;&gt;]&gt;
&lt;user&gt;&amp;test;&lt;/user&gt;
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><img src="/images/reply-challenges/flag.png" alt=""/></p><blockquote><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>If you want to read more about XXE here</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection"><span>PayloadAllTheThings/XXE Injection</span></a></p></blockquote></article></main><script src="/_next/static/chunks/webpack-e24f1f8cbee90348.js" async=""></script><script src="/_next/static/chunks/2443530c-65ca4daeaf429502.js" async=""></script><script src="/_next/static/chunks/961-409d5e344dd5ce3d.js" async=""></script><script src="/_next/static/chunks/main-app-113864fcabec0f7c.js" async=""></script></body></html><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"0:\"$L1\"\n"])</script><script>self.__next_f.push([1,"2:I{\"id\":\"8462\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\n4:I{\"id\":\"9178\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"1:[\"$\",\"$L2\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/2020-10-10_reply_challenges_2020_that_is_what_server_says\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"path\",\"2020-10-10_reply_challenges_2020_that_is_what_server_says\",\"d\"],{\"children\":[\"__PAGE__?{\\\"path\\\":\\\"2020-10-10_reply_challenges_2020_that_is_what_server_says\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":\"$L3\",\"globalErrorComponent\":\"$4\",\"notFound\":\"$L5\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"children\":[\"$L6\",null,null,[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/816f3edd0640ecf0.css\",\"precedence\":\"next.js\"}]]]}]\n"])</script><script>self.__next_f.push([1,"7:I{\"id\":\"5376\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-147fc0c93c3f3e98\"],\"async\":false}\n8:I{\"id\":\"9299\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-147fc0c93c3f3e98\"],\"async\":false}\n9:I{\"id\":\"5019\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-147fc0c93c3f3e98\"],\"async\":false}\na:I{\"id\":\"1300\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\nb:I{\"id\":\"6022\",\"name\":\"\",\"chun"])</script><script>self.__next_f.push([1,"ks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"$L7\",null,{\"production\":true,\"goatCounterApi\":\"a7d98e3f-b56b\"}],[\"$\",\"script\",null,{\"id\":\"dark-theme\",\"dangerouslySetInnerHTML\":{\"__html\":\"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')\u0026\u0026window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}\"}}]]}],[\"$\",\"body\",null,{\"className\":\"bg-primary-50 dark:bg-primary-900\",\"children\":[\"$\",\"$L8\",null,{\"children\":[[\"$\",\"$L9\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96\",\"children\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"path\",\"2020-10-10_reply_challenges_2020_that_is_what_server_says\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$Lc\",null,null,[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/2a1840b1c557e13c.css\",\"precedence\":\"next.js\"}]]],\"segment\":\"__PAGE__?{\\\"path\\\":\\\"2020-10-10_reply_challenges_2020_that_is_what_server_says\\\"}\"}}],\"segment\":[\"path\",\"2020-10-10_reply_challenges_2020_that_is_what_server_says\",\"d\"]}}],\"segment\":\"posts\"}}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"$L7\",null,{\"production\":true,\"goatCounterApi\":\"a7d98e3f-b56b\"}],[\"$\",\"script\",null,{\"id\":\"dark-theme\",\"dangerouslySetInnerHTML\":{\"__html\":\"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')\u0026\u0026window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}\"}}]]}],[\"$\",\"body\",null,{\"className\":\"bg-primary-50 dark:bg-primary-900\",\"children\":[\"$\",\"$L8\",null,{\"children\":[[\"$\",\"$L9\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96\",\"children\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"3:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],[\"$\",\"title\",null,{\"children\":\"/dev/blog - /dev/blog - Reply Challenge 2020 - That's what server says\"}],[\"$\",\"meta\",null,{\"name\":\"description\",\"content\":\"Writeup for the 300 points Web challenge for Reply Challenge CTF\"}],[\"$\",\"meta\",null,{\"name\":\"application-name\",\"content\":\"/dev/blog\"}],null,null,[\"$\",\"meta\",null,{\"name\":\"generator\",\"content\":\"Next.js\"}],[\"$\",\"meta\",null,{\"name\":\"keywords\",\"content\":\"Dev,Blog,Programmings\"}],[\"$\",\"meta\",null,{\"name\":\"referrer\",\"content\":\"origin-when-cross-origin\"}],[[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"amber\"}]],[\"$\",\"meta\",null,{\"name\":\"color-scheme\",\"content\":\"dark\"}],[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",null,{\"name\":\"creator\",\"content\":\"Joshua Chapman\"}],null,null,null,null,null,null,null,null,null,[]],[[\"$\",\"link\",null,{\"rel\":\"canonical\",\"href\":\"https://joshuachp.dev/posts/2020-10-10_reply_challenges_2020_that_is_what_server_says\"}],null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.svg\",\"type\":\"image/svg+xml\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.png\",\"type\":\"image/png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\"}]],[],null]]\n"])</script><script>self.__next_f.push([1,"d:I{\"id\":\"3619\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"991:app/posts/page-a8aca74000a1e875\"],\"async\":false}\ne:I{\"id\":\"7876\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"563:app/posts/[path]/page-deda6ae7686b2d48\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"c:[\"$\",\"article\",null,{\"className\":\"flex max-w-full grow flex-col justify-self-start\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl\",\"children\":[[\"$\",\"span\",\"1\",{\"children\":\"Reply Challenge 2020 - That\"}],[\"$\",\"span\",\"2\",{\"children\":\"’\"}],[\"$\",\"span\",\"3\",{\"children\":\"s what server says\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"6\",{\"children\":\"This is the Writeup for the 300 points Web challenge for Reply Challenge CTF.\"}],\"\\r\\n\",[\"$\",\"span\",\"8\",{\"children\":\"During the CTF I and my team achieved first blood on this challenge. The\"}],\"\\r\\n\",[\"$\",\"span\",\"10\",{\"children\":\"challenge consists of finding a service endpoint on a web page, with a login\"}],\"\\r\\n\",[\"$\",\"span\",\"12\",{\"children\":\"API. Then you have to exploit an \"}],[\"$\",\"strong\",\"15\",{\"children\":[[\"$\",\"span\",\"14\",{\"children\":\"XXE\"}]]}],[\"$\",\"span\",\"16\",{\"children\":\" (XML External Entities) Injection to\"}],\"\\r\\n\",[\"$\",\"span\",\"18\",{\"children\":\"get an \"}],[\"$\",\"strong\",\"21\",{\"children\":[[\"$\",\"span\",\"20\",{\"children\":\"LFI\"}]]}],[\"$\",\"span\",\"22\",{\"children\":\" (Local File Inclusion) to get the sysadmin credentials to login\"}],\"\\r\\n\",[\"$\",\"span\",\"24\",{\"children\":\"on the service and get the flag.\"}]]}],[\"$\",\"h2\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl\",\"children\":[[\"$\",\"span\",\"27\",{\"children\":\"Service discovery\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"30\",{\"children\":\"Fist we land on a page with just a \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"\u003ch1\u003e\"}],[\"$\",\"span\",\"32\",{\"children\":\" title and an \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"\u003cimg\u003e\"}],[\"$\",\"span\",\"34\",{\"children\":\". The title talks\"}],\"\\r\\n\",[\"$\",\"span\",\"36\",{\"children\":\"about \"}],[\"$\",\"strong\",\"39\",{\"children\":[[\"$\",\"span\",\"38\",{\"children\":\"robots\"}]]}],[\"$\",\"span\",\"40\",{\"children\":\" and in the image there are some blackberries. So as they\"}],\"\\r\\n\",[\"$\",\"span\",\"42\",{\"children\":\"hinted we navigate to the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/robots.txt\"}],[\"$\",\"span\",\"44\",{\"children\":\" files to find if there are some\"}],\"\\r\\n\",[\"$\",\"span\",\"46\",{\"children\":\"disallowed entries. We are greeted by the character Michael from The Office\"}],\"\\r\\n\",[\"$\",\"span\",\"48\",{\"children\":\"saying \"}],[\"$\",\"em\",\"55\",{\"children\":[[\"$\",\"span\",\"50\",{\"children\":\"“\"}],[\"$\",\"span\",\"51\",{\"children\":\"You\"}],[\"$\",\"span\",\"52\",{\"children\":\"’\"}],[\"$\",\"span\",\"53\",{\"children\":\"re not my friend Barry\"}],[\"$\",\"span\",\"54\",{\"children\":\"”\"}]]}],[\"$\",\"span\",\"56\",{\"children\":\".\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"59\",{\"children\":\"User Agent\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"62\",{\"children\":\"Since the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"roots.txt\"}],[\"$\",\"span\",\"64\",{\"children\":\" file is blocked and there is anything else on the main\"}],\"\\r\\n\",[\"$\",\"span\",\"66\",{\"children\":\"page, we have to circumvent the check on this file. They hinted to us something\"}],\"\\r\\n\",[\"$\",\"span\",\"68\",{\"children\":\"about berries or blackberries. So we can try to access the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"robots.txt\"}],[\"$\",\"span\",\"70\",{\"children\":\" as a\"}],\"\\r\\n\",[\"$\",\"span\",\"72\",{\"children\":\"BlackBerry phone. This can be done by changing the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"User-Agent\"}],[\"$\",\"span\",\"74\",{\"children\":\" header of your\"}],\"\\r\\n\",[\"$\",\"span\",\"76\",{\"children\":\"HTTP request. We can find a list of valid \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"User-Agent\"}],[\"$\",\"span\",\"78\",{\"children\":\" string on\"}],\"\\r\\n\",[\"$\",\"$Ld\",null,{\"title\":\"\",\"className\":\"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600\",\"href\":\"http://www.useragentstring.com/pages/useragentstring.php?name=BlackBerry\",\"children\":[[\"$\",\"span\",\"81\",{\"children\":\"this website\"}]]}],[\"$\",\"span\",\"83\",{\"children\":\".\"}],\"\\r\\n\",[\"$\",\"span\",\"85\",{\"children\":\"After we changed the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"User-agent\"}],[\"$\",\"span\",\"87\",{\"children\":\" we revisit the page and now we can see a\"}],\"\\r\\n\",[\"$\",\"span\",\"89\",{\"children\":\"disallowed entry \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/file_upload.php\"}],[\"$\",\"span\",\"91\",{\"children\":\".\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"img\",\"96\",{\"src\":\"/images/reply-challenges/robots.png\",\"alt\":\"\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"99\",{\"children\":\"File Upload\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"102\",{\"children\":\"The \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"file_upload.php\"}],[\"$\",\"span\",\"104\",{\"children\":\" API permits us to upload a \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"[png, jpg, jpeg, gif]\"}],[\"$\",\"span\",\"106\",{\"children\":\" file\"}],\"\\r\\n\",[\"$\",\"span\",\"108\",{\"children\":\"to the machine and will return where the file was uploaded.\"}]]}],[\"$\",\"blockquote\",\"116\",{\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"112\",{\"children\":\"Spoiler: we never use the uploaded file (rev shell or other) probably was a\"}],\"\\r\\n\",[\"$\",\"span\",\"114\",{\"children\":\"rabbit hole.\"}]]}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"118\",{\"children\":\"There are two curious facts about this API. The first is that the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"POST\"}],\"\\r\\n\",[\"$\",\"span\",\"121\",{\"children\":\"request has sent three values:\"}]]}],[\"$\",\"ul\",null,{\"className\":\"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc\",\"children\":[[\"$\",\"li\",\"129\",{\"className\":\"mb-2\",\"children\":[[\"$\",\"strong\",\"127\",{\"children\":[[\"$\",\"span\",\"126\",{\"children\":\"fileToUpload\"}]]}],[\"$\",\"span\",\"128\",{\"children\":\": The file to upload and its filename\"}]]}],[\"$\",\"li\",\"135\",{\"className\":\"mb-2\",\"children\":[[\"$\",\"strong\",\"133\",{\"children\":[[\"$\",\"span\",\"132\",{\"children\":\"req\"}]]}],[\"$\",\"span\",\"134\",{\"children\":\": A string that represents an endpoint on the server\"}]]}],[\"$\",\"li\",\"141\",{\"className\":\"mb-2\",\"children\":[[\"$\",\"strong\",\"139\",{\"children\":[[\"$\",\"span\",\"138\",{\"children\":\"submit\"}]]}],[\"$\",\"span\",\"140\",{\"children\":\": A request method (POST)\"}]]}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"144\",{\"children\":\"The second one is when you send the request without uploading a file, you get a\"}],\"\\r\\n\",[\"$\",\"span\",\"146\",{\"children\":\"message to contact the sysadmin to use the API \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/services\"}],[\"$\",\"span\",\"148\",{\"children\":\" and set the\"}],\"\\r\\n\",[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"authorized.xml\"}],[\"$\",\"span\",\"151\",{\"children\":\" file.\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"img\",\"156\",{\"src\":\"/images/reply-challenges/sysadmin.png\",\"alt\":\"\"}]]}],[\"$\",\"h2\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl\",\"children\":[[\"$\",\"span\",\"159\",{\"children\":\"Exploitation\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"162\",{\"children\":\"We can not access the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/services\"}],[\"$\",\"span\",\"164\",{\"children\":\" from our machine, so we can try to use\"}],\"\\r\\n\",[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"file_upload.php\"}],[\"$\",\"span\",\"167\",{\"children\":\" to communicate with this API. First, we can try to change the\"}],\"\\r\\n\",[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"req\"}],[\"$\",\"span\",\"170\",{\"children\":\" value to \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/services\"}],[\"$\",\"span\",\"172\",{\"children\":\" and check what we get back. Sending an image we get\"}],\"\\r\\n\",[\"$\",\"span\",\"174\",{\"children\":\"that the page doesn\"}],[\"$\",\"span\",\"175\",{\"children\":\"’\"}],[\"$\",\"span\",\"176\",{\"children\":\"t support this method. Then we change the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"submit\"}],[\"$\",\"span\",\"178\",{\"children\":\" value to\"}],\"\\r\\n\",[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"GET\"}],[\"$\",\"span\",\"181\",{\"children\":\". The page responds with an HTML/XML body. This is \"}],[\"$\",\"strong\",\"184\",{\"children\":[[\"$\",\"span\",\"183\",{\"children\":\"XML WSDL\"}]]}],[\"$\",\"span\",\"185\",{\"children\":\" a standard\"}],\"\\r\\n\",[\"$\",\"span\",\"187\",{\"children\":\"for Web Services Description Language, it is used to describe web services.\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"img\",\"192\",{\"src\":\"/images/reply-challenges/services.png\",\"alt\":\"\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"195\",{\"children\":\"We can see that the services have an endpoint at \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/services/perform_login\"}],\"\\r\\n\",[\"$\",\"span\",\"198\",{\"children\":\"requires as input a \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"user\"}],[\"$\",\"span\",\"200\",{\"children\":\" and a \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"pwd\"}],[\"$\",\"span\",\"202\",{\"children\":\" that is probably the one in the\"}],\"\\r\\n\",[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"authorized.xml\"}],[\"$\",\"span\",\"205\",{\"children\":\" referenced before.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"208\",{\"children\":\"XXE Injection\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"211\",{\"children\":\"We can now try to send the file to the login API. If we send an image the\"}],\"\\r\\n\",[\"$\",\"span\",\"213\",{\"children\":\"endpoint returns \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"XML Format Error\"}],[\"$\",\"span\",\"215\",{\"children\":\", so we know that the page requires an XML\"}],\"\\r\\n\",[\"$\",\"span\",\"217\",{\"children\":\"file. Unfortunately, \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"file_upload.php\"}],[\"$\",\"span\",\"219\",{\"children\":\" only accepts certain extension, we need\"}],\"\\r\\n\",[\"$\",\"span\",\"221\",{\"children\":\"to craft or XML payload and rename the file to a valid extension like \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\".jpg\"}],[\"$\",\"span\",\"223\",{\"children\":\".\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"226\",{\"children\":\"From the XML WSDL, we know the arguments that are required, and with a bit of\"}],\"\\r\\n\",[\"$\",\"span\",\"228\",{\"children\":\"trial and error, we can find the right format of the payload.\"}]]}],[\"$\",\"$Le\",\"232\",{\"language\":\"xml\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"231\",{\"children\":\"\u003cuser\u003etest\u003c/user\u003e\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"234\",{\"children\":\"When we send the post we get an error saying:\"}]]}],[\"$\",\"$Le\",\"238\",{\"language\":\"\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"237\",{\"children\":\"test is not a register user\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"240\",{\"children\":\"Now we have a value \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"user\"}],[\"$\",\"span\",\"242\",{\"children\":\" that can output on the response. This means we can\"}],\"\\r\\n\",[\"$\",\"span\",\"244\",{\"children\":\"make an XXE Injection to get the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"authorized.xml\"}],[\"$\",\"span\",\"246\",{\"children\":\" file as the user value and\"}],\"\\r\\n\",[\"$\",\"span\",\"248\",{\"children\":\"make the response print it as an error for profit. We can guess the position of\"}],\"\\r\\n\",[\"$\",\"span\",\"250\",{\"children\":\"the file because the response includes where our image was uploaded, or we\"}],\"\\r\\n\",[\"$\",\"span\",\"252\",{\"children\":\"could try and get the entire directory, or a known file like \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/etc/passwd\"}],[\"$\",\"span\",\"254\",{\"children\":\".\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"257\",{\"children\":\"The final payload is the following.\"}]]}],[\"$\",\"$Le\",\"261\",{\"language\":\"xml\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"260\",{\"children\":\"\u003c!DOCTYPE root [!ENTITY test SYSTEM 'file:///var/chall300_web/authorized.xml'\u003e]\u003e\\n\u003cuser\u003e\u0026test;\u003c/user\u003e\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"img\",\"265\",{\"src\":\"/images/reply-challenges/flag.png\",\"alt\":\"\"}]]}],[\"$\",\"blockquote\",\"275\",{\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"269\",{\"children\":\"If you want to read more about XXE here\"}],\"\\r\\n\",[\"$\",\"$Ld\",null,{\"title\":\"\",\"className\":\"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600\",\"href\":\"https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection\",\"children\":[[\"$\",\"span\",\"272\",{\"children\":\"PayloadAllTheThings/XXE Injection\"}]]}]]}]]}]]}]\n"])</script>