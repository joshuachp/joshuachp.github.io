<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> CyberChallengeIT CTF - Group Challenge </title>
  <meta name="description" content="Hacker and developer blog">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="CyberChallengeIT CTF - Group Challenge" />
<meta property="og:description" content="During the last week of preparation for che Cyber Challenge IT CTF, we were asked to do a CTF challenge our self. We were divided in groups and given a month to come up with a challenge.
Our group create an easy and guided challenge, since we were required to solve it in one hour. It will cover some basic aspect of all the kind of challenges types like Web Security, Reversing, Forensics, Cryptography." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://joshuachp.github.io/posts/ccit-challenge/" />
<meta property="article:published_time" content="2020-01-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-01-06T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CyberChallengeIT CTF - Group Challenge"/>
<meta name="twitter:description" content="During the last week of preparation for che Cyber Challenge IT CTF, we were asked to do a CTF challenge our self. We were divided in groups and given a month to come up with a challenge.
Our group create an easy and guided challenge, since we were required to solve it in one hour. It will cover some basic aspect of all the kind of challenges types like Web Security, Reversing, Forensics, Cryptography."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://joshuachp.github.io/css/style-dark.css">
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://joshuachp.github.io/images/favicon.ico" />

  
  
  
</head>
<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/writeups">Writeups</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://joshuachp.github.io/posts/cors-laravel/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://joshuachp.github.io/writeups/tryhackme-easy-peasy/">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&text=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&is_video=false&description=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=CyberChallengeIT%20CTF%20-%20Group%20Challenge&body=Check out this article: https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-stumbleupon " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-digg " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&name=CyberChallengeIT%20CTF%20-%20Group%20Challenge&description=During%20the%20last%20week%20of%20preparation%20for%20che%20Cyber%20Challenge%20IT%20CTF%2c%20we%20were%20asked%20to%20do%20a%20CTF%20challenge%20our%20self.%20We%20were%20divided%20in%20groups%20and%20given%20a%20month%20to%20come%20up%20with%20a%20challenge.%0aOur%20group%20create%20an%20easy%20and%20guided%20challenge%2c%20since%20we%20were%20required%20to%20solve%20it%20in%20one%20hour.%20It%20will%20cover%20some%20basic%20aspect%20of%20all%20the%20kind%20of%20challenges%20types%20like%20Web%20Security%2c%20Reversing%2c%20Forensics%2c%20Cryptography.">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&t=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#start">Start</a></li>
    <li><a href="#sito">Sito</a>
      <ul>
        <li><a href="#hint-1">Hint 1</a></li>
      </ul>
    </li>
    <li><a href="#disk">Disk</a>
      <ul>
        <li><a href="#hint-2">Hint 2</a></li>
        <li><a href="#forensics">Forensics</a></li>
        <li><a href="#reverse-engineering">Reverse Engineering</a></li>
        <li><a href="#steganography">Steganography</a></li>
        <li><a href="#cracking">Cracking</a></li>
      </ul>
    </li>
    <li><a href="#conclusione">Conclusione</a></li>
    <li><a href="#extras">Extras</a></li>
  </ul>
</nav>
    </div>
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        CyberChallengeIT CTF - Group Challenge
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2020-01-06 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-01-06</time>
          
        </div>
        
        
      </div>
    </header>

  
    <div class="content" itemprop="articleBody">
      <p>During the last week of preparation for che Cyber Challenge IT CTF, we were
asked to do a CTF challenge our self. We were divided in groups and given a
month to come up with a challenge.</p>
<p>Our group create an easy and guided challenge, since we were required to solve
it in one hour. It will cover some basic aspect of all the kind of challenges
types like Web Security, Reversing, Forensics, Cryptography.</p>
<p>If you want to try the challenge yourself you will start by downloading this
zip file:</p>
<p><a href="/CTF/CCIT_challenge/challenge_gruppo_1.zip">challenge_gruppo_1.zip</a></p>
<p>Thank you to all the tutors and the other group members which made all the
different parts of this challenge.</p>
<p>The source code for creating the challenge: <a href="https://github.com/joshuachp/CTF_CyberChallengeIT_2020">CTF_CyberChallenge</a></p>
<h1 id="writeup">Writeup</h1>
<blockquote>
<p>The challenge was Italian</p>
</blockquote>
<ul>
<li><a href="#writeup">Writeup</a>
<ul>
<li><a href="#start">Start</a></li>
<li><a href="#sito">Sito</a>
<ul>
<li><a href="#hint-1">Hint 1</a></li>
</ul>
</li>
<li><a href="#disk">Disk</a>
<ul>
<li><a href="#hint-2">Hint 2</a></li>
<li><a href="#forensics">Forensics</a></li>
<li><a href="#crackme">Reverse Engineering</a>
<ul>
<li><a href="#hint-3">Hint 3</a></li>
</ul>
</li>
<li><a href="#stenography">Steganography</a></li>
<li><a href="#cracking">Cracking</a>
<ul>
<li><a href="#hint-4">Hint 4</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#conclusione">Conclusione</a></li>
<li><a href="#extras">Extra</a></li>
</ul>
</li>
</ul>
<h2 id="start">Start</h2>
<p>La challenge inizia con uno zip.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">unzip challenge_gruppo_1.zip
</code></pre></div><p>All&rsquo;interno dello zip troviamo diversi file:</p>
<ul>
<li>
<p><strong>get_flag.py</strong> : script python che una volta fornita la password corretta
stampa la flag</p>
</li>
<li>
<p><strong>start</strong> : eseguibile per l&rsquo;inizio della challenge</p>
</li>
<li>
<p><strong>stage1.txt</strong> : file di benvenuto</p>
<p>Osserviamo lo start fare cose (LOL). Alla fine ci indirizza ad un
<a href="https://joshuachp.github.io/CTF/CCIT_challenge/">sito web</a>.</p>
</li>
</ul>
<h2 id="sito">Sito</h2>
<p>Accediamo al sito e troviamo che il campo username è vulnerabile a SQLI ber il
bypass dell&rsquo;autenticazione.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">admin</span><span style="color:#e6db74">&#39; --
</span></code></pre></div><p>Questo ci permette di scaricare un file <code>disk</code>.</p>
<blockquote>
<p>Il sito non utilizza un database in quanto è una pagina statica. Anche lo se
lo script è minified, con un po&rsquo; di reversing si può benissimo trovare la
funzione del download, però non è pratico in quanto per questioni di tempo la
query è molto semplice.</p>
</blockquote>
<h3 id="hint-1">Hint 1</h3>
<p>Nel source del sito possiamo trovare un commento suggerisce di utilizzare SQL
Injection.</p>
<h2 id="disk">Disk</h2>
<p>Utilizzando il comando <code>file</code> su disk possiamo vedere:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">disk: Linux rev 1.0 ext2 filesystem data, ...
</code></pre></div><p>Essendo un file-system procediamo quindi a creare una cartella dove eseguire il
mount</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir mnt
sudo mount disk mnt
</code></pre></div><p>Nella cartella <code>mnt</code> troviamo i seguenti file:</p>
<ul>
<li><strong>next_stage.txt</strong> : un testo che come all&rsquo;inizio ci indica la strada da
proseguire.</li>
<li><strong>helpful.png</strong> : immagine con Clippy che ci lascia un messaggio</li>
</ul>
<p>Clippy nel suo messaggio cita un eseguibile di cui fare il reverse engineering,
però non abbiamo al momento nessun eseguibile.</p>
<h3 id="hint-2">Hint 2</h3>
<p>Analizziamo quindi il contenuto del file <code>next_stage.txt</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">strings next_stage.txt
strings -10 next_stage.txt
</code></pre></div><p>Notiamo una stringa in base64, decodificata proseguiamo ad analizzarla notando
che è stato applicato uno shift</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;RnIgZnJ2IG95YnBwbmdiIHZhIGdoZ2d2IGRocmZndiBPVkEgY2ViaW4gbiBzbmVndiBoYW4gSk5ZWCA6KQo=&#34;</span> | base64 -d | tr ‘n-za-mN-ZA-M’ ‘a-zA-Z’
<span style="color:#75715e"># Oppure se si ha installati bsd_games</span>
echo <span style="color:#e6db74">&#34;RnIgZnJ2IG95YnBwbmdiIHZhIGdoZ2d2IGRocmZndiBPVkEgY2ViaW4gbiBzbmVndiBoYW4gSk5ZWCA6KQo=&#34;</span> | base64 -d | rot13
</code></pre></div><p>Unendo le varie informazioni trovate sappiamo che sono stati eliminati dei file
e ci viene citato <code>binwalk</code>.</p>
<h3 id="forensics">Forensics</h3>
<p>Il filesystem mantiene i dati scritti su disco anche dopo l&rsquo;eliminazione dato
che vengono solo eliminati i nodi e considerato come freespace. Per estrarre i
dati ci sono vari modi: testdisk, ext-undelete, scalpel&hellip; Noi mostreremo un
metodo utilizzando binwalk.</p>
<p>Come suggerito proviamo a utilizzare binwalk su disk per trovare tutti i dati
contenuti, nelle nuove versioni è necessario utilizzare il tag <code>-b</code>.</p>
<p>Facendo un prima analisi sul file disk possiamo notare che contiene file di
estensione nota e che quando abbiamo fatto il mount non erano presenti</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">strings -10 disk | grep -i <span style="color:#e6db74">&#34;[a-z_]*\.[a-z]*&#34;</span>
strings | head
<span style="color:#75715e"># next_stage.txt</span>
<span style="color:#75715e"># sneaky.tar.gz</span>
<span style="color:#75715e"># helpful.png</span>
</code></pre></div><p>Una volta visto l&rsquo;esistenza di un file non presente alla montatura procediamo
con l&rsquo;estrazione e l&rsquo;analisi dei files utilizzando binwalk con la flag <code>-e</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">binwalk -e -b disk
cd _disk.extracted/
file *
tar -xvf <span style="color:#ae81ff">7400</span>
</code></pre></div><p>Il tar contiene i seguenti files:</p>
<ul>
<li><strong>final_stage.txt</strong> : testo</li>
<li><strong>crackme</strong> : eseguibile</li>
</ul>
<blockquote>
<p>Utilizzando lo strumento testdisk è possibile riconoscere il file rimosso, ma
non è possibile l&rsquo;estrazione</p>
</blockquote>
<h3 id="reverse-engineering">Reverse Engineering</h3>
<p>Analizzando crackme troviamo che dal main viene chiamata una funzione da un
array di funzioni nominato <code>table</code>. La funzione chiamata è la funzione <code>j</code>, dato
che viene l&rsquo;indice viene determinato dal calcolo di <code>modular_exponentiation</code>
sulla base di parametri statici.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++">argv_to_int <span style="color:#f92672">=</span> atoi(<span style="color:#f92672">*</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>)(param_2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>));
table_index <span style="color:#f92672">=</span> modular_exponentiation(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0x2b</span>,<span style="color:#ae81ff">7</span>);
cVar1 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(table <span style="color:#f92672">+</span> (ulong)table_index <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)((ulong)argv_to_int);
</code></pre></div><p>Proseguendo l&rsquo;analisi della funzione <code>j</code> notiamo che al suo interno chiama una
funzione di controllo (<code>fourth_check</code>) passando come argomento del binary.
<code>fourth_check</code> divide il valore che abbiamo inserito in 4 variabili tramite
operazioni binarie che utilizza poi in un sistema lineare a quattro incognite.
La funzione <code>j</code> controllerà poi i risultati di questo sistema con i valori
contenuti in un array inizializzato all&rsquo;interno della procedura.</p>
<p>Conoscendo tutti questi valori possiamo quindi creare un sistema lineare dove
poniamo come incognite le quattro parti in cui il nostro valore di ingresso è
stato diviso e una volta che abbiamo ottenuto il valore andiamo a fare il
reverse dell&rsquo;operazione di <code>&gt;&gt;</code> per ottenere il valore corretto.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> math

<span style="color:#e6db74">&#34;&#34;&#34; fourth_check() - from ghidra
</span><span style="color:#e6db74">uint32_t a = n &amp; 0xFF;
</span><span style="color:#e6db74">uint32_t b = (n &gt;&gt; 8) &amp; 0xFF;
</span><span style="color:#e6db74">uint32_t c = (n &gt;&gt; 16) &amp; 0xFF;
</span><span style="color:#e6db74">uint32_t d = (n &gt;&gt; 24) &amp; 0xFF;
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">uint32_t v1 = &#39;J&#39; * a + &#39;o&#39; * b + &#39;j&#39; * c + &#39;o&#39; * d;
</span><span style="color:#e6db74">uint32_t v2 = &#39;D&#39; * a + &#39;I&#39; * b + &#39;O&#39; * c + &#39;!&#39; * d;
</span><span style="color:#e6db74">uint32_t v3 = &#39;Z&#39; * a + &#39;A&#39; * b + &#39;W&#39; * c + &#39;A&#39; * d;
</span><span style="color:#e6db74">uint32_t v4 = &#39;R&#39; * a + &#39;U&#39; * b + &#39;D&#39; * c + &#39;O&#39; * d;
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">uint32_t vals[4] = {61319, 38111, 48787, 48939};
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">char_to_str</span>(chrs):
<span style="color:#66d9ef">return</span> [ord(c) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> chrs]

incognite <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([char_to_str(<span style="color:#e6db74">&#34;Jojo&#34;</span>), char_to_str(<span style="color:#e6db74">&#34;DIO!&#34;</span>), char_to_str(<span style="color:#e6db74">&#34;ZAWA&#34;</span>), char_to_str(<span style="color:#e6db74">&#34;RUDO&#34;</span>)])
valori <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">61319</span>, <span style="color:#ae81ff">38111</span>, <span style="color:#ae81ff">48787</span>, <span style="color:#ae81ff">48939</span>])
risultato <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>solve(incognite, valori)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Values are: {}&#34;</span><span style="color:#f92672">.</span>format(risultato)) <span style="color:#75715e"># Values are: [198.  96. 146. 185.]</span>

values <span style="color:#f92672">=</span> [<span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">96</span>, <span style="color:#ae81ff">146</span>, <span style="color:#ae81ff">185</span>]
values<span style="color:#f92672">.</span>reverse()
binary <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;{0:08b}&#34;</span><span style="color:#f92672">.</span>format(b) <span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> values]
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Value: {}&#34;</span><span style="color:#f92672">.</span>format(int(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(binary), <span style="color:#ae81ff">2</span>))) <span style="color:#75715e"># 3113377990</span>
</code></pre></div><p>Eseguiamo quindi crackme passando come parametro il valore calcolato e otteniamo
un HASH(SHA2).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./crackme <span style="color:#ae81ff">3113377990</span>
<span style="color:#75715e"># 0051377D1EE813EBFB59991D9165D88EC8C28C51AB37268A01DE386D00AE873AE34051D74CEEF2E457AB2D06BF283BEE87D0A209242B004DC27892DA6DB1AE1C</span>
</code></pre></div><h4 id="hint-3">Hint 3</h4>
<p>Nell&rsquo;eseguibile viene eseguito un controllo tra la stringa &ldquo;stuck&rdquo; e una
variabile di nome <code>hint</code>. Se andiamo a controllare il valore della variabile, ci
consiglia di trovare dinamicamente la funzione chiamata dal main o di cambiare
il tipo della variabile <code>table</code> in un array di funzioni per capire quale di
queste chiami. La stringa la possiamo notare eseguendo strings del nostro
eseguibile.</p>
<h3 id="steganography">Steganography</h3>
<p>Consideriamo l&rsquo;immagine <code>helpful.png</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">strings helpful.png
<span style="color:#75715e"># at Least you&#39;re putting Significant effort into this challenge</span>
</code></pre></div><p>Dato il suggerimento proviamo a vedere se abbiamo qualcosa nei
<a href="https://www.boiteaklou.fr/Steganography-Least-Significant-Bit.html">bit meno significativi</a>.
Utilizzando il codice fornito all&rsquo;interno della pagina web otteniamo il nostro
messaggio nascosto.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> base64
<span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image

image <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#34;./helpful.png&#34;</span>)
extracted <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
pixels <span style="color:#f92672">=</span> image<span style="color:#f92672">.</span>load()
<span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,image<span style="color:#f92672">.</span>width):
r,g,b <span style="color:#f92672">=</span> pixels[x,<span style="color:#ae81ff">0</span>]
extracted <span style="color:#f92672">+=</span> bin(r)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
extracted <span style="color:#f92672">+=</span> bin(g)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
extracted <span style="color:#f92672">+=</span> bin(b)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]

chars <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(extracted)<span style="color:#f92672">//</span><span style="color:#ae81ff">8</span>):
byte <span style="color:#f92672">=</span> extracted[(i<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>):(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>]
chars<span style="color:#f92672">.</span>append(chr(int(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join([str(bit) <span style="color:#66d9ef">for</span> bit <span style="color:#f92672">in</span> byte]), <span style="color:#ae81ff">2</span>)))

flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(chars)
<span style="color:#66d9ef">print</span>(flag) <span style="color:#75715e"># This website might help you a lot: https://ecavicc.github.io/cyberchallenge/</span>
</code></pre></div><blockquote>
<p>Un altro tool più popolare da utilizzabile è zsteg in ruby per ricavare
direttamente il base64</p>
</blockquote>
<h3 id="cracking">Cracking</h3>
<p>Andiamo a forzare l&rsquo;hash che abbiamo ottenuto dall&rsquo;eseguibile per ottenere la
password che ci permetterà di ottenere la flag. Per crackare l&rsquo;hash andremo a
utilizzare hashcat fornendo una wordlist, si può anche trovare la soluzione su
<a href="https://crackstation.net/">CrackStation</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hashcat -a <span style="color:#ae81ff">0</span> -m <span style="color:#ae81ff">1700</span> hash rockyou.txt
<span style="color:#75715e"># Mr.Pickles</span>
</code></pre></div><h4 id="hint-4">Hint 4</h4>
<p>Il sito che abbiamo estratto  dall&rsquo;immagine contiene il simbolo # e un gattino
da qui possiamo collegare i due elementi e ottenere <code>hashcat</code>. Inoltre il link
presente infondo alla pagina, che porta alla canzione We Will Rock You, vuole
essere un suggerimento a utilizzare una wordlist di supporto.</p>
<h2 id="conclusione">Conclusione</h2>
<p>Eseguiamo il file python per ottenere la flag</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;Mr.Pickles&#34;</span> &gt; passwd
python3 get_flag.py &lt; passwd
</code></pre></div><p><code>FLAG{i_7urn3d_mys31f_i1n70_4_pick13}</code></p>
<h2 id="extras">Extras</h2>
<p>Piccoli easter-egg presenti nella sfida :smile:</p>
<ul>
<li><strong>Forgot Password</strong>: premere più volte <code>forget password</code> potrebbe aiutare.</li>
<li><strong>Copy Pasta</strong>: Crackme potrebbe esprimersi su Rick &amp; Morty.</li>
<li><strong>Hello There</strong>: Il sito nascosto da Clippy - con un gran icona - potrebbe
avere un saluto altrettanto nascosto.</li>
</ul>

    </div>
  </article>

  
  





  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/writeups">Writeups</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#start">Start</a></li>
    <li><a href="#sito">Sito</a>
      <ul>
        <li><a href="#hint-1">Hint 1</a></li>
      </ul>
    </li>
    <li><a href="#disk">Disk</a>
      <ul>
        <li><a href="#hint-2">Hint 2</a></li>
        <li><a href="#forensics">Forensics</a></li>
        <li><a href="#reverse-engineering">Reverse Engineering</a></li>
        <li><a href="#steganography">Steganography</a></li>
        <li><a href="#cracking">Cracking</a></li>
      </ul>
    </li>
    <li><a href="#conclusione">Conclusione</a></li>
    <li><a href="#extras">Extras</a></li>
  </ul>
</nav>
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&text=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&is_video=false&description=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=CyberChallengeIT%20CTF%20-%20Group%20Challenge&body=Check out this article: https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&title=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-digg fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&name=CyberChallengeIT%20CTF%20-%20Group%20Challenge&description=During%20the%20last%20week%20of%20preparation%20for%20che%20Cyber%20Challenge%20IT%20CTF%2c%20we%20were%20asked%20to%20do%20a%20CTF%20challenge%20our%20self.%20We%20were%20divided%20in%20groups%20and%20given%20a%20month%20to%20come%20up%20with%20a%20challenge.%0aOur%20group%20create%20an%20easy%20and%20guided%20challenge%2c%20since%20we%20were%20required%20to%20solve%20it%20in%20one%20hour.%20It%20will%20cover%20some%20basic%20aspect%20of%20all%20the%20kind%20of%20challenges%20types%20like%20Web%20Security%2c%20Reversing%2c%20Forensics%2c%20Cryptography.">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fjoshuachp.github.io%2fposts%2fccit-challenge%2f&t=CyberChallengeIT%20CTF%20-%20Group%20Challenge">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2020  Joshua Chapman 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/writeups">Writeups</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/js/main.js"></script>



</html>
