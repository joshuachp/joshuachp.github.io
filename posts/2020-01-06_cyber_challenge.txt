0:[[["",{"children":["posts",{"children":[["path","2020-01-06_cyber_challenge","d"],{"children":["__PAGE__?{\"path\":\"2020-01-06_cyber_challenge\"}",{}]}]}]},"$undefined","$undefined",true],"$L1","$L2"]]
2:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"/dev/blog - /dev/blog - CyberChallengeIT CTF - Group Challenge"}],["$","meta",null,{"name":"description","content":"An easy and guided CTF Challenge with writeup created for the 2020 CyberChallenge Italy."}],["$","meta",null,{"name":"application-name","content":"/dev/blog"}],null,null,["$","meta",null,{"name":"generator","content":"Next.js"}],["$","meta",null,{"name":"keywords","content":"Dev,Blog,Programmings"}],["$","meta",null,{"name":"referrer","content":"origin-when-cross-origin"}],[["$","meta",null,{"name":"theme-color","content":"amber"}]],["$","meta",null,{"name":"color-scheme","content":"dark"}],["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta",null,{"name":"creator","content":"Joshua Chapman"}],null,null,null,null,null,null,null,null,null,[]],[["$","link",null,{"rel":"canonical","href":"https://joshuachp.dev/posts/2020-01-06_cyber_challenge"}],null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.svg","type":"image/svg+xml"}],["$","link",null,{"rel":"icon","href":"/favicon.png","type":"image/png"}],["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon"}]],[],null]]
1:["$L3",null,null,[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/816f3edd0640ecf0.css","precedence":"next.js"}]]]
4:I{"id":"5376","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-dbf5b5d6790748f6"],"async":false}
5:I{"id":"6722","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-dbf5b5d6790748f6"],"async":false}
6:I{"id":"9299","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-dbf5b5d6790748f6"],"async":false}
7:I{"id":"5019","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-dbf5b5d6790748f6"],"async":false}
8:I{"id":"1300","name":"","chunks":["272:webpack-e24f1f8cbee90348","667:2443530c-65ca4daeaf429502","961:961-409d5e344dd5ce3d"],"async":false}
9:I{"id":"6022","name":"","chunks":["272:webpack-e24f1f8cbee90348","667:2443530c-65ca4daeaf429502","961:961-409d5e344dd5ce3d"],"async":false}
3:["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","$L4",null,{"production":true,"goatCounterApi":"a7d98e3f-b56b"}],["$","$L5",null,{"id":"dark-theme","strategy":"beforeInteractive","children":"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}"}]]}],["$","body",null,{"className":"bg-primary-50 dark:bg-primary-900","children":["$","$L6",null,{"children":[["$","$L7",null,{}],["$","main",null,{"className":"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96","children":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":"$undefined","asNotFound":false,"childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":false,"childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["path","2020-01-06_cyber_challenge","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":false,"childProp":{"current":["$La",null,null,[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/2a1840b1c557e13c.css","precedence":"next.js"}]]],"segment":"__PAGE__?{\"path\":\"2020-01-06_cyber_challenge\"}"}}],"segment":["path","2020-01-06_cyber_challenge","d"]}}],"segment":"posts"}}]}]]}]}]]}]
b:I{"id":"3619","name":"","chunks":["619:619-3a70a20416de9ff0","991:app/posts/page-9e8f371efaf8f89b"],"async":false}
c:I{"id":"7876","name":"","chunks":["619:619-3a70a20416de9ff0","563:app/posts/[path]/page-90d5ae579eab9225"],"async":false}
a:["$","article",null,{"className":"flex max-w-full grow flex-col justify-self-start","children":[["$","h1",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl","children":[["$","span","1",{"children":"CyberChallengeIT CTF - Group Challenge"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","4",{"children":"During the last week of preparation for che Cyber Challenge IT CTF, we were"}],"\r\n",["$","span","6",{"children":"asked to do a CTF challenge our self. We were divided in groups and given a"}],"\r\n",["$","span","8",{"children":"month to come up with a challenge."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","11",{"children":"Our group create an easy and guided challenge, since we were required to solve"}],"\r\n",["$","span","13",{"children":"it in one hour. It will cover some basic aspect of all the kind of challenges"}],"\r\n",["$","span","15",{"children":"types like Web Security, Reversing, Forensics, Cryptography."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","18",{"children":"If you want to try the challenge yourself you will start by downloading this"}],"\r\n",["$","span","20",{"children":"zip file:"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","$Lb",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"/CTF/CCIT_challenge/challenge_gruppo_1.zip","children":[["$","span","24",{"children":"challenge_gruppo_1.zip"}]]}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","28",{"children":"Thank you to all the tutors and the other group members which made all the"}],"\r\n",["$","span","30",{"children":"different parts of this challenge."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","33",{"children":"The source code for creating the challenge:"}],"\r\n",["$","$Lb",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://github.com/joshuachp/CTF_CyberChallengeIT_2020","children":[["$","span","36",{"children":"CTF_CyberChallenge"}]]}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","40",{"children":"Writeup"}]]}],["$","blockquote","46",{"children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","44",{"children":"The challenge was Italy so the writeup is in Italian"}]]}]]}],["$","h3",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":[["$","span","48",{"children":"Start"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","51",{"children":"La challenge inizia con uno zip."}]]}],["$","$Lc","55",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","54",{"children":"unzip challenge_gruppo_1.zip\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","57",{"children":"All"}],["$","span","58",{"children":"’"}],["$","span","59",{"children":"interno dello zip troviamo diversi file:"}]]}],["$","ul",null,{"className":"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc","children":[["$","li","71",{"className":"mb-2","children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","strong","66",{"children":[["$","span","65",{"children":"get_flag.py"}]]}],["$","span","67",{"children":" : script python che una volta fornita la password corretta"}],"\r\n",["$","span","69",{"children":"stampa la flag"}]]}]]}],["$","li","81",{"className":"mb-2","children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","strong","76",{"children":[["$","span","75",{"children":"start"}]]}],["$","span","77",{"children":" : eseguibile per l"}],["$","span","78",{"children":"’"}],["$","span","79",{"children":"inizio della challenge"}]]}]]}],["$","li","97",{"className":"mb-2","children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","strong","86",{"children":[["$","span","85",{"children":"stage1.txt"}]]}],["$","span","87",{"children":" : file di benvenuto"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","90",{"children":"Osserviamo lo start fare cose (LOL). Alla fine ci indirizza ad un"}],"\r\n",["$","$Lb",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://joshuachp.github.io/CTF/CCIT_challenge/","children":[["$","span","93",{"children":"sito web"}]]}],["$","span","95",{"children":"."}]]}]]}]]}],["$","h3",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":[["$","span","100",{"children":"Sito"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","103",{"children":"Accediamo al sito e troviamo che il campo username è vulnerabile a SQLI ber il"}],"\r\n",["$","span","105",{"children":"bypass dell"}],["$","span","106",{"children":"’"}],["$","span","107",{"children":"autenticazione."}]]}],["$","$Lc","111",{"language":"sql","className":"mb-4 mt-2","children":[["$","span","110",{"children":"admin' --\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","113",{"children":"Questo ci permette di scaricare un file "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"disk"}],["$","span","115",{"children":"."}]]}],["$","blockquote","129",{"children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","119",{"children":"Il sito non utilizza un database in quanto è una pagina statica. Anche lo se"}],"\r\n",["$","span","121",{"children":"lo script è minified, con un po"}],["$","span","122",{"children":"’"}],["$","span","123",{"children":" di reversing si può benissimo trovare la"}],"\r\n",["$","span","125",{"children":"funzione del download, però non è pratico in quanto per questioni di tempo la"}],"\r\n",["$","span","127",{"children":"query è molto semplice."}]]}]]}],["$","h4",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl","children":[["$","span","131",{"children":"Hint 1"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","134",{"children":"Nel source del sito possiamo trovare un commento suggerisce di utilizzare SQL"}],"\r\n",["$","span","136",{"children":"Injection."}]]}],["$","h3",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":[["$","span","139",{"children":"Disk"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","142",{"children":"Utilizzando il comando "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"file"}],["$","span","144",{"children":" su disk possiamo vedere:"}]]}],["$","$Lc","148",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","147",{"children":"disk: Linux rev 1.0 ext2 filesystem data, ...\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","150",{"children":"Essendo un file-system procediamo quindi a creare una cartella dove eseguire il"}],"\r\n",["$","span","152",{"children":"mount"}]]}],["$","$Lc","156",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","155",{"children":"mkdir mnt\nsudo mount disk mnt\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","158",{"children":"Nella cartella "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"mnt"}],["$","span","160",{"children":" troviamo i seguenti file:"}]]}],["$","ul",null,{"className":"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc","children":[["$","li","172",{"className":"mb-2","children":[["$","strong","166",{"children":[["$","span","165",{"children":"next_stage.txt"}]]}],["$","span","167",{"children":" : un testo che come all"}],["$","span","168",{"children":"’"}],["$","span","169",{"children":"inizio ci indica la strada da"}],"\r\n",["$","span","171",{"children":"proseguire."}]]}],["$","li","178",{"className":"mb-2","children":[["$","strong","176",{"children":[["$","span","175",{"children":"helpful.png"}]]}],["$","span","177",{"children":" : immagine con Clippy che ci lascia un messaggio"}]]}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","181",{"children":"Clippy nel suo messaggio cita un eseguibile di cui fare il reverse engineering,"}],"\r\n",["$","span","183",{"children":"però non abbiamo al momento nessun eseguibile."}]]}],["$","h4",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl","children":[["$","span","186",{"children":"Hint 2"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","189",{"children":"Analizziamo quindi il contenuto del file "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"next_stage.txt"}]]}],["$","$Lc","194",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","193",{"children":"strings next_stage.txt\nstrings -10 next_stage.txt\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","196",{"children":"Notiamo una stringa in base64, decodificata proseguiamo ad analizzarla notando"}],"\r\n",["$","span","198",{"children":"che è stato applicato uno shift"}]]}],["$","$Lc","202",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","201",{"children":"echo \"RnIgZnJ2IG95YnBwbmdiIHZhIGdoZ2d2IGRocmZndiBPVkEgY2ViaW4gbiBzbmVndiBoYW4gSk5ZWCA6KQo=\" | base64 -d | tr ‘n-za-mN-ZA-M’ ‘a-zA-Z’\n# Oppure se si ha installati bsd_games\necho \"RnIgZnJ2IG95YnBwbmdiIHZhIGdoZ2d2IGRocmZndiBPVkEgY2ViaW4gbiBzbmVndiBoYW4gSk5ZWCA6KQo=\" | base64 -d | rot13\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","204",{"children":"Unendo le varie informazioni trovate sappiamo che sono stati eliminati dei file"}],"\r\n",["$","span","206",{"children":"e ci viene citato "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"binwalk"}],["$","span","208",{"children":"."}]]}],["$","h4",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl","children":[["$","span","211",{"children":"Forensics"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","214",{"children":"Il filesystem mantiene i dati scritti su disco anche dopo l"}],["$","span","215",{"children":"’"}],["$","span","216",{"children":"eliminazione dato"}],"\r\n",["$","span","218",{"children":"che vengono solo eliminati i nodi e considerato come freespace. Per estrarre i"}],"\r\n",["$","span","220",{"children":"dati ci sono vari modi: testdisk, ext-undelete, scalpel"}],["$","span","221",{"children":"…"}],["$","span","222",{"children":" Noi mostreremo un"}],"\r\n",["$","span","224",{"children":"metodo utilizzando binwalk."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","227",{"children":"Come suggerito proviamo a utilizzare binwalk su disk per trovare tutti i dati"}],"\r\n",["$","span","229",{"children":"contenuti, nelle nuove versioni è necessario utilizzare il tag "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"-b"}],["$","span","231",{"children":"."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","234",{"children":"Facendo un prima analisi sul file disk possiamo notare che contiene file di"}],"\r\n",["$","span","236",{"children":"estensione nota e che quando abbiamo fatto il mount non erano presenti"}]]}],["$","$Lc","240",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","239",{"children":"strings -10 disk | grep -i \"[a-z_]*\\.[a-z]*\"\nstrings | head\n# next_stage.txt\n# sneaky.tar.gz\n# helpful.png\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","242",{"children":"Una volta visto l"}],["$","span","243",{"children":"’"}],["$","span","244",{"children":"esistenza di un file non presente alla montatura procediamo"}],"\r\n",["$","span","246",{"children":"con l"}],["$","span","247",{"children":"’"}],["$","span","248",{"children":"estrazione e l"}],["$","span","249",{"children":"’"}],["$","span","250",{"children":"analisi dei files utilizzando binwalk con la flag "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"-e"}],["$","span","252",{"children":"."}]]}],["$","$Lc","256",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","255",{"children":"binwalk -e -b disk\ncd _disk.extracted/\nfile *\ntar -xvf 7400\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","258",{"children":"Il tar contiene i seguenti files:"}]]}],["$","ul",null,{"className":"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc","children":[["$","li","266",{"className":"mb-2","children":[["$","strong","264",{"children":[["$","span","263",{"children":"final_stage.txt"}]]}],["$","span","265",{"children":" : testo"}]]}],["$","li","272",{"className":"mb-2","children":[["$","strong","270",{"children":[["$","span","269",{"children":"crackme"}]]}],["$","span","271",{"children":" : eseguibile"}]]}]]}],["$","blockquote","282",{"children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","276",{"children":"Utilizzando lo strumento testdisk è possibile riconoscere il file rimosso, ma"}],"\r\n",["$","span","278",{"children":"non è possibile l"}],["$","span","279",{"children":"’"}],["$","span","280",{"children":"estrazione"}]]}]]}],["$","h4",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl","children":[["$","span","284",{"children":"Reverse Engineering"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","287",{"children":"Analizzando crackme troviamo che dal main viene chiamata una funzione da un"}],"\r\n",["$","span","289",{"children":"array di funzioni nominato "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"table"}],["$","span","291",{"children":". La funzione chiamata è la funzione "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"j"}],["$","span","293",{"children":","}],"\r\n",["$","span","295",{"children":"dato che viene l"}],["$","span","296",{"children":"’"}],["$","span","297",{"children":"indice viene determinato dal calcolo di"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"modular_exponentiation"}],["$","span","300",{"children":" sulla base di parametri statici."}]]}],["$","$Lc","304",{"language":"C++","className":"mb-4 mt-2","children":[["$","span","303",{"children":"argv_to_int = atoi(*(char **)(param_2 + 8));\ntable_index = modular_exponentiation(3,0x2b,7);\ncVar1 = *(table + (ulong)table_index * 8)((ulong)argv_to_int);\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","306",{"children":"Proseguendo l"}],["$","span","307",{"children":"’"}],["$","span","308",{"children":"analisi della funzione "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"j"}],["$","span","310",{"children":" notiamo che al suo interno chiama una"}],"\r\n",["$","span","312",{"children":"funzione di controllo ("}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"fourth_check"}],["$","span","314",{"children":") passando come argomento del binary."}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"fourth_check"}],["$","span","317",{"children":" divide il valore che abbiamo inserito in 4 variabili tramite"}],"\r\n",["$","span","319",{"children":"operazioni binarie che utilizza poi in un sistema lineare a quattro incognite."}],"\r\n",["$","span","321",{"children":"La funzione "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"j"}],["$","span","323",{"children":" controllerà poi i risultati di questo sistema con i valori"}],"\r\n",["$","span","325",{"children":"contenuti in un array inizializzato all"}],["$","span","326",{"children":"’"}],["$","span","327",{"children":"interno della procedura."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","330",{"children":"Conoscendo tutti questi valori possiamo quindi creare un sistema lineare dove"}],"\r\n",["$","span","332",{"children":"poniamo come incognite le quattro parti in cui il nostro valore di ingresso è"}],"\r\n",["$","span","334",{"children":"stato diviso e una volta che abbiamo ottenuto il valore andiamo a fare il"}],"\r\n",["$","span","336",{"children":"reverse dell"}],["$","span","337",{"children":"’"}],["$","span","338",{"children":"operazione di "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":">>"}],["$","span","340",{"children":" per ottenere il valore corretto."}]]}],["$","$Lc","344",{"language":"python","className":"mb-4 mt-2","children":[["$","span","343",{"children":"import numpy as np\nimport math\n\n\"\"\" fourth_check() - from ghidra\nuint32_t a = n & 0xFF;\nuint32_t b = (n >> 8) & 0xFF;\nuint32_t c = (n >> 16) & 0xFF;\nuint32_t d = (n >> 24) & 0xFF;\n\nuint32_t v1 = 'J' * a + 'o' * b + 'j' * c + 'o' * d;\nuint32_t v2 = 'D' * a + 'I' * b + 'O' * c + '!' * d;\nuint32_t v3 = 'Z' * a + 'A' * b + 'W' * c + 'A' * d;\nuint32_t v4 = 'R' * a + 'U' * b + 'D' * c + 'O' * d;\n\nuint32_t vals[4] = {61319, 38111, 48787, 48939};\n\"\"\"\n\ndef char_to_str(chrs):\nreturn [ord(c) for c in chrs]\n\nincognite = np.array([char_to_str(\"Jojo\"), char_to_str(\"DIO!\"), char_to_str(\"ZAWA\"), char_to_str(\"RUDO\")])\nvalori = np.array([61319, 38111, 48787, 48939])\nrisultato = np.linalg.solve(incognite, valori)\nprint(\"Values are: {}\".format(risultato)) # Values are: [198.  96. 146. 185.]\n\nvalues = [198, 96, 146, 185]\nvalues.reverse()\nbinary = [\"{0:08b}\".format(b) for b in values]\nprint(\"Value: {}\".format(int(\"\".join(binary), 2))) # 3113377990\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","346",{"children":"Eseguiamo quindi crackme passando come parametro il valore calcolato e"}],"\r\n",["$","span","348",{"children":"otteniamo un HASH(SHA2)."}]]}],["$","$Lc","352",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","351",{"children":"./crackme 3113377990\n# 0051377D1EE813EBFB59991D9165D88EC8C28C51AB37268A01DE386D00AE873AE34051D74CEEF2E457AB2D06BF283BEE87D0A209242B004DC27892DA6DB1AE1C\n"}]]}],["$","h5",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-lg font-semibold tracking-tight sm:text-xl md:text-2xl","children":[["$","span","354",{"children":"Hint 3"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","357",{"children":"Nell"}],["$","span","358",{"children":"’"}],["$","span","359",{"children":"eseguibile viene eseguito un controllo tra la stringa "}],["$","span","360",{"children":"“"}],["$","span","361",{"children":"stuck"}],["$","span","362",{"children":"”"}],["$","span","363",{"children":" e una"}],"\r\n",["$","span","365",{"children":"variabile di nome "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"hint"}],["$","span","367",{"children":". Se andiamo a controllare il valore della variabile,"}],"\r\n",["$","span","369",{"children":"ci consiglia di trovare dinamicamente la funzione chiamata dal main o di"}],"\r\n",["$","span","371",{"children":"cambiare il tipo della variabile "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"table"}],["$","span","373",{"children":" in un array di funzioni per capire"}],"\r\n",["$","span","375",{"children":"quale di queste chiami. La stringa la possiamo notare eseguendo strings del"}],"\r\n",["$","span","377",{"children":"nostro eseguibile."}]]}],["$","h4",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl","children":[["$","span","380",{"children":"Steganography"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","383",{"children":"Consideriamo l"}],["$","span","384",{"children":"’"}],["$","span","385",{"children":"immagine "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"helpful.png"}]]}],["$","$Lc","390",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","389",{"children":"strings helpful.png\n# at Least you're putting Significant effort into this challenge\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","392",{"children":"Dato il suggerimento proviamo a vedere se abbiamo qualcosa nei"}],"\r\n",["$","$Lb",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://www.boiteaklou.fr/Steganography-Least-Significant-Bit.html","children":[["$","span","395",{"children":"bit meno significativi"}]]}],["$","span","397",{"children":"."}],"\r\n",["$","span","399",{"children":"Utilizzando il codice fornito all"}],["$","span","400",{"children":"’"}],["$","span","401",{"children":"interno della pagina web otteniamo il nostro"}],"\r\n",["$","span","403",{"children":"messaggio nascosto."}]]}],["$","$Lc","407",{"language":"python","className":"mb-4 mt-2","children":[["$","span","406",{"children":"import base64\nfrom PIL import Image\n\nimage = Image.open(\"./helpful.png\")\nextracted = ''\npixels = image.load()\nfor x in range(0,image.width):\nr,g,b = pixels[x,0]\nextracted += bin(r)[-1]\nextracted += bin(g)[-1]\nextracted += bin(b)[-1]\n\nchars = []\nfor i in range(len(extracted)//8):\nbyte = extracted[(i*8):(i+1)*8]\nchars.append(chr(int(''.join([str(bit) for bit in byte]), 2)))\n\nflag = ''.join(chars)\nprint(flag) # This website might help you a lot: https://ecavicc.github.io/cyberchallenge/\n"}]]}],["$","blockquote","414",{"children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","410",{"children":"Un altro tool più popolare da utilizzabile è zsteg in ruby per ricavare"}],"\r\n",["$","span","412",{"children":"direttamente il base64"}]]}]]}],["$","h3",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":[["$","span","416",{"children":"Cracking"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","419",{"children":"Andiamo a forzare l"}],["$","span","420",{"children":"’"}],["$","span","421",{"children":"hash che abbiamo ottenuto dall"}],["$","span","422",{"children":"’"}],["$","span","423",{"children":"eseguibile per ottenere la"}],"\r\n",["$","span","425",{"children":"password che ci permetterà di ottenere la flag. Per crackare l"}],["$","span","426",{"children":"’"}],["$","span","427",{"children":"hash andremo a"}],"\r\n",["$","span","429",{"children":"utilizzare hashcat fornendo una wordlist, si può anche trovare la soluzione su"}],"\r\n",["$","$Lb",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://crackstation.net/","children":[["$","span","432",{"children":"CrackStation"}]]}]]}],["$","$Lc","437",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","436",{"children":"hashcat -a 0 -m 1700 hash rockyou.txt\n# Mr.Pickles\n"}]]}],["$","h4",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl","children":[["$","span","439",{"children":"Hint 4"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","442",{"children":"Il sito che abbiamo estratto dall"}],["$","span","443",{"children":"’"}],["$","span","444",{"children":"immagine contiene il simbolo # e un gattino"}],"\r\n",["$","span","446",{"children":"da qui possiamo collegare i due elementi e ottenere "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"hashcat"}],["$","span","448",{"children":". Inoltre il link"}],"\r\n",["$","span","450",{"children":"presente infondo alla pagina, che porta alla canzione We Will Rock You, vuole"}],"\r\n",["$","span","452",{"children":"essere un suggerimento a utilizzare una wordlist di supporto."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","455",{"children":"Conclusione"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","458",{"children":"Eseguiamo il file python per ottenere la flag"}]]}],["$","$Lc","462",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","461",{"children":"echo \"Mr.Pickles\" > passwd\npython3 get_flag.py < passwd\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"FLAG{i_7urn3d_mys31f_i1n70_4_pick13}"}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","467",{"children":"Extras"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","470",{"children":"Piccoli easter-egg presenti nella sfida :smile:"}]]}],["$","ul",null,{"className":"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc","children":[["$","li","480",{"className":"mb-2","children":[["$","strong","476",{"children":[["$","span","475",{"children":"Forgot Password"}]]}],["$","span","477",{"children":": premere più volte "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"forget password"}],["$","span","479",{"children":" potrebbe aiutare."}]]}],["$","li","486",{"className":"mb-2","children":[["$","strong","484",{"children":[["$","span","483",{"children":"Copy Pasta"}]]}],["$","span","485",{"children":": Crackme potrebbe esprimersi su Rick & Morty."}]]}],["$","li","494",{"className":"mb-2","children":[["$","strong","490",{"children":[["$","span","489",{"children":"Hello There"}]]}],["$","span","491",{"children":": Il sito nascosto da Clippy - con un gran icona - potrebbe"}],"\r\n",["$","span","493",{"children":"avere un saluto altrettanto nascosto."}]]}]]}]]}]
