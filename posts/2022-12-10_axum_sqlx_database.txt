0:[[["",{"children":["posts",{"children":[["path","2022-12-10_axum_sqlx_database","d"],{"children":["__PAGE__?{\"path\":\"2022-12-10_axum_sqlx_database\"}",{}]}]}]},"$undefined","$undefined",true],"$L1","$L2"]]
2:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"/dev/blog - /dev/blog - Axum sqlx database"}],["$","meta",null,{"name":"description","content":"Implement database connection Axum server w"}],["$","meta",null,{"name":"application-name","content":"/dev/blog"}],null,null,["$","meta",null,{"name":"generator","content":"Next.js"}],["$","meta",null,{"name":"keywords","content":"Dev,Blog,Programmings"}],["$","meta",null,{"name":"referrer","content":"origin-when-cross-origin"}],[["$","meta",null,{"name":"theme-color","content":"amber"}]],["$","meta",null,{"name":"color-scheme","content":"dark"}],["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta",null,{"name":"creator","content":"Joshua Chapman"}],null,null,null,null,null,null,null,null,null,[]],[["$","link",null,{"rel":"canonical","href":"https://joshuachp.dev/posts/2022-12-10_axum_sqlx_database"}],null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.svg","type":"image/svg+xml"}],["$","link",null,{"rel":"icon","href":"/favicon.png","type":"image/png"}],["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon"}]],[],null]]
1:["$L3",null,null,[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/816f3edd0640ecf0.css","precedence":"next.js"}]]]
4:I{"id":"5376","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-147fc0c93c3f3e98"],"async":false}
5:I{"id":"9299","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-147fc0c93c3f3e98"],"async":false}
6:I{"id":"5019","name":"","chunks":["619:619-3a70a20416de9ff0","185:app/layout-147fc0c93c3f3e98"],"async":false}
7:I{"id":"1300","name":"","chunks":["272:webpack-e24f1f8cbee90348","667:2443530c-65ca4daeaf429502","961:961-409d5e344dd5ce3d"],"async":false}
8:I{"id":"6022","name":"","chunks":["272:webpack-e24f1f8cbee90348","667:2443530c-65ca4daeaf429502","961:961-409d5e344dd5ce3d"],"async":false}
3:["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","$L4",null,{"production":true,"goatCounterApi":"a7d98e3f-b56b"}],["$","script",null,{"id":"dark-theme","dangerouslySetInnerHTML":{"__html":"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}"}}]]}],["$","body",null,{"className":"bg-primary-50 dark:bg-primary-900","children":["$","$L5",null,{"children":[["$","$L6",null,{}],["$","main",null,{"className":"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96","children":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":"$undefined","asNotFound":false,"childProp":{"current":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":false,"childProp":{"current":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["path","2022-12-10_axum_sqlx_database","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":false,"childProp":{"current":["$L9",null,null,[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/2a1840b1c557e13c.css","precedence":"next.js"}]]],"segment":"__PAGE__?{\"path\":\"2022-12-10_axum_sqlx_database\"}"}}],"segment":["path","2022-12-10_axum_sqlx_database","d"]}}],"segment":"posts"}}]}]]}]}]]}]
a:I{"id":"3619","name":"","chunks":["619:619-3a70a20416de9ff0","991:app/posts/page-a8aca74000a1e875"],"async":false}
b:I{"id":"7876","name":"","chunks":["619:619-3a70a20416de9ff0","563:app/posts/[path]/page-deda6ae7686b2d48"],"async":false}
9:["$","article",null,{"className":"flex max-w-full grow flex-col justify-self-start","children":[["$","h1",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl","children":[["$","span","1",{"children":"Axum sqlx database"}]]}],["$","ul",null,{"className":"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc","children":[["$","li","33",{"className":"mb-2","children":[["$","span","5",{"children":"Install the dependencies:"}],"\r\n",["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"cargo add sqlx --features=runtime-tokio-native-tls,sqlite,macros,offline"}],["$","ul",null,{"className":"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc","children":[["$","li","11",{"className":"mb-2","children":[["$","span","10",{"children":"use tokio since axum is based on it"}]]}],["$","li","14",{"className":"mb-2","children":[["$","span","13",{"children":"native TLS openssl but is the same as rust-ls"}]]}],["$","li","17",{"className":"mb-2","children":[["$","span","16",{"children":"sqlite as the database engine"}]]}],["$","li","20",{"className":"mb-2","children":[["$","span","19",{"children":"macros for type safe queries"}]]}],["$","li","23",{"className":"mb-2","children":[["$","span","22",{"children":"offline mode for CI and test"}]]}],["$","li","31",{"className":"mb-2","children":[["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"chrono"}],["$","span","26",{"children":" "}],["$","em","29",{"children":[["$","span","28",{"children":"(optional)"}]]}],["$","span","30",{"children":" for dates and times"}]]}]]}]]}],["$","li","41",{"className":"mb-2","children":[["$","span","35",{"children":"Install "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"sqlx-cli"}],["$","span","37",{"children":" for migrations, through "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"nix"}],["$","span","39",{"children":" or "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"cargo install"}]]}],["$","li","56",{"className":"mb-2","children":[["$","span","43",{"children":"Sqlite connection option:"}],["$","ul",null,{"className":"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc","children":[["$","li","51",{"className":"mb-2","children":[["$","span","46",{"children":"see the series"}],"\r\n",["$","$La",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://fly.io/blog/sqlite-internals-wal/","children":[["$","span","49",{"children":"fly.io - sqlite internals wall"}]]}]]}],["$","li","54",{"className":"mb-2","children":[["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"journal_mode=wall"}]]}]]}]]}]]}],["$","$Lb","60",{"language":"rust","className":"mb-4 mt-2","children":[["$","span","59",{"children":"let options = SqliteConnectOptions::from_str(db_url)?\n    .journal_mode(SqliteJournalMode::Wal);\nlet pool = SqlitePool::connect_with(options).await?;\n"}]]}],["$","ul",null,{"className":"mb-4 mt-2 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc","children":[["$","li","69",{"className":"mb-2","children":[["$","span","63",{"children":"add it to the state of the application, pool is a value wrapped in an "}],["$","code",null,{"className":" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg","children":"Arc"}],"\r\n",["$","span","66",{"children":"so it"}],["$","span","67",{"children":"â€™"}],["$","span","68",{"children":"s safe to clone if needed and pass between threads."}]]}]]}],["$","$Lb","73",{"language":"rust","className":"mb-4 mt-2","children":[["$","span","72",{"children":"let app = app().with_state(State(pool));\n"}]]}]]}]
