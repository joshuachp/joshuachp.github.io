<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" type="image/svg+xml" href="/favicon.svg"/><link rel="icon" type="image/png" href="/favicon.png"/><link rel="icon" type="image/x-icon" href="/favicon.ico"/><title>/dev/blog - CyberChallengeIT CTF - Group Challenge</title><meta name="description" content="An easy and guided CTF Challenge with writeup created for the 2020 CyberChallenge Italy."/><link rel="canonical" href="https://joshuachp.dev/posts/2020-01-06_cyber_challenge"/><meta name="next-head-count" content="8"/><script id="dark-theme" data-nscript="beforeInteractive">if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}</script><link rel="preload" href="/_next/static/css/5fc30b497c9bed6d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5fc30b497c9bed6d.css" data-n-g=""/><link rel="preload" href="/_next/static/css/2a1840b1c557e13c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2a1840b1c557e13c.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-2751f6424e24f776.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-f11614d8aa7ee555.js" defer=""></script><script src="/_next/static/chunks/pages/_app-a9d23293c892d64a.js" defer=""></script><script src="/_next/static/chunks/664-e2359597ac708d8d.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bpath%5D-9dcb15b2d370bd2e.js" defer=""></script><script src="/_next/static/CChp-v68ZvN-mJV1X79Da/_buildManifest.js" defer=""></script><script src="/_next/static/CChp-v68ZvN-mJV1X79Da/_ssgManifest.js" defer=""></script></head><body class="bg-primary-50 dark:bg-primary-900"><div id="__next"><header class="flex flex-row items-baseline justify-between gap-4 p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><nav class="flex flex-grow flex-row flex-wrap gap-y-4"><a title="Home page" class="mr-8" href="/"><h1 class=" text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl">/dev/blog</h1></a><ul class="flex flex-grow flex-row items-end justify-start gap-8"><li><a title="Posts" href="/posts"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50 underline font-bold">Posts</span></a></li><li><a title="Notes" href="/notes"><span class="text-xl md:text-2xl text-primary-900 dark:text-primary-50  font-bold">Notes</span></a></li></ul></nav><div><button class="rounded border-t-2 border-l-2 border-r-4 border-b-4  border-primary-900 px-4 py-2 text-sm font-medium text-primary-900  hover:bg-primary-100 active:translate-y-0.5 dark:border-primary-50 dark:text-primary-50 dark:hover:bg-primary-800 "><span class="text-sm sm:text-base xl:text-lg text-primary-900 dark:text-primary-50 font-semibold">Auto</span></button></div></header><main class="flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96"><article class="flex max-w-full grow flex-col justify-self-start"><h1 class="mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl"><span>CyberChallengeIT CTF - Group Challenge</span></h1><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>During the last week of preparation for che Cyber Challenge IT CTF, we were</span>
<span>asked to do a CTF challenge our self. We were divided in groups and given a</span>
<span>month to come up with a challenge.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Our group create an easy and guided challenge, since we were required to solve</span>
<span>it in one hour. It will cover some basic aspect of all the kind of challenges</span>
<span>types like Web Security, Reversing, Forensics, Cryptography.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>If you want to try the challenge yourself you will start by downloading this</span>
<span>zip file:</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="/CTF/CCIT_challenge/challenge_gruppo_1.zip"><span>challenge_gruppo_1.zip</span></a></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Thank you to all the tutors and the other group members which made all the</span>
<span>different parts of this challenge.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The source code for creating the challenge:</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://github.com/joshuachp/CTF_CyberChallengeIT_2020"><span>CTF_CyberChallenge</span></a></p><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Writeup</span></h2><blockquote><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>The challenge was Italy so the writeup is in Italian</span></p></blockquote><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Start</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>La challenge inizia con uno zip.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>unzip challenge_gruppo_1.zip
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>All</span><span>’</span><span>interno dello zip troviamo diversi file:</span></p><ul class="mb-4 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc"><li class="mb-2"><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><strong><span>get_flag.py</span></strong><span> : script python che una volta fornita la password corretta</span>
<span>stampa la flag</span></p></li><li class="mb-2"><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><strong><span>start</span></strong><span> : eseguibile per l</span><span>’</span><span>inizio della challenge</span></p></li><li class="mb-2"><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><strong><span>stage1.txt</span></strong><span> : file di benvenuto</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Osserviamo lo start fare cose (LOL). Alla fine ci indirizza ad un</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://joshuachp.github.io/CTF/CCIT_challenge/"><span>sito web</span></a><span>.</span></p></li></ul><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Sito</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Accediamo al sito e troviamo che il campo username è vulnerabile a SQLI ber il</span>
<span>bypass dell</span><span>’</span><span>autenticazione.</span></p><pre class="language-sql mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>admin&#x27; --
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Questo ci permette di scaricare un file </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">disk</code><span>.</span></p><blockquote><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Il sito non utilizza un database in quanto è una pagina statica. Anche lo se</span>
<span>lo script è minified, con un po</span><span>’</span><span> di reversing si può benissimo trovare la</span>
<span>funzione del download, però non è pratico in quanto per questioni di tempo la</span>
<span>query è molto semplice.</span></p></blockquote><h4 class="mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl"><span>Hint 1</span></h4><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Nel source del sito possiamo trovare un commento suggerisce di utilizzare SQL</span>
<span>Injection.</span></p><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Disk</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Utilizzando il comando </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">file</code><span> su disk possiamo vedere:</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>disk: Linux rev 1.0 ext2 filesystem data, ...
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Essendo un file-system procediamo quindi a creare una cartella dove eseguire il</span>
<span>mount</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>mkdir mnt
sudo mount disk mnt
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Nella cartella </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">mnt</code><span> troviamo i seguenti file:</span></p><ul class="mb-4 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc"><li class="mb-2"><strong><span>next_stage.txt</span></strong><span> : un testo che come all</span><span>’</span><span>inizio ci indica la strada da</span>
<span>proseguire.</span></li><li class="mb-2"><strong><span>helpful.png</span></strong><span> : immagine con Clippy che ci lascia un messaggio</span></li></ul><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Clippy nel suo messaggio cita un eseguibile di cui fare il reverse engineering,</span>
<span>però non abbiamo al momento nessun eseguibile.</span></p><h4 class="mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl"><span>Hint 2</span></h4><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Analizziamo quindi il contenuto del file </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">next_stage.txt</code></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>strings next_stage.txt
strings -10 next_stage.txt
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Notiamo una stringa in base64, decodificata proseguiamo ad analizzarla notando</span>
<span>che è stato applicato uno shift</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>echo &quot;RnIgZnJ2IG95YnBwbmdiIHZhIGdoZ2d2IGRocmZndiBPVkEgY2ViaW4gbiBzbmVndiBoYW4gSk5ZWCA6KQo=&quot; | base64 -d | tr ‘n-za-mN-ZA-M’ ‘a-zA-Z’
# Oppure se si ha installati bsd_games
echo &quot;RnIgZnJ2IG95YnBwbmdiIHZhIGdoZ2d2IGRocmZndiBPVkEgY2ViaW4gbiBzbmVndiBoYW4gSk5ZWCA6KQo=&quot; | base64 -d | rot13
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Unendo le varie informazioni trovate sappiamo che sono stati eliminati dei file</span>
<span>e ci viene citato </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">binwalk</code><span>.</span></p><h4 class="mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl"><span>Forensics</span></h4><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Il filesystem mantiene i dati scritti su disco anche dopo l</span><span>’</span><span>eliminazione dato</span>
<span>che vengono solo eliminati i nodi e considerato come freespace. Per estrarre i</span>
<span>dati ci sono vari modi: testdisk, ext-undelete, scalpel</span><span>…</span><span> Noi mostreremo un</span>
<span>metodo utilizzando binwalk.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Come suggerito proviamo a utilizzare binwalk su disk per trovare tutti i dati</span>
<span>contenuti, nelle nuove versioni è necessario utilizzare il tag </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-b</code><span>.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Facendo un prima analisi sul file disk possiamo notare che contiene file di</span>
<span>estensione nota e che quando abbiamo fatto il mount non erano presenti</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>strings -10 disk | grep -i &quot;[a-z_]*\.[a-z]*&quot;
strings | head
# next_stage.txt
# sneaky.tar.gz
# helpful.png
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Una volta visto l</span><span>’</span><span>esistenza di un file non presente alla montatura procediamo</span>
<span>con l</span><span>’</span><span>estrazione e l</span><span>’</span><span>analisi dei files utilizzando binwalk con la flag </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">-e</code><span>.</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>binwalk -e -b disk
cd _disk.extracted/
file *
tar -xvf 7400
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Il tar contiene i seguenti files:</span></p><ul class="mb-4 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc"><li class="mb-2"><strong><span>final_stage.txt</span></strong><span> : testo</span></li><li class="mb-2"><strong><span>crackme</span></strong><span> : eseguibile</span></li></ul><blockquote><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Utilizzando lo strumento testdisk è possibile riconoscere il file rimosso, ma</span>
<span>non è possibile l</span><span>’</span><span>estrazione</span></p></blockquote><h4 class="mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl"><span>Reverse Engineering</span></h4><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Analizzando crackme troviamo che dal main viene chiamata una funzione da un</span>
<span>array di funzioni nominato </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">table</code><span>. La funzione chiamata è la funzione </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">j</code><span>,</span>
<span>dato che viene l</span><span>’</span><span>indice viene determinato dal calcolo di</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">modular_exponentiation</code><span> sulla base di parametri statici.</span></p><pre class="language-C++ mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>argv_to_int = atoi(*(char **)(param_2 + 8));
table_index = modular_exponentiation(3,0x2b,7);
cVar1 = *(table + (ulong)table_index * 8)((ulong)argv_to_int);
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Proseguendo l</span><span>’</span><span>analisi della funzione </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">j</code><span> notiamo che al suo interno chiama una</span>
<span>funzione di controllo (</span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">fourth_check</code><span>) passando come argomento del binary.</span>
<code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">fourth_check</code><span> divide il valore che abbiamo inserito in 4 variabili tramite</span>
<span>operazioni binarie che utilizza poi in un sistema lineare a quattro incognite.</span>
<span>La funzione </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">j</code><span> controllerà poi i risultati di questo sistema con i valori</span>
<span>contenuti in un array inizializzato all</span><span>’</span><span>interno della procedura.</span></p><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Conoscendo tutti questi valori possiamo quindi creare un sistema lineare dove</span>
<span>poniamo come incognite le quattro parti in cui il nostro valore di ingresso è</span>
<span>stato diviso e una volta che abbiamo ottenuto il valore andiamo a fare il</span>
<span>reverse dell</span><span>’</span><span>operazione di </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">&gt;&gt;</code><span> per ottenere il valore corretto.</span></p><pre class="language-python mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>import numpy as np
import math

&quot;&quot;&quot; fourth_check() - from ghidra
uint32_t a = n &amp; 0xFF;
uint32_t b = (n &gt;&gt; 8) &amp; 0xFF;
uint32_t c = (n &gt;&gt; 16) &amp; 0xFF;
uint32_t d = (n &gt;&gt; 24) &amp; 0xFF;

uint32_t v1 = &#x27;J&#x27; * a + &#x27;o&#x27; * b + &#x27;j&#x27; * c + &#x27;o&#x27; * d;
uint32_t v2 = &#x27;D&#x27; * a + &#x27;I&#x27; * b + &#x27;O&#x27; * c + &#x27;!&#x27; * d;
uint32_t v3 = &#x27;Z&#x27; * a + &#x27;A&#x27; * b + &#x27;W&#x27; * c + &#x27;A&#x27; * d;
uint32_t v4 = &#x27;R&#x27; * a + &#x27;U&#x27; * b + &#x27;D&#x27; * c + &#x27;O&#x27; * d;

uint32_t vals[4] = {61319, 38111, 48787, 48939};
&quot;&quot;&quot;

def char_to_str(chrs):
return [ord(c) for c in chrs]

incognite = np.array([char_to_str(&quot;Jojo&quot;), char_to_str(&quot;DIO!&quot;), char_to_str(&quot;ZAWA&quot;), char_to_str(&quot;RUDO&quot;)])
valori = np.array([61319, 38111, 48787, 48939])
risultato = np.linalg.solve(incognite, valori)
print(&quot;Values are: {}&quot;.format(risultato)) # Values are: [198.  96. 146. 185.]

values = [198, 96, 146, 185]
values.reverse()
binary = [&quot;{0:08b}&quot;.format(b) for b in values]
print(&quot;Value: {}&quot;.format(int(&quot;&quot;.join(binary), 2))) # 3113377990
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Eseguiamo quindi crackme passando come parametro il valore calcolato e</span>
<span>otteniamo un HASH(SHA2).</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>./crackme 3113377990
# 0051377D1EE813EBFB59991D9165D88EC8C28C51AB37268A01DE386D00AE873AE34051D74CEEF2E457AB2D06BF283BEE87D0A209242B004DC27892DA6DB1AE1C
</span></code></pre><h5 class="mb-4 text-primary-900 dark:text-primary-50 text-lg font-semibold tracking-tight sm:text-xl md:text-2xl"><span>Hint 3</span></h5><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Nell</span><span>’</span><span>eseguibile viene eseguito un controllo tra la stringa </span><span>“</span><span>stuck</span><span>”</span><span> e una</span>
<span>variabile di nome </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">hint</code><span>. Se andiamo a controllare il valore della variabile,</span>
<span>ci consiglia di trovare dinamicamente la funzione chiamata dal main o di</span>
<span>cambiare il tipo della variabile </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">table</code><span> in un array di funzioni per capire</span>
<span>quale di queste chiami. La stringa la possiamo notare eseguendo strings del</span>
<span>nostro eseguibile.</span></p><h4 class="mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl"><span>Steganography</span></h4><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Consideriamo l</span><span>’</span><span>immagine </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">helpful.png</code></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>strings helpful.png
# at Least you&#x27;re putting Significant effort into this challenge
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Dato il suggerimento proviamo a vedere se abbiamo qualcosa nei</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://www.boiteaklou.fr/Steganography-Least-Significant-Bit.html"><span>bit meno significativi</span></a><span>.</span>
<span>Utilizzando il codice fornito all</span><span>’</span><span>interno della pagina web otteniamo il nostro</span>
<span>messaggio nascosto.</span></p><pre class="language-python mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>import base64
from PIL import Image

image = Image.open(&quot;./helpful.png&quot;)
extracted = &#x27;&#x27;
pixels = image.load()
for x in range(0,image.width):
r,g,b = pixels[x,0]
extracted += bin(r)[-1]
extracted += bin(g)[-1]
extracted += bin(b)[-1]

chars = []
for i in range(len(extracted)//8):
byte = extracted[(i*8):(i+1)*8]
chars.append(chr(int(&#x27;&#x27;.join([str(bit) for bit in byte]), 2)))

flag = &#x27;&#x27;.join(chars)
print(flag) # This website might help you a lot: https://ecavicc.github.io/cyberchallenge/
</span></code></pre><blockquote><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Un altro tool più popolare da utilizzabile è zsteg in ruby per ricavare</span>
<span>direttamente il base64</span></p></blockquote><h3 class="mb-4 text-primary-900 dark:text-primary-50 text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl"><span>Cracking</span></h3><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Andiamo a forzare l</span><span>’</span><span>hash che abbiamo ottenuto dall</span><span>’</span><span>eseguibile per ottenere la</span>
<span>password che ci permetterà di ottenere la flag. Per crackare l</span><span>’</span><span>hash andremo a</span>
<span>utilizzare hashcat fornendo una wordlist, si può anche trovare la soluzione su</span>
<a title="" class="font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600" href="https://crackstation.net/"><span>CrackStation</span></a></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>hashcat -a 0 -m 1700 hash rockyou.txt
# Mr.Pickles
</span></code></pre><h4 class="mb-4 text-primary-900 dark:text-primary-50 text-xl font-semibold tracking-tight sm:text-2xl md:text-3xl"><span>Hint 4</span></h4><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Il sito che abbiamo estratto dall</span><span>’</span><span>immagine contiene il simbolo # e un gattino</span>
<span>da qui possiamo collegare i due elementi e ottenere </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">hashcat</code><span>. Inoltre il link</span>
<span>presente infondo alla pagina, che porta alla canzione We Will Rock You, vuole</span>
<span>essere un suggerimento a utilizzare una wordlist di supporto.</span></p><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Conclusione</span></h2><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Eseguiamo il file python per ottenere la flag</span></p><pre class="language-bash mb-4 overflow-auto rounded border-2 border-primary-900 p-4 dark:border-primary-50"><code><span>echo &quot;Mr.Pickles&quot; &gt; passwd
python3 get_flag.py &lt; passwd
</span></code></pre><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">FLAG{i_7urn3d_mys31f_i1n70_4_pick13}</code></p><h2 class="mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl"><span>Extras</span></h2><p class="mb-4 inline text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg"><span>Piccoli easter-egg presenti nella sfida :smile:</span></p><ul class="mb-4 ml-6 text-primary-900 dark:text-primary-50 text-sm sm:text-base xl:text-lg list-disc"><li class="mb-2"><strong><span>Forgot Password</span></strong><span>: premere più volte </span><code class=" items-baseline rounded bg-primary-200 p-0.5 text-sm dark:bg-primary-700 sm:p-1 sm:text-base xl:text-lg">forget password</code><span> potrebbe aiutare.</span></li><li class="mb-2"><strong><span>Copy Pasta</span></strong><span>: Crackme potrebbe esprimersi su Rick &amp; Morty.</span></li><li class="mb-2"><strong><span>Hello There</span></strong><span>: Il sito nascosto da Clippy - con un gran icona - potrebbe</span>
<span>avere un saluto altrettanto nascosto.</span></li></ul></article></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"path":"2020-01-06_cyber_challenge","article":{"title":"CyberChallengeIT CTF - Group Challenge","description":"An easy and guided CTF Challenge with writeup created for the 2020 CyberChallenge Italy.","tags":["CTF","CCCIT"],"date":"2020-01-06","draft":false,"language":null,"content":[{"Start":{"Heading":["H1",null,[]]}},{"Text":"CyberChallengeIT CTF - Group Challenge"},{"End":{"Heading":["H1",null,[]]}},{"Start":"Paragraph"},{"Text":"During the last week of preparation for che Cyber Challenge IT CTF, we were"},"SoftBreak",{"Text":"asked to do a CTF challenge our self. We were divided in groups and given a"},"SoftBreak",{"Text":"month to come up with a challenge."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"Our group create an easy and guided challenge, since we were required to solve"},"SoftBreak",{"Text":"it in one hour. It will cover some basic aspect of all the kind of challenges"},"SoftBreak",{"Text":"types like Web Security, Reversing, Forensics, Cryptography."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"If you want to try the challenge yourself you will start by downloading this"},"SoftBreak",{"Text":"zip file:"},{"End":"Paragraph"},{"Start":"Paragraph"},{"Start":{"Link":["Inline","/CTF/CCIT_challenge/challenge_gruppo_1.zip",""]}},{"Text":"challenge_gruppo_1.zip"},{"End":{"Link":["Inline","/CTF/CCIT_challenge/challenge_gruppo_1.zip",""]}},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"Thank you to all the tutors and the other group members which made all the"},"SoftBreak",{"Text":"different parts of this challenge."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"The source code for creating the challenge:"},"SoftBreak",{"Start":{"Link":["Inline","https://github.com/joshuachp/CTF_CyberChallengeIT_2020",""]}},{"Text":"CTF_CyberChallenge"},{"End":{"Link":["Inline","https://github.com/joshuachp/CTF_CyberChallengeIT_2020",""]}},{"End":"Paragraph"},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Writeup"},{"End":{"Heading":["H2",null,[]]}},{"Start":"BlockQuote"},{"Start":"Paragraph"},{"Text":"The challenge was Italy so the writeup is in Italian"},{"End":"Paragraph"},{"End":"BlockQuote"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Start"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"La challenge inizia con uno zip."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"unzip challenge_gruppo_1.zip\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"All"},{"Text":"’"},{"Text":"interno dello zip troviamo diversi file:"},{"End":"Paragraph"},{"Start":{"List":null}},{"Start":"Item"},{"Start":"Paragraph"},{"Start":"Strong"},{"Text":"get_flag.py"},{"End":"Strong"},{"Text":" : script python che una volta fornita la password corretta"},"SoftBreak",{"Text":"stampa la flag"},{"End":"Paragraph"},{"End":"Item"},{"Start":"Item"},{"Start":"Paragraph"},{"Start":"Strong"},{"Text":"start"},{"End":"Strong"},{"Text":" : eseguibile per l"},{"Text":"’"},{"Text":"inizio della challenge"},{"End":"Paragraph"},{"End":"Item"},{"Start":"Item"},{"Start":"Paragraph"},{"Start":"Strong"},{"Text":"stage1.txt"},{"End":"Strong"},{"Text":" : file di benvenuto"},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"Osserviamo lo start fare cose (LOL). Alla fine ci indirizza ad un"},"SoftBreak",{"Start":{"Link":["Inline","https://joshuachp.github.io/CTF/CCIT_challenge/",""]}},{"Text":"sito web"},{"End":{"Link":["Inline","https://joshuachp.github.io/CTF/CCIT_challenge/",""]}},{"Text":"."},{"End":"Paragraph"},{"End":"Item"},{"End":{"List":null}},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Sito"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"Accediamo al sito e troviamo che il campo username è vulnerabile a SQLI ber il"},"SoftBreak",{"Text":"bypass dell"},{"Text":"’"},{"Text":"autenticazione."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"sql"}}},{"Text":"admin' --\n"},{"End":{"CodeBlock":{"Fenced":"sql"}}},{"Start":"Paragraph"},{"Text":"Questo ci permette di scaricare un file "},{"Code":"disk"},{"Text":"."},{"End":"Paragraph"},{"Start":"BlockQuote"},{"Start":"Paragraph"},{"Text":"Il sito non utilizza un database in quanto è una pagina statica. Anche lo se"},"SoftBreak",{"Text":"lo script è minified, con un po"},{"Text":"’"},{"Text":" di reversing si può benissimo trovare la"},"SoftBreak",{"Text":"funzione del download, però non è pratico in quanto per questioni di tempo la"},"SoftBreak",{"Text":"query è molto semplice."},{"End":"Paragraph"},{"End":"BlockQuote"},{"Start":{"Heading":["H4",null,[]]}},{"Text":"Hint 1"},{"End":{"Heading":["H4",null,[]]}},{"Start":"Paragraph"},{"Text":"Nel source del sito possiamo trovare un commento suggerisce di utilizzare SQL"},"SoftBreak",{"Text":"Injection."},{"End":"Paragraph"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Disk"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"Utilizzando il comando "},{"Code":"file"},{"Text":" su disk possiamo vedere:"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"disk: Linux rev 1.0 ext2 filesystem data, ...\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Essendo un file-system procediamo quindi a creare una cartella dove eseguire il"},"SoftBreak",{"Text":"mount"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"mkdir mnt\nsudo mount disk mnt\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Nella cartella "},{"Code":"mnt"},{"Text":" troviamo i seguenti file:"},{"End":"Paragraph"},{"Start":{"List":null}},{"Start":"Item"},{"Start":"Strong"},{"Text":"next_stage.txt"},{"End":"Strong"},{"Text":" : un testo che come all"},{"Text":"’"},{"Text":"inizio ci indica la strada da"},"SoftBreak",{"Text":"proseguire."},{"End":"Item"},{"Start":"Item"},{"Start":"Strong"},{"Text":"helpful.png"},{"End":"Strong"},{"Text":" : immagine con Clippy che ci lascia un messaggio"},{"End":"Item"},{"End":{"List":null}},{"Start":"Paragraph"},{"Text":"Clippy nel suo messaggio cita un eseguibile di cui fare il reverse engineering,"},"SoftBreak",{"Text":"però non abbiamo al momento nessun eseguibile."},{"End":"Paragraph"},{"Start":{"Heading":["H4",null,[]]}},{"Text":"Hint 2"},{"End":{"Heading":["H4",null,[]]}},{"Start":"Paragraph"},{"Text":"Analizziamo quindi il contenuto del file "},{"Code":"next_stage.txt"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"strings next_stage.txt\nstrings -10 next_stage.txt\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Notiamo una stringa in base64, decodificata proseguiamo ad analizzarla notando"},"SoftBreak",{"Text":"che è stato applicato uno shift"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"echo \"RnIgZnJ2IG95YnBwbmdiIHZhIGdoZ2d2IGRocmZndiBPVkEgY2ViaW4gbiBzbmVndiBoYW4gSk5ZWCA6KQo=\" | base64 -d | tr ‘n-za-mN-ZA-M’ ‘a-zA-Z’\n# Oppure se si ha installati bsd_games\necho \"RnIgZnJ2IG95YnBwbmdiIHZhIGdoZ2d2IGRocmZndiBPVkEgY2ViaW4gbiBzbmVndiBoYW4gSk5ZWCA6KQo=\" | base64 -d | rot13\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Unendo le varie informazioni trovate sappiamo che sono stati eliminati dei file"},"SoftBreak",{"Text":"e ci viene citato "},{"Code":"binwalk"},{"Text":"."},{"End":"Paragraph"},{"Start":{"Heading":["H4",null,[]]}},{"Text":"Forensics"},{"End":{"Heading":["H4",null,[]]}},{"Start":"Paragraph"},{"Text":"Il filesystem mantiene i dati scritti su disco anche dopo l"},{"Text":"’"},{"Text":"eliminazione dato"},"SoftBreak",{"Text":"che vengono solo eliminati i nodi e considerato come freespace. Per estrarre i"},"SoftBreak",{"Text":"dati ci sono vari modi: testdisk, ext-undelete, scalpel"},{"Text":"…"},{"Text":" Noi mostreremo un"},"SoftBreak",{"Text":"metodo utilizzando binwalk."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"Come suggerito proviamo a utilizzare binwalk su disk per trovare tutti i dati"},"SoftBreak",{"Text":"contenuti, nelle nuove versioni è necessario utilizzare il tag "},{"Code":"-b"},{"Text":"."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"Facendo un prima analisi sul file disk possiamo notare che contiene file di"},"SoftBreak",{"Text":"estensione nota e che quando abbiamo fatto il mount non erano presenti"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"strings -10 disk | grep -i \"[a-z_]*\\.[a-z]*\"\nstrings | head\n# next_stage.txt\n# sneaky.tar.gz\n# helpful.png\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Una volta visto l"},{"Text":"’"},{"Text":"esistenza di un file non presente alla montatura procediamo"},"SoftBreak",{"Text":"con l"},{"Text":"’"},{"Text":"estrazione e l"},{"Text":"’"},{"Text":"analisi dei files utilizzando binwalk con la flag "},{"Code":"-e"},{"Text":"."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"binwalk -e -b disk\ncd _disk.extracted/\nfile *\ntar -xvf 7400\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Il tar contiene i seguenti files:"},{"End":"Paragraph"},{"Start":{"List":null}},{"Start":"Item"},{"Start":"Strong"},{"Text":"final_stage.txt"},{"End":"Strong"},{"Text":" : testo"},{"End":"Item"},{"Start":"Item"},{"Start":"Strong"},{"Text":"crackme"},{"End":"Strong"},{"Text":" : eseguibile"},{"End":"Item"},{"End":{"List":null}},{"Start":"BlockQuote"},{"Start":"Paragraph"},{"Text":"Utilizzando lo strumento testdisk è possibile riconoscere il file rimosso, ma"},"SoftBreak",{"Text":"non è possibile l"},{"Text":"’"},{"Text":"estrazione"},{"End":"Paragraph"},{"End":"BlockQuote"},{"Start":{"Heading":["H4",null,[]]}},{"Text":"Reverse Engineering"},{"End":{"Heading":["H4",null,[]]}},{"Start":"Paragraph"},{"Text":"Analizzando crackme troviamo che dal main viene chiamata una funzione da un"},"SoftBreak",{"Text":"array di funzioni nominato "},{"Code":"table"},{"Text":". La funzione chiamata è la funzione "},{"Code":"j"},{"Text":","},"SoftBreak",{"Text":"dato che viene l"},{"Text":"’"},{"Text":"indice viene determinato dal calcolo di"},"SoftBreak",{"Code":"modular_exponentiation"},{"Text":" sulla base di parametri statici."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"C++"}}},{"Text":"argv_to_int = atoi(*(char **)(param_2 + 8));\ntable_index = modular_exponentiation(3,0x2b,7);\ncVar1 = *(table + (ulong)table_index * 8)((ulong)argv_to_int);\n"},{"End":{"CodeBlock":{"Fenced":"C++"}}},{"Start":"Paragraph"},{"Text":"Proseguendo l"},{"Text":"’"},{"Text":"analisi della funzione "},{"Code":"j"},{"Text":" notiamo che al suo interno chiama una"},"SoftBreak",{"Text":"funzione di controllo ("},{"Code":"fourth_check"},{"Text":") passando come argomento del binary."},"SoftBreak",{"Code":"fourth_check"},{"Text":" divide il valore che abbiamo inserito in 4 variabili tramite"},"SoftBreak",{"Text":"operazioni binarie che utilizza poi in un sistema lineare a quattro incognite."},"SoftBreak",{"Text":"La funzione "},{"Code":"j"},{"Text":" controllerà poi i risultati di questo sistema con i valori"},"SoftBreak",{"Text":"contenuti in un array inizializzato all"},{"Text":"’"},{"Text":"interno della procedura."},{"End":"Paragraph"},{"Start":"Paragraph"},{"Text":"Conoscendo tutti questi valori possiamo quindi creare un sistema lineare dove"},"SoftBreak",{"Text":"poniamo come incognite le quattro parti in cui il nostro valore di ingresso è"},"SoftBreak",{"Text":"stato diviso e una volta che abbiamo ottenuto il valore andiamo a fare il"},"SoftBreak",{"Text":"reverse dell"},{"Text":"’"},{"Text":"operazione di "},{"Code":"\u003e\u003e"},{"Text":" per ottenere il valore corretto."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"python"}}},{"Text":"import numpy as np\nimport math\n\n\"\"\" fourth_check() - from ghidra\nuint32_t a = n \u0026 0xFF;\nuint32_t b = (n \u003e\u003e 8) \u0026 0xFF;\nuint32_t c = (n \u003e\u003e 16) \u0026 0xFF;\nuint32_t d = (n \u003e\u003e 24) \u0026 0xFF;\n\nuint32_t v1 = 'J' * a + 'o' * b + 'j' * c + 'o' * d;\nuint32_t v2 = 'D' * a + 'I' * b + 'O' * c + '!' * d;\nuint32_t v3 = 'Z' * a + 'A' * b + 'W' * c + 'A' * d;\nuint32_t v4 = 'R' * a + 'U' * b + 'D' * c + 'O' * d;\n\nuint32_t vals[4] = {61319, 38111, 48787, 48939};\n\"\"\"\n\ndef char_to_str(chrs):\nreturn [ord(c) for c in chrs]\n\nincognite = np.array([char_to_str(\"Jojo\"), char_to_str(\"DIO!\"), char_to_str(\"ZAWA\"), char_to_str(\"RUDO\")])\nvalori = np.array([61319, 38111, 48787, 48939])\nrisultato = np.linalg.solve(incognite, valori)\nprint(\"Values are: {}\".format(risultato)) # Values are: [198.  96. 146. 185.]\n\nvalues = [198, 96, 146, 185]\nvalues.reverse()\nbinary = [\"{0:08b}\".format(b) for b in values]\nprint(\"Value: {}\".format(int(\"\".join(binary), 2))) # 3113377990\n"},{"End":{"CodeBlock":{"Fenced":"python"}}},{"Start":"Paragraph"},{"Text":"Eseguiamo quindi crackme passando come parametro il valore calcolato e"},"SoftBreak",{"Text":"otteniamo un HASH(SHA2)."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"./crackme 3113377990\n# 0051377D1EE813EBFB59991D9165D88EC8C28C51AB37268A01DE386D00AE873AE34051D74CEEF2E457AB2D06BF283BEE87D0A209242B004DC27892DA6DB1AE1C\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":{"Heading":["H5",null,[]]}},{"Text":"Hint 3"},{"End":{"Heading":["H5",null,[]]}},{"Start":"Paragraph"},{"Text":"Nell"},{"Text":"’"},{"Text":"eseguibile viene eseguito un controllo tra la stringa "},{"Text":"“"},{"Text":"stuck"},{"Text":"”"},{"Text":" e una"},"SoftBreak",{"Text":"variabile di nome "},{"Code":"hint"},{"Text":". Se andiamo a controllare il valore della variabile,"},"SoftBreak",{"Text":"ci consiglia di trovare dinamicamente la funzione chiamata dal main o di"},"SoftBreak",{"Text":"cambiare il tipo della variabile "},{"Code":"table"},{"Text":" in un array di funzioni per capire"},"SoftBreak",{"Text":"quale di queste chiami. La stringa la possiamo notare eseguendo strings del"},"SoftBreak",{"Text":"nostro eseguibile."},{"End":"Paragraph"},{"Start":{"Heading":["H4",null,[]]}},{"Text":"Steganography"},{"End":{"Heading":["H4",null,[]]}},{"Start":"Paragraph"},{"Text":"Consideriamo l"},{"Text":"’"},{"Text":"immagine "},{"Code":"helpful.png"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"strings helpful.png\n# at Least you're putting Significant effort into this challenge\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Text":"Dato il suggerimento proviamo a vedere se abbiamo qualcosa nei"},"SoftBreak",{"Start":{"Link":["Inline","https://www.boiteaklou.fr/Steganography-Least-Significant-Bit.html",""]}},{"Text":"bit meno significativi"},{"End":{"Link":["Inline","https://www.boiteaklou.fr/Steganography-Least-Significant-Bit.html",""]}},{"Text":"."},"SoftBreak",{"Text":"Utilizzando il codice fornito all"},{"Text":"’"},{"Text":"interno della pagina web otteniamo il nostro"},"SoftBreak",{"Text":"messaggio nascosto."},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"python"}}},{"Text":"import base64\nfrom PIL import Image\n\nimage = Image.open(\"./helpful.png\")\nextracted = ''\npixels = image.load()\nfor x in range(0,image.width):\nr,g,b = pixels[x,0]\nextracted += bin(r)[-1]\nextracted += bin(g)[-1]\nextracted += bin(b)[-1]\n\nchars = []\nfor i in range(len(extracted)//8):\nbyte = extracted[(i*8):(i+1)*8]\nchars.append(chr(int(''.join([str(bit) for bit in byte]), 2)))\n\nflag = ''.join(chars)\nprint(flag) # This website might help you a lot: https://ecavicc.github.io/cyberchallenge/\n"},{"End":{"CodeBlock":{"Fenced":"python"}}},{"Start":"BlockQuote"},{"Start":"Paragraph"},{"Text":"Un altro tool più popolare da utilizzabile è zsteg in ruby per ricavare"},"SoftBreak",{"Text":"direttamente il base64"},{"End":"Paragraph"},{"End":"BlockQuote"},{"Start":{"Heading":["H3",null,[]]}},{"Text":"Cracking"},{"End":{"Heading":["H3",null,[]]}},{"Start":"Paragraph"},{"Text":"Andiamo a forzare l"},{"Text":"’"},{"Text":"hash che abbiamo ottenuto dall"},{"Text":"’"},{"Text":"eseguibile per ottenere la"},"SoftBreak",{"Text":"password che ci permetterà di ottenere la flag. Per crackare l"},{"Text":"’"},{"Text":"hash andremo a"},"SoftBreak",{"Text":"utilizzare hashcat fornendo una wordlist, si può anche trovare la soluzione su"},"SoftBreak",{"Start":{"Link":["Inline","https://crackstation.net/",""]}},{"Text":"CrackStation"},{"End":{"Link":["Inline","https://crackstation.net/",""]}},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"hashcat -a 0 -m 1700 hash rockyou.txt\n# Mr.Pickles\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":{"Heading":["H4",null,[]]}},{"Text":"Hint 4"},{"End":{"Heading":["H4",null,[]]}},{"Start":"Paragraph"},{"Text":"Il sito che abbiamo estratto dall"},{"Text":"’"},{"Text":"immagine contiene il simbolo # e un gattino"},"SoftBreak",{"Text":"da qui possiamo collegare i due elementi e ottenere "},{"Code":"hashcat"},{"Text":". Inoltre il link"},"SoftBreak",{"Text":"presente infondo alla pagina, che porta alla canzione We Will Rock You, vuole"},"SoftBreak",{"Text":"essere un suggerimento a utilizzare una wordlist di supporto."},{"End":"Paragraph"},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Conclusione"},{"End":{"Heading":["H2",null,[]]}},{"Start":"Paragraph"},{"Text":"Eseguiamo il file python per ottenere la flag"},{"End":"Paragraph"},{"Start":{"CodeBlock":{"Fenced":"bash"}}},{"Text":"echo \"Mr.Pickles\" \u003e passwd\npython3 get_flag.py \u003c passwd\n"},{"End":{"CodeBlock":{"Fenced":"bash"}}},{"Start":"Paragraph"},{"Code":"FLAG{i_7urn3d_mys31f_i1n70_4_pick13}"},{"End":"Paragraph"},{"Start":{"Heading":["H2",null,[]]}},{"Text":"Extras"},{"End":{"Heading":["H2",null,[]]}},{"Start":"Paragraph"},{"Text":"Piccoli easter-egg presenti nella sfida :smile:"},{"End":"Paragraph"},{"Start":{"List":null}},{"Start":"Item"},{"Start":"Strong"},{"Text":"Forgot Password"},{"End":"Strong"},{"Text":": premere più volte "},{"Code":"forget password"},{"Text":" potrebbe aiutare."},{"End":"Item"},{"Start":"Item"},{"Start":"Strong"},{"Text":"Copy Pasta"},{"End":"Strong"},{"Text":": Crackme potrebbe esprimersi su Rick \u0026 Morty."},{"End":"Item"},{"Start":"Item"},{"Start":"Strong"},{"Text":"Hello There"},{"End":"Strong"},{"Text":": Il sito nascosto da Clippy - con un gran icona - potrebbe"},"SoftBreak",{"Text":"avere un saluto altrettanto nascosto."},{"End":"Item"},{"End":{"List":null}}]}},"__N_SSG":true},"page":"/posts/[path]","query":{"path":"2020-01-06_cyber_challenge"},"buildId":"CChp-v68ZvN-mJV1X79Da","runtimeConfig":{"domain":"joshuachp.dev","production":true},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>