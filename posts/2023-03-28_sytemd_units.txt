1:HL["/_next/static/css/c54d109becb66e5a.css",{"as":"style"}]
0:[[["",{"children":["posts",{"children":[["path","2023-03-28_sytemd_units","d"],{"children":["__PAGE__?{\"path\":\"2023-03-28_sytemd_units\"}",{}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/c54d109becb66e5a.css","precedence":"next"}]],["$L3",null]]]]
4:HL["/_next/static/css/2a1840b1c557e13c.css",{"as":"style"}]
2:["$L5",null]
3:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"/dev/blog - /dev/blog - Systemd Units"}],["$","meta",null,{"name":"description","content":"A quick overview of systemd units, how to use them and some awesome features they provide."}],["$","meta",null,{"name":"application-name","content":"/dev/blog"}],null,null,["$","meta",null,{"name":"generator","content":"Next.js"}],["$","meta",null,{"name":"keywords","content":"Dev,Blog,Programmings"}],["$","meta",null,{"name":"referrer","content":"origin-when-cross-origin"}],[["$","meta",null,{"name":"theme-color","content":"amber"}]],["$","meta",null,{"name":"color-scheme","content":"dark"}],["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta",null,{"name":"creator","content":"Joshua Chapman"}],null,null,null,null,null,null,null,null,null,[]],[["$","link",null,{"rel":"canonical","href":"https://joshuachp.dev/posts/2023-03-28_sytemd_units"}],null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.svg","type":"image/svg+xml"}],["$","link",null,{"rel":"icon","href":"/favicon.png","type":"image/png"}],["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon"}]],[],null]]
6:I{"id":"3508","chunks":["920:static/chunks/920-79b25866a09062bb.js","185:static/chunks/app/layout-bb2895f610760e8a.js"],"name":"","async":false}
7:I{"id":"247","chunks":["920:static/chunks/920-79b25866a09062bb.js","185:static/chunks/app/layout-bb2895f610760e8a.js"],"name":"","async":false}
8:I{"id":"3495","chunks":["920:static/chunks/920-79b25866a09062bb.js","185:static/chunks/app/layout-bb2895f610760e8a.js"],"name":"","async":false}
9:I{"id":"4463","chunks":["272:static/chunks/webpack-00f0855eb92aefea.js","667:static/chunks/2443530c-52b0a2f58ac02a84.js","488:static/chunks/488-c7775bdaa3bbbd30.js"],"name":"","async":false}
a:I{"id":"1010","chunks":["272:static/chunks/webpack-00f0855eb92aefea.js","667:static/chunks/2443530c-52b0a2f58ac02a84.js","488:static/chunks/488-c7775bdaa3bbbd30.js"],"name":"","async":false}
5:["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","$L6",null,{"production":true,"goatCounterApi":"a7d98e3f-b56b"}],["$","script",null,{"id":"dark-theme","dangerouslySetInnerHTML":{"__html":"if(localStorage.theme==='Dark'||((!('theme'in localStorage)||localStorage.theme==='Auto')&&window.matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}"}}]]}],["$","body",null,{"className":"bg-primary-50 dark:bg-primary-900","children":["$","$L7",null,{"children":[["$","$L8",null,{}],["$","main",null,{"className":"flex flex-col justify-center p-6 sm:px-12 md:px-24 lg:px-48 xl:px-60 2xl:px-96","children":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["path","2023-03-28_sytemd_units","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$Lb",null],"segment":"__PAGE__?{\"path\":\"2023-03-28_sytemd_units\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/2a1840b1c557e13c.css","precedence":"next"}]]}],"segment":["path","2023-03-28_sytemd_units","d"]},"styles":[]}],"segment":"posts"},"styles":[]}]}]]}]}]]}]
c:I{"id":"8920","chunks":["920:static/chunks/920-79b25866a09062bb.js","563:static/chunks/app/posts/[path]/page-1689690ab55e8573.js"],"name":"","async":false}
d:I{"id":"8451","chunks":["920:static/chunks/920-79b25866a09062bb.js","563:static/chunks/app/posts/[path]/page-1689690ab55e8573.js"],"name":"","async":false}
b:["$","article",null,{"className":"flex max-w-full grow flex-col justify-self-start","children":[["$","h1",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-4xl font-extrabold tracking-tight sm:text-5xl md:text-6xl","children":[["$","span","1",{"children":"Systemd Units"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","4",{"children":"Systemd is a system and service manager for Linux. It is the default init"}],"\r\n",["$","span","6",{"children":"system for a lot of distros and is awesome to manage services, sockets, timers,"}],"\r\n",["$","span","8",{"children":"(and much more but we don"}],["$","span","9",{"children":"â€™"}],["$","span","10",{"children":"t talk about that)."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","13",{"children":"What is a unit?"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","16",{"children":"A unit is a configuration file that describes a process or a group of"}],"\r\n",["$","span","18",{"children":"processes. It configures how the process should be started, stopped, restarted,"}],"\r\n",["$","span","20",{"children":"and so on. It declares the dependencies between units and the order in which"}],"\r\n",["$","span","22",{"children":"they should be started. It can also configure the resources that the process"}],"\r\n",["$","span","24",{"children":"requires, such as the amount of memory or the number of open files."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","27",{"children":"A unit can be a "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"service"}],["$","span","29",{"children":" when ending in "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":".service"}],["$","span","31",{"children":", this defines a start, stop"}],"\r\n",["$","span","33",{"children":"and restart command. A "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"service"}],["$","span","35",{"children":" can be managed manually with"}],"\r\n",["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"systemctl {start|stop|restart} <service>"}],["$","span","38",{"children":", but it is also possible to enable"}],"\r\n",["$","span","40",{"children":"the service to start on boot with "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"systemctl enable <service>"}],["$","span","42",{"children":"."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","45",{"children":"A unit can also be a "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"socket"}],["$","span","47",{"children":" when ending in "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":".socket"}],["$","span","49",{"children":", this defines a socket"}],"\r\n",["$","span","51",{"children":"that can be used to start a service."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","54",{"children":"Finally unit can also be a "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"timer"}],["$","span","56",{"children":" when ending in "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":".timer"}],["$","span","58",{"children":", this defines a"}],"\r\n",["$","span","60",{"children":"timer that can start a service at a specific time (yep its a cron-job)."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","63",{"children":"How to create your own unit?"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","66",{"children":"A unit is a text file that contains a set of key-value pairs similar to the"}],"\r\n",["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"ini"}],["$","span","69",{"children":" file format, the format is defined in"}],"\r\n",["$","$Lc",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://man7.org/linux/man-pages/man5/systemd.unit.5.html","children":[["$","span","72",{"children":"man (5) systemd.unit"}]]}],["$","span","74",{"children":"."}],"\r\n",["$","span","76",{"children":"The file is divided into sections, each section is defined by a header in"}],"\r\n",["$","span","78",{"children":"square brackets. For example the"}],"\r\n",["$","$Lc",null,{"title":"","className":"font-bold text-accent-700 visited:text-accent-900 hover:underline dark:text-accent-400 dark:visited:text-accent-600","href":"https://www.nginx.com/resources/wiki/start/topics/examples/systemd/","children":[["$","span","81",{"children":"nginx service"}]]}],"\r\n",["$","span","84",{"children":"is defined as:"}]]}],["$","$Ld","88",{"language":"ini","className":"mb-4 mt-2","children":[["$","span","87",{"children":"[Unit]\nDescription=The NGINX HTTP and reverse proxy server\nAfter=syslog.target network-online.target remote-fs.target nss-lookup.target\nWants=network-online.target\n\n[Service]\nType=forking\nPIDFile=/run/nginx.pid\nExecStartPre=/usr/sbin/nginx -t\nExecStart=/usr/sbin/nginx\nExecReload=/usr/sbin/nginx -s reload\nExecStop=/bin/kill -s QUIT $MAINPID\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","90",{"children":"The first section "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"[Unit]"}],["$","span","92",{"children":" defines the service and its dependencies. The second"}],"\r\n",["$","span","94",{"children":"section "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"[Service]"}],["$","span","96",{"children":" defines how the service should be started, stopped and"}],"\r\n",["$","span","98",{"children":"restarted. The last section "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"[Install]"}],["$","span","100",{"children":" defines how the service should be"}],"\r\n",["$","span","102",{"children":"installed."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","105",{"children":"This file can be placed in "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"/etc/systemd/system/"}],["$","span","107",{"children":" for a system-wide service or"}],"\r\n",["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"~/.config/systemd/user/"}],["$","span","110",{"children":" for a user service, which is then managed by passing"}],"\r\n",["$","span","112",{"children":"the user flag to systemctl "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"systemctl start --user nginx"}],["$","span","114",{"children":"."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","117",{"children":"Why are they so good?"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","120",{"children":"Systemd units are awesome because they are flexible and can be used to manage a"}],"\r\n",["$","span","122",{"children":"lot of different things. They have a lot of features that make them powerful."}],"\r\n",["$","span","124",{"children":"For example you can make the service restart if it crashes, by adding"}],"\r\n",["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"Restart=on-failure"}],["$","span","127",{"children":" to the "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"[Service]"}],["$","span","129",{"children":" section. This is similar to the"}],"\r\n",["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"--restart=on-failure"}],["$","span","132",{"children":" flag in docker. You can also make the service restart"}],"\r\n",["$","span","134",{"children":"after a specific time by adding "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"RestartSec=100ms"}],["$","span","136",{"children":" to the "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"[Service]"}],["$","span","138",{"children":" section."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","141",{"children":"You can even restart the entire operating system if a service crashes by adding"}],"\r\n",["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"FailureAction=reboot"}],["$","span","144",{"children":" to the "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"[Service]"}],["$","span","146",{"children":" section. This is especially useful"}],"\r\n",["$","span","148",{"children":"when you are running on embedded devices and want to make sure that the device"}],"\r\n",["$","span","150",{"children":"is running properly."}]]}],["$","blockquote","170",{"children":[["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","154",{"children":"Note that there are some pitfalls when using "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"FailureAction=reboot"}],["$","span","156",{"children":" and you"}],"\r\n",["$","span","158",{"children":"should limit the times the service is restarted to prevent a reboot loop. By"}],"\r\n",["$","span","160",{"children":"default the service is restarted 5 times in 10 seconds, after that the"}],"\r\n",["$","span","162",{"children":"service is marked as failed and the system is rebooted."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","165",{"children":"This can be configured with the "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"StartLimitIntervalSec"}],["$","span","167",{"children":" and "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"StartLimitBurst"}]]}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","172",{"children":"You could also make the service send an email, http request or even a message"}],"\r\n",["$","span","174",{"children":"to a slack channel if it crashes by adding "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"OnFailure=error-report.service"}],["$","span","176",{"children":" to"}],"\r\n",["$","span","178",{"children":"the "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"[Service]"}],["$","span","180",{"children":" section. This will execute the error-report service (you can"}],"\r\n",["$","span","182",{"children":"set the error-report service type to "}],["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"oneshot"}],["$","span","184",{"children":") if the service crashes or fails"}],"\r\n",["$","span","186",{"children":"to start."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","189",{"children":"The services can also be configured to start in isolation or with some mounted"}],"\r\n",["$","span","191",{"children":"folder or interface. They can be configured for many different facets of the"}],"\r\n",["$","span","193",{"children":"system and can be setted up to make sure the system is always running properly."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","196",{"children":"Additionally, all the services can be managed with a single command and will"}],"\r\n",["$","span","198",{"children":"all log to the journal. This permits you to manage the services and to debug"}],"\r\n",["$","span","200",{"children":"issues with a single command."}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","203",{"children":"To validate the configuration of a service you can use"}],"\r\n",["$","code",null,{"className":" items-baseline whitespace-nowrap rounded bg-primary-200 p-0.5 dark:bg-primary-700 sm:p-1","children":"systemctl-analyze verify <service>"}],["$","span","206",{"children":" which will check if the service is valid"}],"\r\n",["$","span","208",{"children":"and if the dependencies are met."}]]}],["$","h2",null,{"className":"mb-4 text-primary-900 dark:text-primary-50 text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl","children":[["$","span","211",{"children":"Conclusion"}]]}],["$","p",null,{"className":"mb-2 text-sm text-primary-900 dark:text-primary-50 sm:text-base xl:text-lg","children":[["$","span","214",{"children":"In conclusion, systemd is an excellent system and service manager for Linux"}],"\r\n",["$","span","216",{"children":"that offers a wide range of features for developers to manage services"}],"\r\n",["$","span","218",{"children":"efficiently. Its units provide a flexible way to manage processes and their"}],"\r\n",["$","span","220",{"children":"dependencies, allowing developers to focus on building and deploying their"}],"\r\n",["$","span","222",{"children":"applications without worrying about system management. Additionally, systemd"}],["$","span","223",{"children":"â€™"}],["$","span","224",{"children":"s"}],"\r\n",["$","span","226",{"children":"powerful features, such as service isolation, resource allocation, and"}],"\r\n",["$","span","228",{"children":"automatic restart on failure, provide developers with greater control over"}],"\r\n",["$","span","230",{"children":"their applications"}],["$","span","231",{"children":"â€™"}],["$","span","232",{"children":" behavior and ensure that the system is always running"}],"\r\n",["$","span","234",{"children":"optimally. Furthermore, with systemd"}],["$","span","235",{"children":"â€™"}],["$","span","236",{"children":"s unified interface and logging to the"}],"\r\n",["$","span","238",{"children":"journal, developers can manage and debug their services. In summary, systemd is"}],"\r\n",["$","span","240",{"children":"a great tool for developers who want to manage their services more efficiently"}],"\r\n",["$","span","242",{"children":"and with greater control, and it is definitely the tool to reach for when"}],"\r\n",["$","span","244",{"children":"choosing a system and service manager for Linux."}]]}]]}]
